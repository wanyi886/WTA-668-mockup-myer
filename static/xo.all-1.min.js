var xo=function(e){"use strict";var t="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function r(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}function a(e,t){return e(t={exports:{}},t.exports),t.exports}var i=a((function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),function(e){e.Post="POST",e.Get="GET",e.Put="PUT",e.Patch="PATCH",e.Delete="DELETE"}(t.Method||(t.Method={}))}));r(i);i.Method;var s=a((function(e,r){var a,i=t&&t.__extends||(a=function(e,t){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}a(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});Object.defineProperty(r,"__esModule",{value:!0});var s=function(e){function t(r){var a=e.call(this,r)||this;return a.name="TimeoutError",Object.setPrototypeOf(a,t.prototype),a}return i(t,e),t}(Error);r.TimeoutError=s}));r(s);s.TimeoutError;var o=a((function(e,t){function r(e){for(var r in e)t.hasOwnProperty(r)||(t[r]=e[r])}Object.defineProperty(t,"__esModule",{value:!0}),r(i),r(s)}));r(o);var n=a((function(e,r){var a=t&&t.__awaiter||function(e,t,r,a){return new(r||(r=Promise))((function(i,s){function o(e){try{p(a.next(e))}catch(e){s(e)}}function n(e){try{p(a.throw(e))}catch(e){s(e)}}function p(e){var t;e.done?i(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(o,n)}p((a=a.apply(e,t||[])).next())}))},i=t&&t.__generator||function(e,t){var r,a,i,s,o={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return s={next:n(0),throw:n(1),return:n(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s;function n(s){return function(n){return function(s){if(r)throw new TypeError("Generator is already executing.");for(;o;)try{if(r=1,a&&(i=2&s[0]?a.return:s[0]?a.throw||((i=a.return)&&i.call(a),0):a.next)&&!(i=i.call(a,s[1])).done)return i;switch(a=0,i&&(s=[2&s[0],i.value]),s[0]){case 0:case 1:i=s;break;case 4:return o.label++,{value:s[1],done:!1};case 5:o.label++,a=s[1],s=[0];continue;case 7:s=o.ops.pop(),o.trys.pop();continue;default:if(!(i=o.trys,(i=i.length>0&&i[i.length-1])||6!==s[0]&&2!==s[0])){o=0;continue}if(3===s[0]&&(!i||s[1]>i[0]&&s[1]<i[3])){o.label=s[1];break}if(6===s[0]&&o.label<i[1]){o.label=i[1],i=s;break}if(i&&o.label<i[2]){o.label=i[2],o.ops.push(s);break}i[2]&&o.ops.pop(),o.trys.pop();continue}s=t.call(e,o)}catch(e){s=[6,e],a=0}finally{r=i=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,n])}}};Object.defineProperty(r,"__esModule",{value:!0});var s=function(){function e(e){this.scope=e}return e.prototype.send=function(e){return a(this,void 0,void 0,(function(){var t,r,a;return i(this,(function(i){switch(i.label){case 0:return t={method:e.method,headers:e.headers,body:e.body,keepalive:e.keepalive,referrerPolicy:e.referrerPolicy||"no-referrer",cache:e.cache},[4,Promise.race([this.scope.fetch(e.url,t),Number.isInteger(e.timeout)&&new Promise((function(t,r){setTimeout((function(){return r(new o.TimeoutError)}),e.timeout)}))].filter((function(e){return e instanceof Promise})))];case 1:return r=i.sent(),a={status:r.status},[4,r.text()];case 2:return[2,(a.body=i.sent(),a)]}}))}))},e}();r.BrowserHttpClient=s}));r(n);n.BrowserHttpClient;var p="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&"function"==typeof msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto),c=new Uint8Array(16);function u(){if(!p)throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return p(c)}for(var d,h,y=[],m=0;m<256;++m)y[m]=(m+256).toString(16).substr(1);function f(e,t){var r=t||0,a=y;return[a[e[r++]],a[e[r++]],a[e[r++]],a[e[r++]],"-",a[e[r++]],a[e[r++]],"-",a[e[r++]],a[e[r++]],"-",a[e[r++]],a[e[r++]],"-",a[e[r++]],a[e[r++]],a[e[r++]],a[e[r++]],a[e[r++]],a[e[r++]]].join("")}var l=0,v=0;function g(e,t,r){var a=function(e,a,i,s){var o=i&&s||0;if("string"==typeof e&&(e=function(e){e=unescape(encodeURIComponent(e));for(var t=new Array(e.length),r=0;r<e.length;r++)t[r]=e.charCodeAt(r);return t}(e)),"string"==typeof a&&(a=function(e){var t=[];return e.replace(/[a-fA-F0-9]{2}/g,(function(e){t.push(parseInt(e,16))})),t}(a)),!Array.isArray(e))throw TypeError("value must be an array of bytes");if(!Array.isArray(a)||16!==a.length)throw TypeError("namespace must be uuid string or an Array of 16 byte values");var n=r(a.concat(e));if(n[6]=15&n[6]|t,n[8]=63&n[8]|128,i)for(var p=0;p<16;++p)i[o+p]=n[p];return i||f(n)};try{a.name=e}catch(e){}return a.DNS="6ba7b810-9dad-11d1-80b4-00c04fd430c8",a.URL="6ba7b811-9dad-11d1-80b4-00c04fd430c8",a}function b(e,t){var r=(65535&e)+(65535&t);return(e>>16)+(t>>16)+(r>>16)<<16|65535&r}function P(e,t,r,a,i,s){return b((o=b(b(t,e),b(a,s)))<<(n=i)|o>>>32-n,r);var o,n}function w(e,t,r,a,i,s,o){return P(t&r|~t&a,e,t,i,s,o)}function A(e,t,r,a,i,s,o){return P(t&a|r&~a,e,t,i,s,o)}function S(e,t,r,a,i,s,o){return P(t^r^a,e,t,i,s,o)}function k(e,t,r,a,i,s,o){return P(r^(t|~a),e,t,i,s,o)}var O=g("v3",48,(function(e){if("string"==typeof e){var t=unescape(encodeURIComponent(e));e=new Array(t.length);for(var r=0;r<t.length;r++)e[r]=t.charCodeAt(r)}return function(e){var t,r,a,i=[],s=32*e.length;for(t=0;t<s;t+=8)r=e[t>>5]>>>t%32&255,a=parseInt("0123456789abcdef".charAt(r>>>4&15)+"0123456789abcdef".charAt(15&r),16),i.push(a);return i}(function(e,t){var r,a,i,s,o;e[t>>5]|=128<<t%32,e[14+(t+64>>>9<<4)]=t;var n=1732584193,p=-271733879,c=-1732584194,u=271733878;for(r=0;r<e.length;r+=16)a=n,i=p,s=c,o=u,n=w(n,p,c,u,e[r],7,-680876936),u=w(u,n,p,c,e[r+1],12,-389564586),c=w(c,u,n,p,e[r+2],17,606105819),p=w(p,c,u,n,e[r+3],22,-1044525330),n=w(n,p,c,u,e[r+4],7,-176418897),u=w(u,n,p,c,e[r+5],12,1200080426),c=w(c,u,n,p,e[r+6],17,-1473231341),p=w(p,c,u,n,e[r+7],22,-45705983),n=w(n,p,c,u,e[r+8],7,1770035416),u=w(u,n,p,c,e[r+9],12,-1958414417),c=w(c,u,n,p,e[r+10],17,-42063),p=w(p,c,u,n,e[r+11],22,-1990404162),n=w(n,p,c,u,e[r+12],7,1804603682),u=w(u,n,p,c,e[r+13],12,-40341101),c=w(c,u,n,p,e[r+14],17,-1502002290),p=w(p,c,u,n,e[r+15],22,1236535329),n=A(n,p,c,u,e[r+1],5,-165796510),u=A(u,n,p,c,e[r+6],9,-1069501632),c=A(c,u,n,p,e[r+11],14,643717713),p=A(p,c,u,n,e[r],20,-373897302),n=A(n,p,c,u,e[r+5],5,-701558691),u=A(u,n,p,c,e[r+10],9,38016083),c=A(c,u,n,p,e[r+15],14,-660478335),p=A(p,c,u,n,e[r+4],20,-405537848),n=A(n,p,c,u,e[r+9],5,568446438),u=A(u,n,p,c,e[r+14],9,-1019803690),c=A(c,u,n,p,e[r+3],14,-187363961),p=A(p,c,u,n,e[r+8],20,1163531501),n=A(n,p,c,u,e[r+13],5,-1444681467),u=A(u,n,p,c,e[r+2],9,-51403784),c=A(c,u,n,p,e[r+7],14,1735328473),p=A(p,c,u,n,e[r+12],20,-1926607734),n=S(n,p,c,u,e[r+5],4,-378558),u=S(u,n,p,c,e[r+8],11,-2022574463),c=S(c,u,n,p,e[r+11],16,1839030562),p=S(p,c,u,n,e[r+14],23,-35309556),n=S(n,p,c,u,e[r+1],4,-1530992060),u=S(u,n,p,c,e[r+4],11,1272893353),c=S(c,u,n,p,e[r+7],16,-155497632),p=S(p,c,u,n,e[r+10],23,-1094730640),n=S(n,p,c,u,e[r+13],4,681279174),u=S(u,n,p,c,e[r],11,-358537222),c=S(c,u,n,p,e[r+3],16,-722521979),p=S(p,c,u,n,e[r+6],23,76029189),n=S(n,p,c,u,e[r+9],4,-640364487),u=S(u,n,p,c,e[r+12],11,-421815835),c=S(c,u,n,p,e[r+15],16,530742520),p=S(p,c,u,n,e[r+2],23,-995338651),n=k(n,p,c,u,e[r],6,-198630844),u=k(u,n,p,c,e[r+7],10,1126891415),c=k(c,u,n,p,e[r+14],15,-1416354905),p=k(p,c,u,n,e[r+5],21,-57434055),n=k(n,p,c,u,e[r+12],6,1700485571),u=k(u,n,p,c,e[r+3],10,-1894986606),c=k(c,u,n,p,e[r+10],15,-1051523),p=k(p,c,u,n,e[r+1],21,-2054922799),n=k(n,p,c,u,e[r+8],6,1873313359),u=k(u,n,p,c,e[r+15],10,-30611744),c=k(c,u,n,p,e[r+6],15,-1560198380),p=k(p,c,u,n,e[r+13],21,1309151649),n=k(n,p,c,u,e[r+4],6,-145523070),u=k(u,n,p,c,e[r+11],10,-1120210379),c=k(c,u,n,p,e[r+2],15,718787259),p=k(p,c,u,n,e[r+9],21,-343485551),n=b(n,a),p=b(p,i),c=b(c,s),u=b(u,o);return[n,p,c,u]}(function(e){var t,r=[];for(r[(e.length>>2)-1]=void 0,t=0;t<r.length;t+=1)r[t]=0;var a=8*e.length;for(t=0;t<a;t+=8)r[t>>5]|=(255&e[t/8])<<t%32;return r}(e),8*e.length))}));function j(e,t,r,a){switch(e){case 0:return t&r^~t&a;case 1:return t^r^a;case 2:return t&r^t&a^r&a;case 3:return t^r^a}}function q(e,t){return e<<t|e>>>32-t}var C=g("v5",80,(function(e){var t=[1518500249,1859775393,2400959708,3395469782],r=[1732584193,4023233417,2562383102,271733878,3285377520];if("string"==typeof e){var a=unescape(encodeURIComponent(e));e=new Array(a.length);for(var i=0;i<a.length;i++)e[i]=a.charCodeAt(i)}e.push(128);var s=e.length/4+2,o=Math.ceil(s/16),n=new Array(o);for(i=0;i<o;i++){n[i]=new Array(16);for(var p=0;p<16;p++)n[i][p]=e[64*i+4*p]<<24|e[64*i+4*p+1]<<16|e[64*i+4*p+2]<<8|e[64*i+4*p+3]}for(n[o-1][14]=8*(e.length-1)/Math.pow(2,32),n[o-1][14]=Math.floor(n[o-1][14]),n[o-1][15]=8*(e.length-1)&4294967295,i=0;i<o;i++){for(var c=new Array(80),u=0;u<16;u++)c[u]=n[i][u];for(u=16;u<80;u++)c[u]=q(c[u-3]^c[u-8]^c[u-14]^c[u-16],1);var d=r[0],h=r[1],y=r[2],m=r[3],f=r[4];for(u=0;u<80;u++){var l=Math.floor(u/20),v=q(d,5)+j(l,h,y,m)+f+t[l]+c[u]>>>0;f=m,m=y,y=q(h,30)>>>0,h=d,d=v}r[0]=r[0]+d>>>0,r[1]=r[1]+h>>>0,r[2]=r[2]+y>>>0,r[3]=r[3]+m>>>0,r[4]=r[4]+f>>>0}return[r[0]>>24&255,r[0]>>16&255,r[0]>>8&255,255&r[0],r[1]>>24&255,r[1]>>16&255,r[1]>>8&255,255&r[1],r[2]>>24&255,r[2]>>16&255,r[2]>>8&255,255&r[2],r[3]>>24&255,r[3]>>16&255,r[3]>>8&255,255&r[3],r[4]>>24&255,r[4]>>16&255,r[4]>>8&255,255&r[4]]})),I=Object.freeze({__proto__:null,v1:function(e,t,r){var a=t&&r||0,i=t||[],s=(e=e||{}).node||d,o=void 0!==e.clockseq?e.clockseq:h;if(null==s||null==o){var n=e.random||(e.rng||u)();null==s&&(s=d=[1|n[0],n[1],n[2],n[3],n[4],n[5]]),null==o&&(o=h=16383&(n[6]<<8|n[7]))}var p=void 0!==e.msecs?e.msecs:(new Date).getTime(),c=void 0!==e.nsecs?e.nsecs:v+1,y=p-l+(c-v)/1e4;if(y<0&&void 0===e.clockseq&&(o=o+1&16383),(y<0||p>l)&&void 0===e.nsecs&&(c=0),c>=1e4)throw new Error("uuid.v1(): Can't create more than 10M uuids/sec");l=p,v=c,h=o;var m=(1e4*(268435455&(p+=122192928e5))+c)%4294967296;i[a++]=m>>>24&255,i[a++]=m>>>16&255,i[a++]=m>>>8&255,i[a++]=255&m;var g=p/4294967296*1e4&268435455;i[a++]=g>>>8&255,i[a++]=255&g,i[a++]=g>>>24&15|16,i[a++]=g>>>16&255,i[a++]=o>>>8|128,i[a++]=255&o;for(var b=0;b<6;++b)i[a+b]=s[b];return t||f(i)},v3:O,v4:function(e,t,r){var a=t&&r||0;"string"==typeof e&&(t="binary"===e?new Array(16):null,e=null);var i=(e=e||{}).random||(e.rng||u)();if(i[6]=15&i[6]|64,i[8]=63&i[8]|128,t)for(var s=0;s<16;++s)t[a+s]=i[s];return t||f(i)},v5:C}),_=M,T=M,E={$schema:"http://json-schema.org/draft-07/schema#",definitions:{User:{properties:{identities:{additionalProperties:{type:"string"},type:"object"},segments:{items:{type:"string"},type:"array"},traits:{additionalProperties:{},type:"object"}},required:["identities"],type:"object"}},properties:{action:{type:"string"},metadata:{additionalProperties:{anyOf:[{items:{},type:"array"},{type:["string","number","boolean"]}]},properties:{currency:{type:"string"},market:{type:"string"},orderId:{type:"string"},price:{type:"number"},quantity:{type:"number"}},type:"object"},opposite:{type:"boolean"},segments:{items:{type:"string"},type:"array"},sourceId:{type:"string"},target:{additionalProperties:{type:"string"},type:"object"},timestamp:{type:"string"},user:{$ref:"#/definitions/User"}},required:["action","target"],type:"object"},B={properties:{identities:{additionalProperties:{type:"string"},type:"object"},segments:{items:{type:"string"},type:"array"},traits:{additionalProperties:{},type:"object"}},required:["identities"],type:"object"};function M(e,t){if(t){var r=t.instancePath;t.parentData,t.parentDataProperty,t.rootData}else r="";var a=null,i=0;if(e&&"object"==typeof e&&!Array.isArray(e)){if(void 0===e.action){var s={instancePath:r,schemaPath:"#/required",keyword:"required",params:{missingProperty:"action"},message:"must have required property 'action'",schema:E.required,parentSchema:E,data:e};null===a?a=[s]:a.push(s),i++}if(void 0===e.target){var o={instancePath:r,schemaPath:"#/required",keyword:"required",params:{missingProperty:"target"},message:"must have required property 'target'",schema:E.required,parentSchema:E,data:e};null===a?a=[o]:a.push(o),i++}if(void 0!==e.action){var n=e.action;if("string"!=typeof n){var p={instancePath:r+"/action",schemaPath:"#/properties/action/type",keyword:"type",params:{type:"string"},message:"must be string",schema:E.properties.action.type,parentSchema:E.properties.action,data:n};null===a?a=[p]:a.push(p),i++}}if(void 0!==e.metadata){var c=e.metadata;if(c&&"object"==typeof c&&!Array.isArray(c)){for(var u in c)if("currency"!==u&&"market"!==u&&"orderId"!==u&&"price"!==u&&"quantity"!==u){var d=c[u],h=i,y=!1,m=i;if(!Array.isArray(d)){var f={instancePath:r+"/metadata/"+u.replace(/~/g,"~0").replace(/\//g,"~1"),schemaPath:"#/properties/metadata/additionalProperties/anyOf/0/type",keyword:"type",params:{type:"array"},message:"must be array",schema:E.properties.metadata.additionalProperties.anyOf[0].type,parentSchema:E.properties.metadata.additionalProperties.anyOf[0],data:d};null===a?a=[f]:a.push(f),i++}var l=m===i;if(!(y=y||l)){var v=i;if("string"!=typeof d&&("number"!=typeof d||!isFinite(d))&&"boolean"!=typeof d){var g={instancePath:r+"/metadata/"+u.replace(/~/g,"~0").replace(/\//g,"~1"),schemaPath:"#/properties/metadata/additionalProperties/anyOf/1/type",keyword:"type",params:{type:E.properties.metadata.additionalProperties.anyOf[1].type},message:"must be string,number,boolean",schema:E.properties.metadata.additionalProperties.anyOf[1].type,parentSchema:E.properties.metadata.additionalProperties.anyOf[1],data:d};null===a?a=[g]:a.push(g),i++}l=v===i;y=y||l}if(y)i=h,null!==a&&(h?a.length=h:a=null);else{var b={instancePath:r+"/metadata/"+u.replace(/~/g,"~0").replace(/\//g,"~1"),schemaPath:"#/properties/metadata/additionalProperties/anyOf",keyword:"anyOf",params:{},message:"must match a schema in anyOf",schema:E.properties.metadata.additionalProperties.anyOf,parentSchema:E.properties.metadata.additionalProperties,data:d};null===a?a=[b]:a.push(b),i++}}if(void 0!==c.currency){var P=c.currency;if("string"!=typeof P){var w={instancePath:r+"/metadata/currency",schemaPath:"#/properties/metadata/properties/currency/type",keyword:"type",params:{type:"string"},message:"must be string",schema:E.properties.metadata.properties.currency.type,parentSchema:E.properties.metadata.properties.currency,data:P};null===a?a=[w]:a.push(w),i++}}if(void 0!==c.market){var A=c.market;if("string"!=typeof A){var S={instancePath:r+"/metadata/market",schemaPath:"#/properties/metadata/properties/market/type",keyword:"type",params:{type:"string"},message:"must be string",schema:E.properties.metadata.properties.market.type,parentSchema:E.properties.metadata.properties.market,data:A};null===a?a=[S]:a.push(S),i++}}if(void 0!==c.orderId){var k=c.orderId;if("string"!=typeof k){var O={instancePath:r+"/metadata/orderId",schemaPath:"#/properties/metadata/properties/orderId/type",keyword:"type",params:{type:"string"},message:"must be string",schema:E.properties.metadata.properties.orderId.type,parentSchema:E.properties.metadata.properties.orderId,data:k};null===a?a=[O]:a.push(O),i++}}if(void 0!==c.price){var j=c.price;if("number"!=typeof j||!isFinite(j)){var q={instancePath:r+"/metadata/price",schemaPath:"#/properties/metadata/properties/price/type",keyword:"type",params:{type:"number"},message:"must be number",schema:E.properties.metadata.properties.price.type,parentSchema:E.properties.metadata.properties.price,data:j};null===a?a=[q]:a.push(q),i++}}if(void 0!==c.quantity){var C=c.quantity;if("number"!=typeof C||!isFinite(C)){var I={instancePath:r+"/metadata/quantity",schemaPath:"#/properties/metadata/properties/quantity/type",keyword:"type",params:{type:"number"},message:"must be number",schema:E.properties.metadata.properties.quantity.type,parentSchema:E.properties.metadata.properties.quantity,data:C};null===a?a=[I]:a.push(I),i++}}}else{var _={instancePath:r+"/metadata",schemaPath:"#/properties/metadata/type",keyword:"type",params:{type:"object"},message:"must be object",schema:E.properties.metadata.type,parentSchema:E.properties.metadata,data:c};null===a?a=[_]:a.push(_),i++}}if(void 0!==e.opposite){var T=e.opposite;if("boolean"!=typeof T){var U={instancePath:r+"/opposite",schemaPath:"#/properties/opposite/type",keyword:"type",params:{type:"boolean"},message:"must be boolean",schema:E.properties.opposite.type,parentSchema:E.properties.opposite,data:T};null===a?a=[U]:a.push(U),i++}}if(void 0!==e.segments){var R=e.segments;if(Array.isArray(R))for(var x=R.length,z=0;z<x;z++){var D=R[z];if("string"!=typeof D){var G={instancePath:r+"/segments/"+z,schemaPath:"#/properties/segments/items/type",keyword:"type",params:{type:"string"},message:"must be string",schema:E.properties.segments.items.type,parentSchema:E.properties.segments.items,data:D};null===a?a=[G]:a.push(G),i++}}else{var N={instancePath:r+"/segments",schemaPath:"#/properties/segments/type",keyword:"type",params:{type:"array"},message:"must be array",schema:E.properties.segments.type,parentSchema:E.properties.segments,data:R};null===a?a=[N]:a.push(N),i++}}if(void 0!==e.sourceId){var F=e.sourceId;if("string"!=typeof F){var $={instancePath:r+"/sourceId",schemaPath:"#/properties/sourceId/type",keyword:"type",params:{type:"string"},message:"must be string",schema:E.properties.sourceId.type,parentSchema:E.properties.sourceId,data:F};null===a?a=[$]:a.push($),i++}}if(void 0!==e.target){var V=e.target;if(V&&"object"==typeof V&&!Array.isArray(V))for(var L in V){var H=V[L];if("string"!=typeof H){var J={instancePath:r+"/target/"+L.replace(/~/g,"~0").replace(/\//g,"~1"),schemaPath:"#/properties/target/additionalProperties/type",keyword:"type",params:{type:"string"},message:"must be string",schema:E.properties.target.additionalProperties.type,parentSchema:E.properties.target.additionalProperties,data:H};null===a?a=[J]:a.push(J),i++}}else{var K={instancePath:r+"/target",schemaPath:"#/properties/target/type",keyword:"type",params:{type:"object"},message:"must be object",schema:E.properties.target.type,parentSchema:E.properties.target,data:V};null===a?a=[K]:a.push(K),i++}}if(void 0!==e.timestamp){var Q=e.timestamp;if("string"!=typeof Q){var X={instancePath:r+"/timestamp",schemaPath:"#/properties/timestamp/type",keyword:"type",params:{type:"string"},message:"must be string",schema:E.properties.timestamp.type,parentSchema:E.properties.timestamp,data:Q};null===a?a=[X]:a.push(X),i++}}if(void 0!==e.user){var W=e.user;if(W&&"object"==typeof W&&!Array.isArray(W)){if(void 0===W.identities){var Y={instancePath:r+"/user",schemaPath:"#/definitions/User/required",keyword:"required",params:{missingProperty:"identities"},message:"must have required property 'identities'",schema:B.required,parentSchema:B,data:W};null===a?a=[Y]:a.push(Y),i++}if(void 0!==W.identities){var Z=W.identities;if(Z&&"object"==typeof Z&&!Array.isArray(Z))for(var ee in Z){var te=Z[ee];if("string"!=typeof te){var re={instancePath:r+"/user/identities/"+ee.replace(/~/g,"~0").replace(/\//g,"~1"),schemaPath:"#/definitions/User/properties/identities/additionalProperties/type",keyword:"type",params:{type:"string"},message:"must be string",schema:B.properties.identities.additionalProperties.type,parentSchema:B.properties.identities.additionalProperties,data:te};null===a?a=[re]:a.push(re),i++}}else{var ae={instancePath:r+"/user/identities",schemaPath:"#/definitions/User/properties/identities/type",keyword:"type",params:{type:"object"},message:"must be object",schema:B.properties.identities.type,parentSchema:B.properties.identities,data:Z};null===a?a=[ae]:a.push(ae),i++}}if(void 0!==W.segments){var ie=W.segments;if(Array.isArray(ie))for(var se=ie.length,oe=0;oe<se;oe++){var ne=ie[oe];if("string"!=typeof ne){var pe={instancePath:r+"/user/segments/"+oe,schemaPath:"#/definitions/User/properties/segments/items/type",keyword:"type",params:{type:"string"},message:"must be string",schema:B.properties.segments.items.type,parentSchema:B.properties.segments.items,data:ne};null===a?a=[pe]:a.push(pe),i++}}else{var ce={instancePath:r+"/user/segments",schemaPath:"#/definitions/User/properties/segments/type",keyword:"type",params:{type:"array"},message:"must be array",schema:B.properties.segments.type,parentSchema:B.properties.segments,data:ie};null===a?a=[ce]:a.push(ce),i++}}if(void 0!==W.traits){var ue=W.traits;if(ue&&"object"==typeof ue&&!Array.isArray(ue));else{var de={instancePath:r+"/user/traits",schemaPath:"#/definitions/User/properties/traits/type",keyword:"type",params:{type:"object"},message:"must be object",schema:B.properties.traits.type,parentSchema:B.properties.traits,data:ue};null===a?a=[de]:a.push(de),i++}}}else{var he={instancePath:r+"/user",schemaPath:"#/definitions/User/type",keyword:"type",params:{type:"object"},message:"must be object",schema:B.type,parentSchema:B,data:W};null===a?a=[he]:a.push(he),i++}}}else{var ye={instancePath:r,schemaPath:"#/type",keyword:"type",params:{type:"object"},message:"must be object",schema:E.type,parentSchema:E,data:e};null===a?a=[ye]:a.push(ye),i++}return M.errors=a,0===i}_.default=T;var U=a((function(e,r){var a=t&&t.__assign||function(){return(a=Object.assign||function(e){for(var t,r=1,a=arguments.length;r<a;r++)for(var i in t=arguments[r])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)},i=t&&t.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(r,"__esModule",{value:!0});var s,n=i(_),p=function(){function e(){this.isInitialized=!1,this.sample={action:"",target:{}},this.user={identities:{},segments:[],traits:{}}}return e.prototype.initUser=function(e){this.user.identities.sessionid||(this.user.identities.sessionid=e.getItem("attraqtsessionid")||I.v4()),this.storage.setItem("attraqtsessionid",this.user.identities.sessionid)},e.prototype.assertIsInit=function(){if(!this.isInitialized)throw Error("The activities module must be initialized before using methods.")},e.prototype.init=function(e,t){var r;if(!e||!e.trackerKey)throw Error("A tracker key is required to initialize the activities module.");var a=(null===(r=e.region)||void 0===r?void 0:r.toLowerCase())||s.EU;this.apiUrl="http"+(a!==s.DEV?"s":"")+"://collect-"+a+".attraqt.io/"+e.trackerKey,this.storage=e.storage,this.httpClient=t,this.initUser(this.storage),this.hasOptedOut="true"===this.storage.getItem("attraqtoptout"),this.isInitialized=!0},e.prototype.send=function(e,t){var r=this;if(!this.isInitialized)throw Error("The activities module must be initialized before sending activities.");var i=[].concat(e).map((function(e){var t=a(a({},e),{user:e&&e.user?e.user:r.user});if(!n.default(t))throw new Error("The provided activity does not match the required format.");return t}));if(this.hasOptedOut)return null;var s=a({method:o.Method.Post,headers:{"Content-Type":"application/json"},url:this.apiUrl,body:JSON.stringify(i)},t);return this.httpClient.send(s)},e.prototype.setUser=function(e){if(this.assertIsInit(),!e||!n.default(a(a({},this.sample),{user:e})))throw new TypeError("The provided user does not match the required format.");this.setUserIdentities(e.identities),this.setUserSegments(e.segments),this.setUserTraits(e.traits),this.initUser(this.storage)},e.prototype.addUserIdentity=function(e,t){if(this.assertIsInit(),"string"!=typeof e||"string"!=typeof t)throw new TypeError("identityRepository and identity must be strings.");this.user.identities[e.toLocaleLowerCase()]=t,this.initUser(this.storage)},e.prototype.setUserIdentities=function(e){if(this.assertIsInit(),!n.default(a(a({},this.sample),{user:{identities:e}}))||0===Object.keys(e).length)throw new TypeError("The provided identities do not match the required format.");this.user.identities=e,this.initUser(this.storage)},e.prototype.addUserSegment=function(e){if(this.assertIsInit(),"string"!=typeof e)throw new TypeError("segment must be a string.");this.user.segments.push(e)},e.prototype.setUserSegments=function(e){if(this.assertIsInit(),!Array.isArray(e)||e.some((function(e){return"string"!=typeof e})))throw new TypeError("segments must be an array of strings.");this.user.segments=e},e.prototype.addUserTrait=function(e,t){if(this.assertIsInit(),"string"!=typeof e||"string"!=typeof t)throw new TypeError("trait and traitValue must be strings.");this.user.traits[e]=t},e.prototype.setUserTraits=function(e){if(this.assertIsInit(),!n.default(a(a({},this.sample),{user:{identities:{},traits:e}})))throw new TypeError("The provided traits do not match the required format.");this.user.traits=e},e.prototype.clearUser=function(){this.assertIsInit(),this.user={identities:{},segments:[],traits:{}},this.storage.removeItem("attraqtsessionid"),this.initUser(this.storage)},e.prototype.optOut=function(){this.assertIsInit(),this.hasOptedOut=!0,this.storage.setItem("attraqtoptout","true")},e.prototype.optIn=function(){this.assertIsInit(),this.hasOptedOut=!1,this.storage.removeItem("attraqtoptout")},e}();r.Activity=p,function(e){e.DEV="dev",e.EU="eu",e.AP1="ap1",e.AP2="ap2"}(s=r.Region||(r.Region={}))}));r(U);U.Activity,U.Region;var R=a((function(e,r){var a,i=t&&t.__extends||(a=function(e,t){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}a(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});Object.defineProperty(r,"__esModule",{value:!0});var s=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return i(t,e),t.prototype.init=function(t,r){void 0===r&&(r=new n.BrowserHttpClient(window)),t.storage||(t.storage=window.localStorage),e.prototype.init.call(this,t,r)},t.prototype.send=function(t,r){return"1"===navigator.doNotTrack?null:e.prototype.send.call(this,t,r)},t.prototype.handleQueuedEvents=function(){var e=this;[].concat(window._attraqt).filter((function(e){return Array.isArray(e)})).forEach((function(t){var r;(r=e)[t[0]].apply(r,t.filter((function(e){return e})).slice(1))})),window._attraqt=[]},t}(U.Activity);r.Activity=s,r.activity=new s,r.init=function(e){r.activity.init(e.activity)},r.activity.handleQueuedEvents()}));r(R);R.Activity,R.activity,R.init;var x=a((function(e,t){!function(r,a){var i={version:"3.0.1",x86:{},x64:{}};function s(e,t){return(65535&e)*t+(((e>>>16)*t&65535)<<16)}function o(e,t){return e<<t|e>>>32-t}function n(e){return e=s(e^=e>>>16,2246822507),e=s(e^=e>>>13,3266489909),e^=e>>>16}function p(e,t){e=[e[0]>>>16,65535&e[0],e[1]>>>16,65535&e[1]],t=[t[0]>>>16,65535&t[0],t[1]>>>16,65535&t[1]];var r=[0,0,0,0];return r[3]+=e[3]+t[3],r[2]+=r[3]>>>16,r[3]&=65535,r[2]+=e[2]+t[2],r[1]+=r[2]>>>16,r[2]&=65535,r[1]+=e[1]+t[1],r[0]+=r[1]>>>16,r[1]&=65535,r[0]+=e[0]+t[0],r[0]&=65535,[r[0]<<16|r[1],r[2]<<16|r[3]]}function c(e,t){e=[e[0]>>>16,65535&e[0],e[1]>>>16,65535&e[1]],t=[t[0]>>>16,65535&t[0],t[1]>>>16,65535&t[1]];var r=[0,0,0,0];return r[3]+=e[3]*t[3],r[2]+=r[3]>>>16,r[3]&=65535,r[2]+=e[2]*t[3],r[1]+=r[2]>>>16,r[2]&=65535,r[2]+=e[3]*t[2],r[1]+=r[2]>>>16,r[2]&=65535,r[1]+=e[1]*t[3],r[0]+=r[1]>>>16,r[1]&=65535,r[1]+=e[2]*t[2],r[0]+=r[1]>>>16,r[1]&=65535,r[1]+=e[3]*t[1],r[0]+=r[1]>>>16,r[1]&=65535,r[0]+=e[0]*t[3]+e[1]*t[2]+e[2]*t[1]+e[3]*t[0],r[0]&=65535,[r[0]<<16|r[1],r[2]<<16|r[3]]}function u(e,t){return 32===(t%=64)?[e[1],e[0]]:t<32?[e[0]<<t|e[1]>>>32-t,e[1]<<t|e[0]>>>32-t]:(t-=32,[e[1]<<t|e[0]>>>32-t,e[0]<<t|e[1]>>>32-t])}function d(e,t){return 0===(t%=64)?e:t<32?[e[0]<<t|e[1]>>>32-t,e[1]<<t]:[e[1]<<t-32,0]}function h(e,t){return[e[0]^t[0],e[1]^t[1]]}function y(e){return e=h(e,[0,e[0]>>>1]),e=h(e=c(e,[4283543511,3981806797]),[0,e[0]>>>1]),e=h(e=c(e,[3301882366,444984403]),[0,e[0]>>>1])}i.x86.hash32=function(e,t){t=t||0;for(var r=(e=e||"").length%4,a=e.length-r,i=t,p=0,c=3432918353,u=461845907,d=0;d<a;d+=4)p=s(p=255&e.charCodeAt(d)|(255&e.charCodeAt(d+1))<<8|(255&e.charCodeAt(d+2))<<16|(255&e.charCodeAt(d+3))<<24,c),p=s(p=o(p,15),u),i=s(i=o(i^=p,13),5)+3864292196;switch(p=0,r){case 3:p^=(255&e.charCodeAt(d+2))<<16;case 2:p^=(255&e.charCodeAt(d+1))<<8;case 1:p=s(p^=255&e.charCodeAt(d),c),i^=p=s(p=o(p,15),u)}return(i=n(i^=e.length))>>>0},i.x86.hash128=function(e,t){t=t||0;for(var r=(e=e||"").length%16,a=e.length-r,i=t,p=t,c=t,u=t,d=0,h=0,y=0,m=0,f=597399067,l=2869860233,v=951274213,g=2716044179,b=0;b<a;b+=16)d=255&e.charCodeAt(b)|(255&e.charCodeAt(b+1))<<8|(255&e.charCodeAt(b+2))<<16|(255&e.charCodeAt(b+3))<<24,h=255&e.charCodeAt(b+4)|(255&e.charCodeAt(b+5))<<8|(255&e.charCodeAt(b+6))<<16|(255&e.charCodeAt(b+7))<<24,y=255&e.charCodeAt(b+8)|(255&e.charCodeAt(b+9))<<8|(255&e.charCodeAt(b+10))<<16|(255&e.charCodeAt(b+11))<<24,m=255&e.charCodeAt(b+12)|(255&e.charCodeAt(b+13))<<8|(255&e.charCodeAt(b+14))<<16|(255&e.charCodeAt(b+15))<<24,d=o(d=s(d,f),15),i=o(i^=d=s(d,l),19),i=s(i+=p,5)+1444728091,h=o(h=s(h,l),16),p=o(p^=h=s(h,v),17),p=s(p+=c,5)+197830471,y=o(y=s(y,v),17),c=o(c^=y=s(y,g),15),c=s(c+=u,5)+2530024501,m=o(m=s(m,g),18),u=o(u^=m=s(m,f),13),u=s(u+=i,5)+850148119;switch(d=0,h=0,y=0,m=0,r){case 15:m^=e.charCodeAt(b+14)<<16;case 14:m^=e.charCodeAt(b+13)<<8;case 13:m=s(m^=e.charCodeAt(b+12),g),u^=m=s(m=o(m,18),f);case 12:y^=e.charCodeAt(b+11)<<24;case 11:y^=e.charCodeAt(b+10)<<16;case 10:y^=e.charCodeAt(b+9)<<8;case 9:y=s(y^=e.charCodeAt(b+8),v),c^=y=s(y=o(y,17),g);case 8:h^=e.charCodeAt(b+7)<<24;case 7:h^=e.charCodeAt(b+6)<<16;case 6:h^=e.charCodeAt(b+5)<<8;case 5:h=s(h^=e.charCodeAt(b+4),l),p^=h=s(h=o(h,16),v);case 4:d^=e.charCodeAt(b+3)<<24;case 3:d^=e.charCodeAt(b+2)<<16;case 2:d^=e.charCodeAt(b+1)<<8;case 1:d=s(d^=e.charCodeAt(b),f),i^=d=s(d=o(d,15),l)}return i^=e.length,i+=p^=e.length,i+=c^=e.length,p+=i+=u^=e.length,c+=i,u+=i,i=n(i),i+=p=n(p),i+=c=n(c),p+=i+=u=n(u),c+=i,u+=i,("00000000"+(i>>>0).toString(16)).slice(-8)+("00000000"+(p>>>0).toString(16)).slice(-8)+("00000000"+(c>>>0).toString(16)).slice(-8)+("00000000"+(u>>>0).toString(16)).slice(-8)},i.x64.hash128=function(e,t){t=t||0;for(var r=(e=e||"").length%16,a=e.length-r,i=[0,t],s=[0,t],o=[0,0],n=[0,0],m=[2277735313,289559509],f=[1291169091,658871167],l=0;l<a;l+=16)o=[255&e.charCodeAt(l+4)|(255&e.charCodeAt(l+5))<<8|(255&e.charCodeAt(l+6))<<16|(255&e.charCodeAt(l+7))<<24,255&e.charCodeAt(l)|(255&e.charCodeAt(l+1))<<8|(255&e.charCodeAt(l+2))<<16|(255&e.charCodeAt(l+3))<<24],n=[255&e.charCodeAt(l+12)|(255&e.charCodeAt(l+13))<<8|(255&e.charCodeAt(l+14))<<16|(255&e.charCodeAt(l+15))<<24,255&e.charCodeAt(l+8)|(255&e.charCodeAt(l+9))<<8|(255&e.charCodeAt(l+10))<<16|(255&e.charCodeAt(l+11))<<24],o=u(o=c(o,m),31),i=p(i=u(i=h(i,o=c(o,f)),27),s),i=p(c(i,[0,5]),[0,1390208809]),n=u(n=c(n,f),33),s=p(s=u(s=h(s,n=c(n,m)),31),i),s=p(c(s,[0,5]),[0,944331445]);switch(o=[0,0],n=[0,0],r){case 15:n=h(n,d([0,e.charCodeAt(l+14)],48));case 14:n=h(n,d([0,e.charCodeAt(l+13)],40));case 13:n=h(n,d([0,e.charCodeAt(l+12)],32));case 12:n=h(n,d([0,e.charCodeAt(l+11)],24));case 11:n=h(n,d([0,e.charCodeAt(l+10)],16));case 10:n=h(n,d([0,e.charCodeAt(l+9)],8));case 9:n=c(n=h(n,[0,e.charCodeAt(l+8)]),f),s=h(s,n=c(n=u(n,33),m));case 8:o=h(o,d([0,e.charCodeAt(l+7)],56));case 7:o=h(o,d([0,e.charCodeAt(l+6)],48));case 6:o=h(o,d([0,e.charCodeAt(l+5)],40));case 5:o=h(o,d([0,e.charCodeAt(l+4)],32));case 4:o=h(o,d([0,e.charCodeAt(l+3)],24));case 3:o=h(o,d([0,e.charCodeAt(l+2)],16));case 2:o=h(o,d([0,e.charCodeAt(l+1)],8));case 1:o=c(o=h(o,[0,e.charCodeAt(l)]),m),i=h(i,o=c(o=u(o,31),f))}return i=p(i=h(i,[0,e.length]),s=h(s,[0,e.length])),s=p(s,i),i=p(i=y(i),s=y(s)),s=p(s,i),("00000000"+(i[0]>>>0).toString(16)).slice(-8)+("00000000"+(i[1]>>>0).toString(16)).slice(-8)+("00000000"+(s[0]>>>0).toString(16)).slice(-8)+("00000000"+(s[1]>>>0).toString(16)).slice(-8)},e.exports&&(t=e.exports=i),t.murmurHash3=i}()})),z=(x.murmurHash3,x),D=a((function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.drawAbTestVariationForUser=function(e,t){var r=z.x86.hash32(e+"#"+t.id)%100+1,a=0;return{bucket:r,variationId:t.variations.find((function(e){return(a+=e.weight)>=r})).id}}}));r(D);D.drawAbTestVariationForUser;var G=H,N=H,F={$schema:"http://json-schema.org/draft-07/schema#",additionalProperties:!1,definitions:{DisableOptions:{additionalProperties:!1,properties:{name:{description:'Feature to disable in the query\nExample: "facet"',type:"string"}},required:["name"],type:"object"},SortOptions:{additionalProperties:!1,properties:{attribute:{description:"Attribute to sort by",type:"string"},order:{description:'Order of the sort.\nMust be either "asc" or "desc"',type:"string"}},required:["attribute","order"],type:"object"}},properties:{aiSearch:{description:'Toggle AI Search "on" or "off".\nIf true, AI Search is used\nIf false, regular fulltext search is used\nIf not specified, the type of search will be determined by the configuration',type:"boolean"},configurationId:{description:"If specified, this configuration will be used instead of the default configuration set for the tenant",type:"string"},customResponseMask:{description:"Response mask to return only specific attributes of items",type:"string"},disable:{description:"Disable rules\nIf specified, disable specific functionalities",items:{$ref:"#/definitions/DisableOptions"},type:"array"},facets:{items:{additionalProperties:!1,properties:{attribute:{description:"Selected facet to filter by\nTODO: Should be removed after migration to ids",type:"string"},id:{description:"Selected facet to filter by",type:"string"},values:{description:"Values of the facet used for filtering the results",items:{type:"string"},type:"array"}},required:["values"],type:"object"},type:"array"},filter:{description:"Filter string",type:"string"},limit:{description:"Pagination: size of the page",type:"number"},offset:{description:"Pagination: index of the first item to return",type:"number"},sortBy:{description:"List of sorting rules\n(applied in order)",items:{$ref:"#/definitions/SortOptions"},type:"array"}},type:"object"},$={additionalProperties:!1,properties:{name:{description:'Feature to disable in the query\nExample: "facet"',type:"string"}},required:["name"],type:"object"},V={additionalProperties:!1,properties:{attribute:{description:"Attribute to sort by",type:"string"},order:{description:'Order of the sort.\nMust be either "asc" or "desc"',type:"string"}},required:["attribute","order"],type:"object"},L=Object.prototype.hasOwnProperty;function H(e,t){if(t){var r=t.instancePath;t.parentData,t.parentDataProperty,t.rootData}else r="";var a=null,i=0;if(e&&"object"==typeof e&&!Array.isArray(e)){for(var s in e)if(!L.call(F.properties,s)){var o={instancePath:r,schemaPath:"#/additionalProperties",keyword:"additionalProperties",params:{additionalProperty:s},message:"must NOT have additional properties",schema:!1,parentSchema:F,data:e};null===a?a=[o]:a.push(o),i++}if(void 0!==e.aiSearch){var n=e.aiSearch;if("boolean"!=typeof n){var p={instancePath:r+"/aiSearch",schemaPath:"#/properties/aiSearch/type",keyword:"type",params:{type:"boolean"},message:"must be boolean",schema:F.properties.aiSearch.type,parentSchema:F.properties.aiSearch,data:n};null===a?a=[p]:a.push(p),i++}}if(void 0!==e.configurationId){var c=e.configurationId;if("string"!=typeof c){var u={instancePath:r+"/configurationId",schemaPath:"#/properties/configurationId/type",keyword:"type",params:{type:"string"},message:"must be string",schema:F.properties.configurationId.type,parentSchema:F.properties.configurationId,data:c};null===a?a=[u]:a.push(u),i++}}if(void 0!==e.customResponseMask){var d=e.customResponseMask;if("string"!=typeof d){var h={instancePath:r+"/customResponseMask",schemaPath:"#/properties/customResponseMask/type",keyword:"type",params:{type:"string"},message:"must be string",schema:F.properties.customResponseMask.type,parentSchema:F.properties.customResponseMask,data:d};null===a?a=[h]:a.push(h),i++}}if(void 0!==e.disable){var y=e.disable;if(Array.isArray(y))for(var m=y.length,f=0;f<m;f++){var l=y[f];if(l&&"object"==typeof l&&!Array.isArray(l)){if(void 0===l.name){var v={instancePath:r+"/disable/"+f,schemaPath:"#/definitions/DisableOptions/required",keyword:"required",params:{missingProperty:"name"},message:"must have required property 'name'",schema:$.required,parentSchema:$,data:l};null===a?a=[v]:a.push(v),i++}for(var g in l)if("name"!==g){var b={instancePath:r+"/disable/"+f,schemaPath:"#/definitions/DisableOptions/additionalProperties",keyword:"additionalProperties",params:{additionalProperty:g},message:"must NOT have additional properties",schema:!1,parentSchema:$,data:l};null===a?a=[b]:a.push(b),i++}if(void 0!==l.name){var P=l.name;if("string"!=typeof P){var w={instancePath:r+"/disable/"+f+"/name",schemaPath:"#/definitions/DisableOptions/properties/name/type",keyword:"type",params:{type:"string"},message:"must be string",schema:$.properties.name.type,parentSchema:$.properties.name,data:P};null===a?a=[w]:a.push(w),i++}}}else{var A={instancePath:r+"/disable/"+f,schemaPath:"#/definitions/DisableOptions/type",keyword:"type",params:{type:"object"},message:"must be object",schema:$.type,parentSchema:$,data:l};null===a?a=[A]:a.push(A),i++}}else{var S={instancePath:r+"/disable",schemaPath:"#/properties/disable/type",keyword:"type",params:{type:"array"},message:"must be array",schema:F.properties.disable.type,parentSchema:F.properties.disable,data:y};null===a?a=[S]:a.push(S),i++}}if(void 0!==e.facets){var k=e.facets;if(Array.isArray(k))for(var O=k.length,j=0;j<O;j++){var q=k[j];if(q&&"object"==typeof q&&!Array.isArray(q)){if(void 0===q.values){var C={instancePath:r+"/facets/"+j,schemaPath:"#/properties/facets/items/required",keyword:"required",params:{missingProperty:"values"},message:"must have required property 'values'",schema:F.properties.facets.items.required,parentSchema:F.properties.facets.items,data:q};null===a?a=[C]:a.push(C),i++}for(var I in q)if("attribute"!==I&&"id"!==I&&"values"!==I){var _={instancePath:r+"/facets/"+j,schemaPath:"#/properties/facets/items/additionalProperties",keyword:"additionalProperties",params:{additionalProperty:I},message:"must NOT have additional properties",schema:!1,parentSchema:F.properties.facets.items,data:q};null===a?a=[_]:a.push(_),i++}if(void 0!==q.attribute){var T=q.attribute;if("string"!=typeof T){var E={instancePath:r+"/facets/"+j+"/attribute",schemaPath:"#/properties/facets/items/properties/attribute/type",keyword:"type",params:{type:"string"},message:"must be string",schema:F.properties.facets.items.properties.attribute.type,parentSchema:F.properties.facets.items.properties.attribute,data:T};null===a?a=[E]:a.push(E),i++}}if(void 0!==q.id){var B=q.id;if("string"!=typeof B){var M={instancePath:r+"/facets/"+j+"/id",schemaPath:"#/properties/facets/items/properties/id/type",keyword:"type",params:{type:"string"},message:"must be string",schema:F.properties.facets.items.properties.id.type,parentSchema:F.properties.facets.items.properties.id,data:B};null===a?a=[M]:a.push(M),i++}}if(void 0!==q.values){var U=q.values;if(Array.isArray(U))for(var R=U.length,x=0;x<R;x++){var z=U[x];if("string"!=typeof z){var D={instancePath:r+"/facets/"+j+"/values/"+x,schemaPath:"#/properties/facets/items/properties/values/items/type",keyword:"type",params:{type:"string"},message:"must be string",schema:F.properties.facets.items.properties.values.items.type,parentSchema:F.properties.facets.items.properties.values.items,data:z};null===a?a=[D]:a.push(D),i++}}else{var G={instancePath:r+"/facets/"+j+"/values",schemaPath:"#/properties/facets/items/properties/values/type",keyword:"type",params:{type:"array"},message:"must be array",schema:F.properties.facets.items.properties.values.type,parentSchema:F.properties.facets.items.properties.values,data:U};null===a?a=[G]:a.push(G),i++}}}else{var N={instancePath:r+"/facets/"+j,schemaPath:"#/properties/facets/items/type",keyword:"type",params:{type:"object"},message:"must be object",schema:F.properties.facets.items.type,parentSchema:F.properties.facets.items,data:q};null===a?a=[N]:a.push(N),i++}}else{var J={instancePath:r+"/facets",schemaPath:"#/properties/facets/type",keyword:"type",params:{type:"array"},message:"must be array",schema:F.properties.facets.type,parentSchema:F.properties.facets,data:k};null===a?a=[J]:a.push(J),i++}}if(void 0!==e.filter){var K=e.filter;if("string"!=typeof K){var Q={instancePath:r+"/filter",schemaPath:"#/properties/filter/type",keyword:"type",params:{type:"string"},message:"must be string",schema:F.properties.filter.type,parentSchema:F.properties.filter,data:K};null===a?a=[Q]:a.push(Q),i++}}if(void 0!==e.limit){var X=e.limit;if("number"!=typeof X||!isFinite(X)){var W={instancePath:r+"/limit",schemaPath:"#/properties/limit/type",keyword:"type",params:{type:"number"},message:"must be number",schema:F.properties.limit.type,parentSchema:F.properties.limit,data:X};null===a?a=[W]:a.push(W),i++}}if(void 0!==e.offset){var Y=e.offset;if("number"!=typeof Y||!isFinite(Y)){var Z={instancePath:r+"/offset",schemaPath:"#/properties/offset/type",keyword:"type",params:{type:"number"},message:"must be number",schema:F.properties.offset.type,parentSchema:F.properties.offset,data:Y};null===a?a=[Z]:a.push(Z),i++}}if(void 0!==e.sortBy){var ee=e.sortBy;if(Array.isArray(ee))for(var te=ee.length,re=0;re<te;re++){var ae=ee[re];if(ae&&"object"==typeof ae&&!Array.isArray(ae)){if(void 0===ae.attribute){var ie={instancePath:r+"/sortBy/"+re,schemaPath:"#/definitions/SortOptions/required",keyword:"required",params:{missingProperty:"attribute"},message:"must have required property 'attribute'",schema:V.required,parentSchema:V,data:ae};null===a?a=[ie]:a.push(ie),i++}if(void 0===ae.order){var se={instancePath:r+"/sortBy/"+re,schemaPath:"#/definitions/SortOptions/required",keyword:"required",params:{missingProperty:"order"},message:"must have required property 'order'",schema:V.required,parentSchema:V,data:ae};null===a?a=[se]:a.push(se),i++}for(var oe in ae)if("attribute"!==oe&&"order"!==oe){var ne={instancePath:r+"/sortBy/"+re,schemaPath:"#/definitions/SortOptions/additionalProperties",keyword:"additionalProperties",params:{additionalProperty:oe},message:"must NOT have additional properties",schema:!1,parentSchema:V,data:ae};null===a?a=[ne]:a.push(ne),i++}if(void 0!==ae.attribute){var pe=ae.attribute;if("string"!=typeof pe){var ce={instancePath:r+"/sortBy/"+re+"/attribute",schemaPath:"#/definitions/SortOptions/properties/attribute/type",keyword:"type",params:{type:"string"},message:"must be string",schema:V.properties.attribute.type,parentSchema:V.properties.attribute,data:pe};null===a?a=[ce]:a.push(ce),i++}}if(void 0!==ae.order){var ue=ae.order;if("string"!=typeof ue){var de={instancePath:r+"/sortBy/"+re+"/order",schemaPath:"#/definitions/SortOptions/properties/order/type",keyword:"type",params:{type:"string"},message:"must be string",schema:V.properties.order.type,parentSchema:V.properties.order,data:ue};null===a?a=[de]:a.push(de),i++}}}else{var he={instancePath:r+"/sortBy/"+re,schemaPath:"#/definitions/SortOptions/type",keyword:"type",params:{type:"object"},message:"must be object",schema:V.type,parentSchema:V,data:ae};null===a?a=[he]:a.push(he),i++}}else{var ye={instancePath:r+"/sortBy",schemaPath:"#/properties/sortBy/type",keyword:"type",params:{type:"array"},message:"must be array",schema:F.properties.sortBy.type,parentSchema:F.properties.sortBy,data:ee};null===a?a=[ye]:a.push(ye),i++}}}else{var me={instancePath:r,schemaPath:"#/type",keyword:"type",params:{type:"object"},message:"must be object",schema:F.type,parentSchema:F,data:e};null===a?a=[me]:a.push(me),i++}return H.errors=a,0===i}G.default=N;var J=X,K=X,Q={$schema:"http://json-schema.org/draft-07/schema#",additionalProperties:!1,properties:{session:{additionalProperties:{type:"string"},description:"Identify the user using a set of `$identityRepository/$userId` key/value pairs.\nUsually, one of the `$identityRepository` is `sessionId`.",type:"object"},variables:{additionalProperties:{},description:"List of XO context variables attached to the request. The variables will be resolved according\nto your configuration in the XO Console.",type:"object"}},type:"object"};function X(e,t){if(t){var r=t.instancePath;t.parentData,t.parentDataProperty,t.rootData}else r="";var a=null,i=0;if(e&&"object"==typeof e&&!Array.isArray(e)){for(var s in e)if("session"!==s&&"variables"!==s){var o={instancePath:r,schemaPath:"#/additionalProperties",keyword:"additionalProperties",params:{additionalProperty:s},message:"must NOT have additional properties",schema:!1,parentSchema:Q,data:e};null===a?a=[o]:a.push(o),i++}if(void 0!==e.session){var n=e.session;if(n&&"object"==typeof n&&!Array.isArray(n))for(var p in n){var c=n[p];if("string"!=typeof c){var u={instancePath:r+"/session/"+p.replace(/~/g,"~0").replace(/\//g,"~1"),schemaPath:"#/properties/session/additionalProperties/type",keyword:"type",params:{type:"string"},message:"must be string",schema:Q.properties.session.additionalProperties.type,parentSchema:Q.properties.session.additionalProperties,data:c};null===a?a=[u]:a.push(u),i++}}else{var d={instancePath:r+"/session",schemaPath:"#/properties/session/type",keyword:"type",params:{type:"object"},message:"must be object",schema:Q.properties.session.type,parentSchema:Q.properties.session,data:n};null===a?a=[d]:a.push(d),i++}}if(void 0!==e.variables){var h=e.variables;if(h&&"object"==typeof h&&!Array.isArray(h));else{var y={instancePath:r+"/variables",schemaPath:"#/properties/variables/type",keyword:"type",params:{type:"object"},message:"must be object",schema:Q.properties.variables.type,parentSchema:Q.properties.variables,data:h};null===a?a=[y]:a.push(y),i++}}}else{var m={instancePath:r,schemaPath:"#/type",keyword:"type",params:{type:"object"},message:"must be object",schema:Q.type,parentSchema:Q,data:e};null===a?a=[m]:a.push(m),i++}return X.errors=a,0===i}J.default=K;var W=re,Y=re,Z={$schema:"http://json-schema.org/draft-07/schema#",additionalProperties:!1,definitions:{GroupOptions:{additionalProperties:!1,properties:{attribute:{type:"string"},size:{type:"number"},values:{items:{type:"string"},type:"array"}},required:["attribute","size","values"],type:"object"},SortOptions:{additionalProperties:!1,properties:{attribute:{description:"Attribute to sort by",type:"string"},order:{description:'Order of the sort.\nMust be either "asc" or "desc"',type:"string"}},required:["attribute","order"],type:"object"}},properties:{configurationId:{description:"If specified, this configuration will be used instead of the default configuration set for the tenant",type:"string"},customResponseMask:{description:"Response mask to return only specific attributes of items",type:"string"},filter:{description:"Filter string",type:"string"},groupBy:{$ref:"#/definitions/GroupOptions",description:"to do"},sortBy:{description:"List of sorting rules\n(applied in order)",items:{$ref:"#/definitions/SortOptions"},type:"array"}},type:"object"},ee={additionalProperties:!1,properties:{attribute:{type:"string"},size:{type:"number"},values:{items:{type:"string"},type:"array"}},required:["attribute","size","values"],type:"object"},te={additionalProperties:!1,properties:{attribute:{description:"Attribute to sort by",type:"string"},order:{description:'Order of the sort.\nMust be either "asc" or "desc"',type:"string"}},required:["attribute","order"],type:"object"};function re(e,t){if(t){var r=t.instancePath;t.parentData,t.parentDataProperty,t.rootData}else r="";var a=null,i=0;if(e&&"object"==typeof e&&!Array.isArray(e)){for(var s in e)if("configurationId"!==s&&"customResponseMask"!==s&&"filter"!==s&&"groupBy"!==s&&"sortBy"!==s){var o={instancePath:r,schemaPath:"#/additionalProperties",keyword:"additionalProperties",params:{additionalProperty:s},message:"must NOT have additional properties",schema:!1,parentSchema:Z,data:e};null===a?a=[o]:a.push(o),i++}if(void 0!==e.configurationId){var n=e.configurationId;if("string"!=typeof n){var p={instancePath:r+"/configurationId",schemaPath:"#/properties/configurationId/type",keyword:"type",params:{type:"string"},message:"must be string",schema:Z.properties.configurationId.type,parentSchema:Z.properties.configurationId,data:n};null===a?a=[p]:a.push(p),i++}}if(void 0!==e.customResponseMask){var c=e.customResponseMask;if("string"!=typeof c){var u={instancePath:r+"/customResponseMask",schemaPath:"#/properties/customResponseMask/type",keyword:"type",params:{type:"string"},message:"must be string",schema:Z.properties.customResponseMask.type,parentSchema:Z.properties.customResponseMask,data:c};null===a?a=[u]:a.push(u),i++}}if(void 0!==e.filter){var d=e.filter;if("string"!=typeof d){var h={instancePath:r+"/filter",schemaPath:"#/properties/filter/type",keyword:"type",params:{type:"string"},message:"must be string",schema:Z.properties.filter.type,parentSchema:Z.properties.filter,data:d};null===a?a=[h]:a.push(h),i++}}if(void 0!==e.groupBy){var y=e.groupBy;if(y&&"object"==typeof y&&!Array.isArray(y)){if(void 0===y.attribute){var m={instancePath:r+"/groupBy",schemaPath:"#/definitions/GroupOptions/required",keyword:"required",params:{missingProperty:"attribute"},message:"must have required property 'attribute'",schema:ee.required,parentSchema:ee,data:y};null===a?a=[m]:a.push(m),i++}if(void 0===y.size){var f={instancePath:r+"/groupBy",schemaPath:"#/definitions/GroupOptions/required",keyword:"required",params:{missingProperty:"size"},message:"must have required property 'size'",schema:ee.required,parentSchema:ee,data:y};null===a?a=[f]:a.push(f),i++}if(void 0===y.values){var l={instancePath:r+"/groupBy",schemaPath:"#/definitions/GroupOptions/required",keyword:"required",params:{missingProperty:"values"},message:"must have required property 'values'",schema:ee.required,parentSchema:ee,data:y};null===a?a=[l]:a.push(l),i++}for(var v in y)if("attribute"!==v&&"size"!==v&&"values"!==v){var g={instancePath:r+"/groupBy",schemaPath:"#/definitions/GroupOptions/additionalProperties",keyword:"additionalProperties",params:{additionalProperty:v},message:"must NOT have additional properties",schema:!1,parentSchema:ee,data:y};null===a?a=[g]:a.push(g),i++}if(void 0!==y.attribute){var b=y.attribute;if("string"!=typeof b){var P={instancePath:r+"/groupBy/attribute",schemaPath:"#/definitions/GroupOptions/properties/attribute/type",keyword:"type",params:{type:"string"},message:"must be string",schema:ee.properties.attribute.type,parentSchema:ee.properties.attribute,data:b};null===a?a=[P]:a.push(P),i++}}if(void 0!==y.size){var w=y.size;if("number"!=typeof w||!isFinite(w)){var A={instancePath:r+"/groupBy/size",schemaPath:"#/definitions/GroupOptions/properties/size/type",keyword:"type",params:{type:"number"},message:"must be number",schema:ee.properties.size.type,parentSchema:ee.properties.size,data:w};null===a?a=[A]:a.push(A),i++}}if(void 0!==y.values){var S=y.values;if(Array.isArray(S))for(var k=S.length,O=0;O<k;O++){var j=S[O];if("string"!=typeof j){var q={instancePath:r+"/groupBy/values/"+O,schemaPath:"#/definitions/GroupOptions/properties/values/items/type",keyword:"type",params:{type:"string"},message:"must be string",schema:ee.properties.values.items.type,parentSchema:ee.properties.values.items,data:j};null===a?a=[q]:a.push(q),i++}}else{var C={instancePath:r+"/groupBy/values",schemaPath:"#/definitions/GroupOptions/properties/values/type",keyword:"type",params:{type:"array"},message:"must be array",schema:ee.properties.values.type,parentSchema:ee.properties.values,data:S};null===a?a=[C]:a.push(C),i++}}}else{var I={instancePath:r+"/groupBy",schemaPath:"#/definitions/GroupOptions/type",keyword:"type",params:{type:"object"},message:"must be object",schema:ee.type,parentSchema:ee,data:y};null===a?a=[I]:a.push(I),i++}}if(void 0!==e.sortBy){var _=e.sortBy;if(Array.isArray(_))for(var T=_.length,E=0;E<T;E++){var B=_[E];if(B&&"object"==typeof B&&!Array.isArray(B)){if(void 0===B.attribute){var M={instancePath:r+"/sortBy/"+E,schemaPath:"#/definitions/SortOptions/required",keyword:"required",params:{missingProperty:"attribute"},message:"must have required property 'attribute'",schema:te.required,parentSchema:te,data:B};null===a?a=[M]:a.push(M),i++}if(void 0===B.order){var U={instancePath:r+"/sortBy/"+E,schemaPath:"#/definitions/SortOptions/required",keyword:"required",params:{missingProperty:"order"},message:"must have required property 'order'",schema:te.required,parentSchema:te,data:B};null===a?a=[U]:a.push(U),i++}for(var R in B)if("attribute"!==R&&"order"!==R){var x={instancePath:r+"/sortBy/"+E,schemaPath:"#/definitions/SortOptions/additionalProperties",keyword:"additionalProperties",params:{additionalProperty:R},message:"must NOT have additional properties",schema:!1,parentSchema:te,data:B};null===a?a=[x]:a.push(x),i++}if(void 0!==B.attribute){var z=B.attribute;if("string"!=typeof z){var D={instancePath:r+"/sortBy/"+E+"/attribute",schemaPath:"#/definitions/SortOptions/properties/attribute/type",keyword:"type",params:{type:"string"},message:"must be string",schema:te.properties.attribute.type,parentSchema:te.properties.attribute,data:z};null===a?a=[D]:a.push(D),i++}}if(void 0!==B.order){var G=B.order;if("string"!=typeof G){var N={instancePath:r+"/sortBy/"+E+"/order",schemaPath:"#/definitions/SortOptions/properties/order/type",keyword:"type",params:{type:"string"},message:"must be string",schema:te.properties.order.type,parentSchema:te.properties.order,data:G};null===a?a=[N]:a.push(N),i++}}}else{var F={instancePath:r+"/sortBy/"+E,schemaPath:"#/definitions/SortOptions/type",keyword:"type",params:{type:"object"},message:"must be object",schema:te.type,parentSchema:te,data:B};null===a?a=[F]:a.push(F),i++}}else{var $={instancePath:r+"/sortBy",schemaPath:"#/properties/sortBy/type",keyword:"type",params:{type:"array"},message:"must be array",schema:Z.properties.sortBy.type,parentSchema:Z.properties.sortBy,data:_};null===a?a=[$]:a.push($),i++}}}else{var V={instancePath:r,schemaPath:"#/type",keyword:"type",params:{type:"object"},message:"must be object",schema:Z.type,parentSchema:Z,data:e};null===a?a=[V]:a.push(V),i++}return re.errors=a,0===i}W.default=Y;var ae=a((function(e,r){var a=t&&t.__assign||function(){return(a=Object.assign||function(e){for(var t,r=1,a=arguments.length;r<a;r++)for(var i in t=arguments[r])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)},i=t&&t.__awaiter||function(e,t,r,a){return new(r||(r=Promise))((function(i,s){function o(e){try{p(a.next(e))}catch(e){s(e)}}function n(e){try{p(a.throw(e))}catch(e){s(e)}}function p(e){var t;e.done?i(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(o,n)}p((a=a.apply(e,t||[])).next())}))},s=t&&t.__generator||function(e,t){var r,a,i,s,o={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return s={next:n(0),throw:n(1),return:n(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s;function n(s){return function(n){return function(s){if(r)throw new TypeError("Generator is already executing.");for(;o;)try{if(r=1,a&&(i=2&s[0]?a.return:s[0]?a.throw||((i=a.return)&&i.call(a),0):a.next)&&!(i=i.call(a,s[1])).done)return i;switch(a=0,i&&(s=[2&s[0],i.value]),s[0]){case 0:case 1:i=s;break;case 4:return o.label++,{value:s[1],done:!1};case 5:o.label++,a=s[1],s=[0];continue;case 7:s=o.ops.pop(),o.trys.pop();continue;default:if(!(i=o.trys,(i=i.length>0&&i[i.length-1])||6!==s[0]&&2!==s[0])){o=0;continue}if(3===s[0]&&(!i||s[1]>i[0]&&s[1]<i[3])){o.label=s[1];break}if(6===s[0]&&o.label<i[1]){o.label=i[1],i=s;break}if(i&&o.label<i[2]){o.label=i[2],o.ops.push(s);break}i[2]&&o.ops.pop(),o.trys.pop();continue}s=t.call(e,o)}catch(e){s=[6,e],a=0}finally{r=i=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,n])}}},n=t&&t.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(r,"__esModule",{value:!0});var p,c=n(G),u=n(J),d=n(W),h=function(){function e(){this.isInitialized=!1}return e.prototype.init=function(e,t){if(!e||!e.token)throw Error("A token is required to initialize the search module.");this.token=e.token,this.httpClient=t,this.region=this.configureRegion(e),this.isInitialized=!0},e.prototype.query=function(e,t,r,a){return i(this,void 0,void 0,(function(){return s(this,(function(i){if(this.assertIsInit(),t&&!c.default(t))throw Error("The provided search options doesn't match the required format.");if(a&&!u.default(a))throw Error("The provided search context doesn't match the required format.");return[2,this.sendRequest("/search",e,t,a,r)]}))}))},e.prototype.suggest=function(e,t,r,a){return i(this,void 0,void 0,(function(){return s(this,(function(i){if(this.assertIsInit(),t&&!d.default(t))throw Error("The provided suggest options don't match the required format.");if(a&&!u.default(a))throw Error("The provided search context doesn't match the required format.");return[2,this.sendRequest("/search/suggest",e,t,a,r)]}))}))},e.prototype.sendRequest=function(e,t,r,n,p){return i(this,void 0,void 0,(function(){var i,c;return s(this,(function(s){switch(s.label){case 0:return i=a({method:o.Method.Post,headers:{"Content-Type":"application/json"},url:"https://api-"+this.region+".attraqt.io"+e,body:JSON.stringify({query:t,token:this.token,options:r,context:n})},p),[4,this.httpClient.send(i)];case 1:if((c=s.sent()).status<300)return[2,JSON.parse(c.body)];throw new Error("HTTP Error "+c.status+": "+c.body)}}))}))},e.prototype.assertIsInit=function(){if(!this.isInitialized)throw Error("The search module must be initialized before using methods.")},e.prototype.configureRegion=function(e){var t=e.region;return Object.values(p).includes(null==t?void 0:t.toLowerCase())?t.toLowerCase():p.EU},e}();r.Search=h,function(e){e.EU="eu",e.AU="au",e.US="us"}(p=r.Region||(r.Region={}))}));r(ae);ae.Search,ae.Region;var ie=a((function(e,r){var a,i=t&&t.__extends||(a=function(e,t){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}a(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});Object.defineProperty(r,"__esModule",{value:!0});var s=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return i(t,e),t.prototype.init=function(t,r){void 0===r&&(r=new n.BrowserHttpClient(window)),e.prototype.init.call(this,t,r)},t}(ae.Search);r.Search=s,r.search=new s,r.init=function(e){r.search.init(e.search)}}));r(ie);ie.Search,ie.search,ie.init;var se=a((function(e,r){var a=t&&t.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t};Object.defineProperty(r,"__esModule",{value:!0}),r.Activity=R.Activity,r.activity=R.activity;var i=a(D);r.abTest=i,r.Search=ie.Search,r.search=ie.search,r.init=function(e){void 0===e&&(e={}),e.activity&&R.activity.init(e.activity),e.search&&ie.search.init(e.search)}})),oe=r(se),ne=se.Activity,pe=se.activity,ce=se.abTest,ue=se.Search,de=se.search,he=se.init;return e.Activity=ne,e.Search=ue,e.abTest=ce,e.activity=pe,e.default=oe,e.init=he,e.search=de,e}({});
