"use strict";function _typeof(t){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}!function(c){var n=window.console,a={},u=document.documentMode,o=/\S+/g,r=/^(\-?\d+(?:\.\d+)?)(px|%|)$/i,i=/^(\.|:)?([-a-z]+)$/i,l=/<|&#?\w+;/,d=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:]+)[^>]*)\/>/gi,h=/<([a-z][^\/\0>\x20\t\r\n\f]*)/i,s=/HTML$/i,p=/^$|^module$|\/(?:java|ecma)script/i,m=/^\s*<!(?:\[CDATA\[|--)|(?:\]\]|--)>\s*$/g,f=/^(?:(\s*<[\w\W]+>\s*)[^>]*|#([\w-]+))$/,v=/<script|<style|<link/i,y=1,g="animIndex",b="animTicks",w={thead:["table"],col:["colgroup","table"],tr:["tbody","table"],td:["tr","tbody","table"]};function T(t,e){var n;if(t instanceof T)return t;if(!(this instanceof T))return new T(t,e);if(!t)return this;if(N(t)){if(e=e?T(e):wt,!(n="<"===t[0]&&">"===t[t.length-1]&&3<=t.length?[null,t,null]:f.exec(t))||!n[1])return t=t.trim(),e.find(t);W(this,tt(n[1],e))}else W(this,t)}w.tbody=w.tfoot=w.colgroup=w.caption=w.thead,w.th=w.td,T.extend=(T.fn=T.prototype).extend=function(t,e){return 1===arguments.length?R(this,t):R.apply(null,arguments)};var x=function(){for(var t,e={},n="Boolean Number String Function Array Date RegExp Object".split(" "),r=0;r<n.length;++r)t=n[r],e["[object "+t+"]"]=t.toLowerCase();return function(t){return null==t?t+"":"object"===_typeof(t)?e[Object.prototype.toString.call(t)]||"object":_typeof(t)}}();function C(){}function A(t){return void 0===t}function D(t){return!A(t)}function N(t){return"string"==typeof t}function _(t){return e(t)||t&&"object"===x(t)&&E(t.length)&&!j(t)&&!F(t)}var e=Array.isArray||function(t){return"array"===x(t)};function O(t){return!(!t||"object"!==x(t)||t.constructor!==Object)}function L(t){for(var e in t)return;return 1}function E(t){return"number"==typeof t&&!isNaN(t)}function M(t){return"function"===x(t)}function j(t){return null!=t&&t.window===t}var S,I,t=(S=String.prototype.trim,I=/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,S&&!S.call("\ufeffÂ ")?function(t){return null==t?"":S.call(t)}:function(t){return null==t?"":(t+"").replace(I,"")});function F(t){return t.nodeType}function k(t){return!t||!t.parentNode||11===t.parentNode.nodeType}function $(t){return t.trim().replace(/^-+/,"").replace(/-([a-z])/g,function(t,e){return e.toUpperCase()})}function H(t){var e=Array.prototype.slice;return e.apply(t,e.call(arguments,1))}function P(t,e){for(var n=0,r=t.length;n<r&&!1!==e(n,t[n]);++n);}function Q(t,e){for(var n in t)if(t.hasOwnProperty(n)&&!1===e(n,t[n]))break}function B(t,e){(_(t)?P:Q)(t,e)}function q(t,e){null!=e&&(t[t.length++]=e)}function W(n){return B(H(arguments,1),function(t,e){_(e)?P(e,function(t,e){q(n,e)}):q(n,e)}),n}function J(t,n,e){var r=e||[];return B(t,function(t,e){W(r,n(e,t))}),r}function R(t,e){var n,r=t||{},i=1,o=arguments.length;for("object"!==_typeof(r)&&"function"!=typeof r&&(r={});i<o;i++)if(null!=(n=arguments[i])){var a,u=void 0;for(u in n)a=n[u],"__proto__"!==u&&r!==a&&a!==c&&(r[u]=a)}return r}var U={},z="__tfc__"+Math.random();function V(t,e){return!!t.getAttribute&&0<=((t.getAttribute("class")||"").match(o)||[]).indexOf(e)}function X(t,e){G(t,e,function(t,e){-1===t.indexOf(e)&&t.push(e)})}function Y(t,e){G(t,e,function(t,e){e=t.indexOf(e);-1!==e&&t.splice(e,1)})}function G(t,e,r){var i;e&&t.setAttribute&&(i=(t.getAttribute("class")||"").match(o)||[],B(e.match(o)||[],function(t,e){for(var n;n=i.length,r(i,e),i.length!==n;);}),i.length?t.setAttribute("class",i.join(" ")):t.removeAttribute("class"))}T.extend({cache:U,expando:z,guid:1,_data:function(t,e,n){return T.data(t,e,n,!0)},data:function(t,e,n,r){if(T.acceptData(t)){var i=U[t[z]]||{};if(null==e)return(r?i:i.data)||{};if(O(e))r?R(i,e):i.data=R(i.data,e);else{if(!D(n))return r?i[e]:i.data&&i.data[e];(r?i:i.data=i.data||{})[e]=n}return U[t[z]=t[z]||T.guid++]=i,r?i:i.data}},removeData:function(t,e,n){var r=U[t[z]];if(T.acceptData(t)&&r){if(e){var i=n?r:r.data;if(i&&delete i[e],!i||!L(i))return}(n||(delete r.data,L(r)))&&T.cleanData([t])}},cleanData:function(t){P(t,function(t,e){var n=U[e[z]];if(T.acceptData(e)&&n){if(n.events){if(!n.handle)throw new Error("No store.handle while calling cleanData with remaining events");B(n.events,function(t){e.removeEventListener(t,n.handle,!1)})}var r,i,o=T._data(e,b);for(r in o)o.hasOwnProperty(r)&&(!(i=o[r])||-1!==(i=nt.timers.indexOf(i))&&nt.timers.splice(i,1));delete U[e[z]],e[z]=c}})},acceptData:function(t){return t&&(t.nodeType===y||9===t.nodeType)},hasData:function(t){return!!U[t[z]]}});var K=document.createElement("div");function Z(t,e){e=(e=F(e=e||document)?e:e[0]).ownerDocument||e;for(var n=t.length,r=[],i=0;i<n;i++)if((o=t[i])||0===o)if("object"===x(o))W(r,o.nodeType?[o]:o);else if(l.test(o)){for(var o=o.replace(d,"<$1></$2>"),a=(h.exec(o)||["",""])[1].toLowerCase(),u=w[a]||[],c=K,s=u.length;-1<--s;)c=c.appendChild(e.createElement(u[s]));c.innerHTML=o,r=H(K.childNodes)}else r=o?[e.createTextNode(o)]:[];var f=e.createDocumentFragment();return B(r,function(t,e){f.appendChild(e)}),K.innerHTML="",f}function tt(t,e){return H(Z([t],e).childNodes)}function et(t,e){return void 0!==t.getElementsByTagName?t.getElementsByTagName(e||"*"):void 0!==t.querySelectorAll?t.querySelectorAll(e||"*"):[]}T.extend({logging:!0,access:at,each:B,map:J,isArray:e,isFunction:M,isPlainObject:O,trim:t,type:x,parseHTML:tt,inArray:function(t,e,n){if(_(e)){var r=Array.prototype.indexOf;if(r)return r.call(e,t,n);var i=e.length;for(A(n)?n=0:n<0&&(n=Math.max(0,i+n));n<i;++n)if(e[n]===t)return n}return-1},css:function(t,e,n){e=$(e);n=T.style(t,e,n);return n=""===n?getComputedStyle(t)[e]:n},style:function(t,e,n){if(e=$(e),!D(n))return t.style[e];E(n)&&(n+=nt.numberOnly[e]?"":"px"),t.style[e]=n},attr:function(t,e,n){var r,i=t.nodeType;if(e&&i===y)if(e=e.toLowerCase(),bt[e]){var o=bt[e];if(A(n))return t[o]||(i=t.attributes.getNamedItem(e))&&i.specified?e:c;t[o]=!!n,n?t.setAttribute(e,e):t.removeAttribute(e)}else{if(A(n))return null===(r=-1!=="href,src,width,height".split(",").indexOf(e)?t.getAttribute(e,2):t.getAttribute(e))?c:r;t.setAttribute(e,n)}},prop:function(t,e,n){if(!D(n))return t[e];t[e]=n},now:function(){return(new Date).getTime()},isXMLDoc:function(t){var e=t&&t.namespaceURI,t=t&&(t.ownerDocument||t).documentElement;return!s.test(e||t&&t.nodeName||"HTML")},clone:function(t,e){var n=t.cloneNode(!0);if(u&&(t.nodeType===y||11===t.nodeType)&&!T.isXMLDoc(t))for(var r=et(n),i=et(t),o=0,a=i.length;o<a;o++)dt(r[o],"textarea")&&(r[o].defaultValue=i[o].defaultValue);return e&&(e=n,T.hasData(t=t)&&T.acceptData(e)&&(t=T._data(t),delete(t=T._data(e,t))[g],delete t[b],t.data&&(t.data=R({},t.data)))),n},contains:function(t,e){do{if(t===e)return!0}while(e=e.parentNode);return!1}});var nt=T.fx={timers:[],interval:13,timeoutId:null,addTimer:function(t){nt.timers.push(t),nt.timeoutId||nt.start()},start:function(){nt.timeoutId=setInterval(nt.tick,nt.interval)},tick:function(){for(var t,e=nt.timers,n=0;n<e.length;++n)(t=e[n])()||(t.anim.stop(),e.splice(n--,1));e.length||nt.stop()},stop:function(){clearInterval(nt.timeoutId),nt.timeoutId=null},numberOnly:{opacity:!0}};function rt(t,e){function n(t){return 1-e(1-t)}nt.easing["easeIn"+t]=e,nt.easing["easeOut"+t]=n,nt.easing["easeInOut"+t]=function(t){return t<.5?.5*e(2*t):.5*n(2*(t-.5))+.5}}function it(t){var e=0,n="";return E(t)?(e=t,n="px"):!N(t)||(t=t.match(r))&&(e=Number(t[1]),n=t[2]),{val:e,unit:n}}function ot(n,t,r){var e=T._data(n,g),i=T._data(n,b);e?e++:e=1,i=i||{},r=R({complete:C,duration:400,easing:"swing"},r);var t=J(t,function(t,e){return T.tween(n,e,t,nt.easing[r.easing])}),o=R({},r,{start:T.now(),tweens:t,go:function(n){B(o.tweens,function(t,e){e(n)}),1===n&&o.complete()},stop:function(t){t&&o.go(1),o._finally()},_finally:function(){var t=T._data(n,b);t&&(t[e]=c,T._data(n,b,t))}}),t=function(){var t=Math.min(1,(T.now()-o.start)/o.duration);return o.go(t),t<1};t.anim=o,i[e]=t,T._data(n,g,e),T._data(n,b,i),nt.addTimer(t)}function at(n,r,i,o){var t=!0;return D(o)?B(n,function(t,e){r(e,i,o)}):O(i)?Q(i,function(t,e){at(n,r,t,e)}):t=!1,t?n:n.length?r(n[0],i):c}function ut(t,e,n){return t.each(function(){e(this,n)})}function ct(n,r){return function(t,e){return n(this,r,t,e)}}function st(t,n,r,e){var i=e||[];return r=!!r,B(t,function(t,e){r===!n(t,e)&&q(i,e)}),i}nt.easing={linear:function(t){return t},swing:function(t){return.5-Math.cos(t*Math.PI)/2}},rt("Quad",function(t){return t*t}),rt("Cubic",function(t){return t*t*t}),rt("Sine",function(t){return 1-Math.cos(t*Math.PI/2)}),T.extend({Animation:ot,tweenFn:function(e,n,r,i){return function(t){i(e+(n-e)*r(t))}},tweenCss:function(e,n,t,r,i,o){return T.tweenFn(t,r,o,function(t){T.css(e,n,t+i)})},tweenProp:function(e,n,t,r,i){return T.tweenFn(t,r,i,function(t){T.prop(e,n,t)})},tween:function(t,e,n,r){var i,o;return T.propTweens[e]?(i=+T.prop(t,e),T.tweenProp(t,e,i,o=+n,r)):(e=$(e),i=it(T.css(t,e)),o=it(n),nt.numberOnly[e]&&(i.unit=o.unit=""),i.unit===o.unit?T.tweenCss(t,e,i.val,o.val,o.unit,r):void a.raise("different start/end units for",e,i,o))},propTweens:{scrollTop:!0}});var ft={visible:function(t){return 0<t.offsetWidth||0<t.offsetHeight},focus:function(t){return document.activeElement===t}};function lt(t,n,e){var r=M(n)?function(t,e){return n.call(e,t,e)}:F(n)?function(t,e){return e===n}:N(n)?function(t,e){return function(t,e){if(t.nodeType!==y)return!1;var n=e.match(i);return n||a.raise('Only element and class selectors are supported by tfcJQuery. "'+e+'"'),e=n[2],"."===(n=n[1])?V(t,e):":"===n?(ft[e]||a.raise("tfcJQuery does not support the :"+e+" selector"),ft[e](t)):t.tagName.toLowerCase()===e.toLowerCase()}(e,n)}:function(t,e){return-1!==T.inArray(e,n)};return st(t,r,e,T())}function dt(t,e){return t.nodeName&&t.nodeName.toLowerCase()===e.toLowerCase()}function ht(t){return t.type=(null!==t.getAttribute("type"))+"/"+t.type,t}function pt(t){return"true/"===(t.type||"").slice(0,5)?t.type=t.type.slice(5):t.removeAttribute("type"),t}function mt(t,e,n){var r=t.length,i=r-1;if(r){var o=Z(e,t[0].ownerDocument),e=o.firstChild;if(1===o.childNodes.length&&(o=e),e){for(var a,u=J(et(o,"script"),ht),c=u.length,s=0;s<r;s++)a=o,s!==i&&(a=T.clone(a,!0,!0),c&&W(u,et(a,"script"))),n.call(t[s],a,s);if(c){var f=u[u.length-1].ownerDocument;T.map(u,pt);for(var l=0;l<c;l++)a=u[l],p.test(a.type||"")&&!T.access(a,"globalEval")&&T.contains(f,a)&&(a.src&&"module"!==(a.type||"").toLowerCase()?jQuery._evalUrl&&!a.noModule&&jQuery._evalUrl(a.src,{nonce:a.nonce,crossOrigin:a.crossOrigin},f):function(t,e,n){if(n){var r=n.createElement("script");if(r.text=t,e)for(var i in{type:!0,src:!0,nonce:!0,noModule:!0})e[i]&&(r[i]=e[i]);n.head.appendChild(r).parentNode.removeChild(r)}}(a.textContent.replace(m,""),a,f))}}}return t}function vt(t,e,n){!N(e)&&1<t.length&&a.raise(n+" does not behave the same way as jQuery with multiple elements")}T.fn.extend({length:0,css:ct(at,T.css),style:ct(at,T.style),attr:ct(at,T.attr),prop:ct(at,T.prop),data:ct(at,T.data),removeData:ct(ut,T.removeData),addClass:ct(ut,X),removeClass:ct(ut,Y),get:function(t){return A(t)?this.toArray():this[(t<0?this.length:0)+t]},eq:function(t){return T(this.get(t||0))},each:function(n){return B(this,function(t,e){return n.call(e,t,e)}),this},map:function(n){return J(this,function(t,e){return n.call(t,e,t)},T())},filter:function(t){return lt(this,t,!1)},not:function(t){return lt(this,t,!0)},is:function(t){return 0<this.filter(t).length},toArray:function(){var n=[];return B(this,function(t,e){n.push(e)}),n},hasClass:function(t){return!!this.length&&V(this[0],t)},removeAttr:function(n){return n&&B(this,function(t,e){e.removeAttribute(n)}),this},toggleClass:function(e,i){return e&&B(this,function(t,r){B(e.match(o)||[],function(t,e){var n=i;((n=A(i)?!V(r,e):n)?X:Y)(r,e)})}),this},children:function(){return this.map(function(t,e){return J(e.childNodes,function(t){if(t.nodeType===y)return t})})},contents:function(){return this.map(function(){return this.childNodes})},add:function(t){return W(T(),this,T(t))},find:function(t){return this.map(function(){if(this.querySelectorAll)return this.querySelectorAll(t)})},animate:function(t,e,n){var r={};return O(e)?R(r,e):E(e)?r.duration=e:M(e)&&(n=e),M(n)&&(r.complete=n),this.each(function(){ot(this,t,r)})},fadeIn:function(t,e){return this.css({opacity:0}).show().animate({opacity:1},t,e)},fadeOut:function(t){if(D(t)&&!M(t))throw new Error("tfcJQuery#fadeOut currently only supports an optional callback argument");var e=this;return this.animate({opacity:0},function(){e.hide(),t&&t()})},stop:function(i){return this.each(function(){var t,e,n,r=T._data(this,b);for(t in r)!r.hasOwnProperty(t)||(e=r[t])&&(-1!==(n=nt.timers.indexOf(e))&&nt.timers.splice(n,1),e.anim.stop(i));T.removeData(this,g,!0),T.removeData(this,b,!0)})},remove:function(n){return B(this,function(t,e){n||e.nodeType!==y||(T.cleanData(e.getElementsByTagName("*")),T.cleanData([e])),e.parentNode&&e.parentNode.removeChild(e)}),this},detach:function(){return this.remove(!0)},empty:function(){return this.contents().remove(),this},html:function(t){var e=this[0]||{},n=0,r=this.length;if(t===c&&1===e.nodeType)return e.innerHTML;if("string"==typeof t&&!v.test(t)&&!w[(h.exec(t)||["",""])[1].toLowerCase()])try{for(;n<r;n++)1===(e=this[n]||{}).nodeType&&(T.cleanData(et(e,!1)),e.innerHTML=t);e=0}catch(t){}return e&&this.empty().append(t),this},text:function(e){var n=!1;return A(e)&&(n=!0,e=""),this.each(function(){var t=this.nodeType;3!==t&&t!==y||(n?e+=this.textContent:(T(this).empty(),this.textContent=e))}),n?e:this},parents:function(t){var e=this.map(function(){for(var t=[],e=this.parentNode;e;)t.push(e),e=e.parentNode;return t});return e=t?e.filter(t):e},parent:function(t){var e=this.map(function(){return this.parentNode});return e=t?e.filter(t):e},visible:function(){return this.style("visibility","visible")},invisible:function(){return this.style("visibility","hidden")},hide:function(){return this.style("display","none")},show:function(){return this.each(function(){if(this.nodeType===y){var t,e=this.nodeName.toLowerCase();switch(e){case"div":case"iframe":t="block";break;case"span":t="inline";break;default:a.raise("Calling show on unsupported element ["+e+"]")}this.style.display=t}})},append:function(t){return vt(this,t,"append"),mt(this,arguments,function(t){var e,n=this.nodeType;11!==n&&n!==y||(e=t,dt(n=this,"table")&&dt(11!==e.nodeType?e:e.firstChild,"tr")&&T(n).children("tbody")[0]||n).appendChild(t)})},prepend:function(t){return vt(this,t,"prepend"),mt(this,arguments,function(t){var e=this.nodeType;11!==e&&e!==y||(e=this.firstChild,this.insertBefore(t,e))})},before:function(t){return k(this[0])?W(T(),T(t),this):(vt(this,t,"before"),mt(this,arguments,function(t){this.parentNode&&this.parentNode.insertBefore(t,this)}))},replaceWith:function(r){return k(this[0])?this.length?W(T(),T(r)):this:(vt(this,r,"replaceWith"),N(r)||(r=T(r).detach()),mt(this,arguments,function(t){var e=this.parentNode,n=this.nextSibling;T(this).remove(),n?T(n).before(t):T(e).append(r)}))},clone:function(t){return this.map(function(){return T.clone(this,t)})},offset:function(){var t,e=this[0];if(e)return e.getClientRects().length?(t=e.getBoundingClientRect(),e=e.ownerDocument.defaultView,{top:t.top+e.pageYOffset,left:t.left+e.pageXOffset}):{top:0,left:0}},bind:function(t,e){return this.each(function(){T.event.add(this,t,e)})},unbind:function(t,e){return this.each(function(){T.event.remove(this,t,e)})}});var yt={Width:["Left","Right"],Height:["Top","Bottom"]};B(yt,function(t,e){var n=t.toLowerCase();T.fn[n]=function(){return arguments.length&&a.raise("tfcJQuery#"+n+" is only a getter"),this.length?function(t,e){var n;if(j(t))return t.document.documentElement["client"+e];if(9===t.nodeType)return n=t.documentElement,Math.max(n["scroll"+e],t.body["scroll"+e],n["offset"+e],t.body["offset"+e],n["client"+e]);var r=t["offset"+e],i=getComputedStyle(t);return B(yt[e],function(t,e){r-=it(i["padding"+e]).val,r-=it(i["border"+e+"Width"]).val}),r}(this[0],t):null}});var gt={};T.event={special:gt,add:function(t,e,n){var r,i,o;T.acceptData(t)&&(n.guid||(n.guid=T.guid++),o=T._data(t,{}),(r=o.handle)||((r=o.handle=function(t){return T.event.dispatch.call(r.elem,t)}).elem=t),i={type:e=(gt[i=e]||{}).fixType||e,origType:i,handler:n,guid:n.guid},(o=(n=o.events=o.events||{})[e])||(o=n[e]=[],t.addEventListener(e,r,!1)),o.push(i))},dispatch:function(t){var e=t.type,n=T._data(this,"events");if(n&&n[e])for(var r=n[e],i=0,o=r.length;i<o;++i){var a=r[i],u=(gt[a.origType]||{}).handle;!1===(u?u.call(this,t,a):a.handler.call(this,t))&&(t.preventDefault(),t.stopPropagation())}},remove:function(t,e,n){var r,i;T.acceptData(t)&&T.hasData(t)&&(i=(r=T._data(t)).events,e=(gt[e]||{}).fixType||e,i&&i[e]&&(i[e]=st(i[e],function(t,e){return!n||e.guid===n.guid},!0),0===i[e].length&&(delete i[e],t.removeEventListener(e,r.handle,!1)),L(i)&&(delete r.handle,T.removeData(t,"events",!0))))}},B({mouseenter:"mouseover",mouseleave:"mouseout"},function(t,e){gt[t]={fixType:e,handle:function(t,e){var n,r=t.relatedTarget;return n=!r||r!==this&&!T.contains(this,r)?e.handler.call(this,t):n}}});var bt={};B("selected,checked,disabled,multiple,readOnly,required,open".split(","),function(t,e){bt[e.toLowerCase()]=e}),B(["log","debug","warn","error"],function(t,e){a[e]=function(){T.logging&&n&&n[e].apply(n,arguments)}}),a.raise=function(){throw new Error(H(arguments).join(" "))};var wt=T(document);window.tfcJQuery=T}();
"use strict";var TFCApp;!function(){var e=(TFCApp=TFCApp||{getRunMode:function(){return e},isProdMode:function(){return e===TFCApp.RunModes.staging||e===TFCApp.RunModes.prod},isDevMode:function(){return e===TFCApp.RunModes.dev},RunModes:{dev:1,test:2,staging:3,prod:4},Constants:{BannerMode:{Register:"Register",Complete:"Complete"},RequestParameter:{Gender:"gender",Department:"department",AgeGroup:"ageGroup",Category:"category",ProductType:"productType",IPS:"ips",FirstName:"firstName",OrderId:"orderid",StyleColorId:"colorId",AvailableSizes:"availableSizes",Style:"style",CurrentStyle:"crStyle",ExcludedStyle:"exStyle",StoreEmbedded:"storeEmbedded",Placement:"placement",UserId:"userid",StoreRegistered:"storeRegistered",OriginWidget:"originWidget",Container:"container",ScreenSize:"screenSize",SessionParamOverrides:"sessionParamOverrides",AnalyticsSession:"analyticsSession",AnalyticsScreenSize:"analyticsScreenSize",AnalyticsArgs:"analyticsArgs",UniversalAnalyticsArgs:"universalAnalyticsArgs",PageName:"pageName",Funnels:"funnels",CookiesEnabled:"cookiesEnabled",SourceTrigger:"sourceTrigger",SourceOrigin:"sourceOrigin",StoreTla:"storeId",WindowParams:"windowParams",ServiceSecureURI:"serviceSecureURI",CdnSecureURI:"cdnSecureURI",StoreVersionPath:"storeVersionPath",ProfileComplete:"profileComplete",FitRecResult:"fitrecResult",CustomProfileJs:"customjs",IsEnteringData:"isEnteringData",WidgetContext:"widgetContext",Widget:"widget",AutoCalculate:"autoCalculate",ClientToServerLogging:"clientToServerLogging",Token:"token",IntegrationPlatform:"platform",ThirdPartyAuth:"thirdPartyAuth",ThirdPartyCredEmailCollectionEnabled:"thirdPartyCredEmailCollectionEnabled",RecipientAlias:"recipientAlias",IsSettingUpNewRecipient:"isSettingUpNewRecipient",EditRecipientLinkId:"editRecipientLinkId",IsShoppingForOther:"isShoppingForOther",OriginUrl:"originUrl",UserSettings:"userSettings",ApplicationName:"applicationName",SessionContext:"sessCtx",WidgetHidden:"widgetHidden",StoreExperimentKey:"storeExperimentKey",IncludeDislikes:"includeDislikes",RecipientProfileId:"recipientProfileId",ClientSupportsDiscovery:"csDiscovery",ClientSupportsSfo:"csSfo",AllowTokenCycling:"allowTokenCycling",TrackingOnly:"trackingOnly",QMEnabled:"qmEnabled",WidgetLocation:"widgetLocation",EmailOptInEnabled:"emailOptInEnabled",IncludeAgeQuestion:"includeAgeQuestion",AllowTraveling:"allowTraveling",ShopForOthersEnabled:"shopForOthersEnabled",DeviceType:"deviceType",ServiceMode:"serviceMode",Locale:"locale",IframeIntegration:"iframeIntegration"},RequestBody:{AgeGroup:"ageGroup",Context:"context",Gender:"gender",OrderId:"orderId",ProductType:"productType",StoreCategory:"storeCategory",Style:"style",Styles:"styles",WidgetLocation:"widgetLocation"},Header:{UserCookie:"x-tf-usercookie",UserToken:"x-tf-usertoken",UserTokenMaxAge:"x-tf-usertokenmaxage",UserTokenDomain:"x-tf-usertokendomain",UserTokenSecure:"x-tf-usertokensecure",IsUserRecognized:"x-tf-isuserrecognized",StoreUserId:"x-tf-storeuserid"},Attributes:{FIRST_NAME:"data-x-firstname",ORDER_ID:"data-orderid",GENDER:"data-gender",IPS:"data-ips",LOCALE:"data-locale",STYLE_ID:"data-styleid-private",STYLE_ID_NEW:"data-styleid",STYLE_ID_LEGACY:"id",USERID:"data-userid",USER_ID:"data-user-id",STORE_REGISTERED:"data-registered",STYLE_COLOR_ID:"data-colorid",AVAILABLE_SIZES:"data-availablesizes",CONTEXT:"data-context",RECIPIENT_ID:"data-recipient-id",STORE_CATEGORY:"data-store-category",CATEGORY:"data-category",AGE_GROUP:"data-age-group",WIDGET_HIDDEN:"data-widget-hidden",STORE_EXPERIMENT_KEY:"data-store-experiment-key",WIDGET_LOCATION:"data-widgetlocation"},DeviceType:{Mobile:"mobile",Desktop:"desktop",Responsive:"responsive"},AgeGroup:{Adult:"Adult",Child:"Child"},SessionContext:{Adult:"adult",Child:"child"},Category:{Bottoms:"Bottoms",Dresses:"Dresses",Shoes:"Shoes",Tops:"Tops",Bras:"Bras"},Department:{Boy:"Boys",Girl:"Girls",Men:"Mens",Unisex:"Unisex",UnisexKids:"UnisexKids",Women:"Womens"},Gender:{Male:"Male",Female:"Female",Unisex:"Unisex"},ProductType:{Tops:"Tops",Bottoms:"Bottoms",Shoes:"Shoes",DressShirts:"DressShirts",Dresses:"Dresses",Suits:"Suits",Bras:"Bras"},Classification:{DressShirts:"DressShirts"},IPS:{Discovery:"discovery",FitDetails:"fitdetails",Login:"login",NewProfile:"newprofile",UpdateProfile:"profile",Unknown:"unknown",Welcome:"welcome",GeneralSizeAdvice:"generalsizeadvice",Manage:"manage",Save:"save",SfoNew:"sfonew",SfoEdit:"sfoedit",SfoNewChild:"sfonewchild",InstantProfile:"instantprofile",ProfileSwitcher:"profileswitcher",InvalidGender:"invalidgender",IncompleteGarment:"incompletegarment",SizeNotAvailable:"sizenotavailable",ShopForOthers:"shopforothers"},Context:{QuickView:"quickview"},SourceTrigger:{Banner:"Banner",Widget:"Widget",Popup:"Popup",Tab:"Tab"},Container:{Modal:"modal",Tip:"tip",Fixed:"fixed"},IntegrationPlatform:{Web:"web",App:"app"},Message:{Open:"open",Close:"close",Update:"update",Complete:"complete",PageLoad:"pageload",SessionContext:"sessionContext",LogOut:"logout",Resize:"resize",ResizeModalWidth:"resizemodalwidth",Refresh:"refresh",UserSetting:"usersetting",UserSettings:"usersettings",UserToken:"usertoken",AddToBag:"addtobag",ScreenSizeChange:"screensizechange",FitRecResults:"fitrecresults",Chat:"chat",AppRevealed:"appRevealed",SizeChart:"sizechart",DiscoveryProductsViewed:"discoveryproductsviewed",DiscoveryRecommendationClicked:"discoveryrecommendationclicked",UserClick:"userclick"},NGEvents:{UpdateProfileStrength:"UpdateProfileStrength"},ScreenSize:{Small:"small",Large:"large"},LayoutPosition:{Right:"right",Left:"left"},UserSettings:{DiscoveryIntroMessageViewed:"dimv",DiscoveryExitSuppressed:"des",SessionParams:"session.params"},ModalWidth:{Wide:"wide",Narrow:"narrow"},LayoutType:{Inline:"inline",Modal:"modal"},FitRec:{Event:{LogOut:"logout",OpenDialog:"opendialog",MoreInfo:"moreinfo",OpenRegistration:"openreg",Render:"render",AutoSizeSelect:"autoSizeSelect",Experiments:"experiments"},Status:{EstimationInProgress:"estimationinprogress",Error:"error",IncompleteGarment:"incompletegarment",IncompleteProfile:"incompleteprofile",InvalidDepartment:"invaliddepartment",NoUser:"nouser",NoStyle:"nostyle",NoStyleNoUser:"nostylenouser",SizeNotAvailable:"sizenotavailable",Success:"success",UserDisabled:"userdisabled"},TemplateName:{AnonymousNotRecommended:"anonymousnotrecommended",AnonymousRecommended:"anonymousrecommended",EstimationInProgress:"estimationinprogress",Error:"error",IncompleteGarment:"incompletegarment",IncompleteProfile:"incompleteprofile",InvalidGender:"invalidgender",UnrecommendableDepartment:"unrecommendabledepartment",NoUser:"nouser",NoStyle:"nostyle",NoStyleNoUser:"nostylenouser",NotRecommended:"notrecommended",Recommended:"recommended",RecommendedGarmentUserSizeOnly:"garmentusersizeonly",RecommendedGarmentSizeOnly:"garmentsizeonly",RecommendedUserSizeOnly:"usersizeonly",RecommendedDepartmentSizeOnly:"departmentsizeonly",BrandAdvice:"brandadvice"}},Widgets:{Account:"tfc-fitrec-account",Catalog:"tfc-fitrec-catalog",Order:"tfc-order-notify",Product:"tfc-fitrec-product",Register:"tfc-fitrec-register",UserId:"tfc-set-userid"}},analytics:{},component:{},manager:{},tips:{},utility:{},add:function(e,t,i){i&&!TFCApp[e][i]?TFCApp[e][i]=t:TFCApp[e]||(TFCApp[e]=t)}}).RunModes.prod||TFCApp.RunModes.dev}();
"use strict";TFCApp.add("bind",function(t,o){if("function"!=typeof t)throw"Cannot bind to non-function";var r=Array.prototype.slice.call(arguments,2);return function(){var n=Array.prototype.slice.call(arguments);return t.apply(o,r.concat(n))}});
"use strict";!function(t,e){var i,n,r,o,l,c;c=/^(?:body|html)$/i,i={_getWindow:function(t){return this.isWindow(t)?t:9===t.nodeType&&(t.defaultView||t.parentWindow)},_scroll:function(t,n,r,o,e){var i=this._getWindow(t);if(void 0===n)return i?r in i?i[r]:i.document.documentElement[o]:t[o];i?i.scrollTo(e?this.scrollLeft(t):n,e?n:this.scrollTop(t)):t[o]=n},isWindow:function(t){return null!=t&&t==t.window},offsetParent:function(t){return t.map(function(){for(var t=this.offsetParent||document.body;t&&!c.test(t.nodeName)&&"static"===e.css(t,"position");)t=t.offsetParent;return t||document.body})},scrollLeft:function(t,n){return this._scroll(t,n,"pageXOffset","scrollLeft")},scrollTop:function(t,n){return this._scroll(t,n,"pageYOffset","scrollTop",!0)}},r=function(t,n){n=t.css(n),n=n?parseInt(n.replace("px","")):NaN;return isNaN(n)?0:n},o=function(t){return r(t,"paddingLeft")+t.width()+r(t,"paddingRight")},l=function(t,n){return(n?r(t,"marginLeft"):0)+r(t,"borderLeftWidth")+r(t,"paddingLeft")+t.width()+r(t,"paddingRight")+r(t,"borderRightWidth")+(n?r(t,"marginRight"):0)},(n=function(t){return e.apply(e,arguments)}).innerWidth=function(t){return e.fn.innerWidth?t.innerWidth():o(t)},n.outerWidth=function(t,n){n=n||!1;return e.fn.outerWidth?t.outerWidth(n):l(t,n)},n.scrollTop=function(t,n){return e.fn.scrollTop?(r=e(t),o=Array.prototype.slice.call(arguments,1),r.scrollTop.apply(r,o)):i.scrollTop(t,n);var r,o},n.scrollLeft=function(t,n){return e.fn.scrollLeft?(r=e(t),o=Array.prototype.slice.call(arguments,1),r.scrollLeft.apply(r,o)):i.scrollLeft(t,n);var r,o},n.parseHtml=function(t){return n(e.parseHTML(e.trim(t)))},t.extLibs=n}(TFCApp,tfcJQuery);
"use strict";function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}!function(e){var n=e.extLibs=e.extLibs||{};n.contains=function(e,t){do{if(t===e)return!0}while(t=t.parentNode);return!1};var r={canBubble:!0,cancelable:!0,view:window,detail:null,screenX:0,screenY:0,clientX:0,clientY:0,ctrlKey:!1,altKey:!1,shiftKey:!1,metaKey:!1,button:0,relatedTarget:null};n.mouseEvent=function(e,t,n){var o,c=document.createEvent("MouseEvent");for(o in"object"===_typeof(t)?n=t:(n=n||{}).type=t,r)r.hasOwnProperty(o)&&!n.hasOwnProperty(o)&&(n[o]=r[o]);n.button=0,c.initMouseEvent(n.type,n.canBubble,n.cancelable,n.view,n.detail,n.screenX,n.screenY,n.clientX,n.clientY,n.ctrlKey,n.altKey,n.shiftKey,n.metaKey,n.button,n.relatedTarget),e.dispatchEvent(c)},n.click=function(e,t){n.mouseEvent(e,"click",t)}}(TFCApp);
"use strict";!function(o){var t,e=!1,i=/xyz/.test(function(){xyz})?/\b_super\b/:/.*/;function s(){return function(){var t=this;e||t._constructor&&t._constructor.apply(t,arguments)}}function u(t,n){var r;return e=!0,r=new n,e=!1,function(t,n,r){for(var o in t)t.hasOwnProperty(o)&&(n[o]=r&&"function"==typeof t[o]&&"function"==typeof r.prototype[o]&&i.test(t[o])?function(r,o){return function(){var t,n=this._super;return this._super=o,t=r.apply(this,arguments),this._super=n,t}}(t[o],r.prototype[o]):t[o])}(t,r,n),r}function p(t){return this.prototype instanceof t}(t=s()).prototype.destroy=function(){var t,n=this;for(t in n)n.hasOwnProperty(t)&&delete n[t]},t.extend=o.bind(function t(n){var r=s();return r.prototype=u(n,this),(r.prototype.constructor=r).extend=o.bind(t,r),r.isSubClassOf=p,r},t),t.isSubClassOf=p,t.unimplemented=function(){throw new Error("Unimplemented abstract function")},o.add("Class",t)}(TFCApp);
"use strict";!function(e){var n=e.Class,n=n.extend({log:n.unimplemented,raise:n.unimplemented});n.LevelMap={TRACE:1,DEBUG:2,INFO:3,WARN:4,ERROR:5,OFF:6},e.add("utility",n,"LoggerEngine")}(TFCApp);
"use strict";!function(n){var e=n.utility.LoggerEngine,o=(e.LevelMap,window.console),i=!!o,t={TRACE:"trace",DEBUG:"debug",INFO:"info",WARN:"warn",ERROR:"error"};n.add("utility",e.extend({_constructor:function(n){this.level=n},log:function(n,e){n=t[n];i&&o[n]&&(o[n].apply?o[n].apply(o,e):o[n](e))},raise:function(){}}),"ConsoleLoggerEngine")}(TFCApp);
"use strict";!function(u){var n=u.utility,a=n.LoggerEngine.LevelMap,s=[];function o(n){var r=(new Error).stack;this.name="RaiseError",this.message=n,r&&(this.stack=r)}function c(n,r,e){return[[u.util.isoDateString(),n,"["+r+"]"].join(" ")].concat(e)}function r(n,r){for(var e=a[n],i=n.replace(/\n|\r/g,"â"),t=function(n){for(var r=[],e=0,i=n.length;e<i;e++){var t=n[e];t&&"string"==typeof t?r.push(t.replace(/\n|\r/g,"â")):r.push(t)}return r}(c(n,r,u.util.slice(arguments,2))),o=0,l=s.length;o<l;++o){var g=s[o];g.level<=e&&g.log(i,t)}}function e(n){for(var r=new o(c("EXCEPTION",n,u.util.slice(arguments,1)).join(" ")),e=0,i=s.length;e<i;++e){var t=s[e];t.level!==a.OFF&&t.raise(r)}throw r}var i={RaiseError:(o.prototype=Object.create(Error.prototype)).constructor=o,getLogger:function(n){return{trace:u.bind(r,null,"TRACE",n),debug:u.bind(r,null,"DEBUG",n),info:u.bind(r,null,"INFO",n),warn:u.bind(r,null,"WARN",n),error:u.bind(r,null,"ERROR",n),raise:u.bind(e,null,n)}},registerLoggingEngine:function(n){s.push(n)}};i.registerLoggingEngine(i.console=new n.ConsoleLoggerEngine(u.isDevMode()?a.DEBUG:a.WARN)),u.add("utility",i,"Logger")}(TFCApp);
"use strict";!function(t){var e,n,o=t.utility.Logger.getLogger("TFCdomready"),c=[],r=document,d=r.documentElement,a=d.doScroll,i="DOMContentLoaded",u="addEventListener",f="onreadystatechange",s="readyState",l=(a?/^loaded|^c/:/^loaded|c/).test(r[s]);function h(t){for(l=1;t=c.shift();)m(t)}function m(t){try{t()}catch(t){o.error(t)}}r[u]&&r[u](i,e=function(){r.removeEventListener(i,e,!1),h()},!1),a&&r.attachEvent(f,e=function(){/^c/.test(r[s])&&(r.detachEvent(f,e),h())}),t.extLibs.domready=n=a?function(e){self!=top?l?m(e):c.push(e):function(){try{d.doScroll("left")}catch(t){return setTimeout(function(){n(e)},50)}m(e)}()}:function(t){l?m(t):c.push(t)}}(TFCApp);
"use strict";window.TFPApp={analytics:{},component:{},utility:{},manager:{},view:{},nav:{}};
"use strict";!function(u){var t=u.Class,e=t.unimplemented,e=t.extend({getElem:e,setElem:e,removeElem:e,_each:e,_eachReverse:e,_size:function(){var t=0;return u.util.each(this,function(){++t}),t},_containsKey:function(e){var n=this;return!!u.util.find(n,function(t){return u.util.objEquals(t,e,n._strictKeys)})},_containsVal:function(n,i){return!!u.util.find(this,function(t,e){return u.util.objEquals(e,n,i)})},_isSorted:!1,_strictKeys:!0});u.add("Collection",e)}(TFCApp);
"use strict";!function(r){var t=r.Collection.extend({_constructor:function(t,e){var i=this;void 0!==t&&(i._strictKeys=t),e?r.util.usesStrictKeys(e)&&!i._strictKeys?(i._map=[],r.util.each(e,r.bind(i.setElem,i))):i._map=r.util.keyValPairs(e):i._map=[]},getElem:function(t){t=this._findEntry(t);return t&&t.val.val},setElem:function(t,e){var i=this._map,n=this._findEntry(t);n?n.val.val=e:i.push({key:t,val:e})},removeElem:function(t){t=this._findEntry(t);return t&&this._map.splice(t.key,1),t&&t.val.val},_each:function(t){for(var e,i=this._map,n=0;n<i.length&&!1!==t((e=i[n]).key,e.val);++n);},_eachReverse:function(t){for(var e,i=this._map,n=i.length-1;0<=n&&!1!==t((e=i[n]).key,e.val);--n);},_findEntry:function(i){var n=this;return r.util.find(n._map,function(t,e){return r.util.objEquals(e.key,i,n._strictKeys)})},_size:function(){return this._map.length},_map:null,_isSorted:!0});r.SortedMap=t}(TFCApp);
"use strict";function _typeof(n){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(n){return typeof n}:function(n){return n&&"function"==typeof Symbol&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n})(n)}!function(e,n,u){var t,a,r,o,i,c,s,f={},l=e.utility.Logger,p=g(),h=e.Collection,d=Array.prototype,m=d.slice,y=navigator.userAgent;function g(){return l.getLogger("TFCUtil")}function v(n,t){return t}function b(n){return n===u||n}function x(n){var t;return n instanceof h?n:"array"===(t=f.type(n))?new a(u,n):"object"===t||"function"===t?new r(u,n):void p.raise("Object is not a collection-like type",n)}function j(n){return n instanceof t?n.obj():n}function w(n){for(var t="",e=0;e<n.length;++e)t+=n[e].toString(16);return t}function S(t,e){f[t+f.capitalize(e)]=function(){var n=f[t].apply(f,arguments);return n&&n[e]}}t=h.extend({getElem:function(n){return this._obj[n]},setElem:function(n,t){this._obj[n]=t},obj:function(){return this._obj},_containsKey:function(n){return n in this._obj},_obj:null,_strictKeys:!0}),a=t.extend({_constructor:function(n,t){this._obj=t||[]},pushElem:function(n){this._obj.push(n)},removeElem:function(n){var t=this.getElem(n);return this._obj.splice(n,1),t},_each:function(n){for(var t=this._obj,e=0;e<t.length&&!1!==n(e,t[e]);++e);},_eachReverse:function(n){for(var t=this._obj,e=t.length-1;0<=e&&!1!==n(e,t[e]);--e);},_size:function(){return this._obj.length},_containsVal:function(n,t){var e=d.indexOf;return t&&e?0<=e.call(this._obj,n):this._super(n,t)},_isSorted:!0}),r=t.extend({_constructor:function(n,t){this._obj=t||{}},removeElem:function(n){var t=this.getElem(n);return delete this._obj[n],t},_each:function(n){var t,e=this._obj;for(t in e)if(Object.prototype.hasOwnProperty.call(e,t)&&!1===n(t,e[t]))break}}),f.stringToBool=function(n){return"true"===n},f.stringStartsWith=function(n,t){return 0===n.lastIndexOf(t,0)},f.stringEndsWith=function(n,t){return 0<=n.indexOf(t,n.length-t.length)},f.filter=function(n,t){return f.partition(n,t).true},f.partition=function(n,r){var n=x(n),o=new n.constructor(n._strictKeys),i=new n.constructor(n._strictKeys);return f.each(n,function(n,t){var e=r(n,t)?o:i;e instanceof a?e.pushElem(t):e.setElem(n,t)}),{true:j(o),false:j(i)}},f.map=function(n,e){var n=x(n),r=new n.constructor(n._strictKeys);return f.each(n,function(n,t){r instanceof a?r.pushElem(e(n,t)):r.setElem(n,e(n,t))}),j(r)},f.flatMap=function(n,t){return f.filter(f.map(n,t),function(n,t){return null!==t&&t!==u})},f.reverse=function(n){var n=x(n),e=new n.constructor(n._strictKeys);return f.eachReverse(n,function(n,t){e instanceof a?e.pushElem(t):e.setElem(n,t)}),j(e)},f.count=function(n,t){return f.size(f.filter(n,t))},f.sum=function(n){var e=0;return f.each(n,function(n,t){e+=t}),e},f.noop=function(){},f.reduce=function(e,r,n){var o,i=!1;if(n!==u)o=n;else{if(!f.isArray(e))throw new Error("you must provide an initial value when reducing an object");if(0===e.length)throw new TypeError("Reduce of empty array with no initial value");o=e[0],e=e.slice(1),i=!0}return f.each(e,function(n,t){o=r(o,n=i?n+1:n,t,e)}),o},f.groupByPreservingOrder=function(n,o,t){var i,u=x(n);if(t=b(t),i=new e.SortedMap(t),!u._isSorted)throw"TFCApp.util.groupByPreservingOrder cannot preserve order on unordered inputs";return f.each(u,function(n,t){var e,r=o(n,t);f.containsKey(i,r)?e=i.getElem(r):(e=new u.constructor(u._strictKeys),i.setElem(r,e)),u instanceof a?e.pushElem(t):e.setElem(n,t)}),f.map(i,function(n,t){return j(t)})},f.objKeys=function(n){var t=[];return f.each(n,function(n){t.push(n)}),t},f.objVals=function(n){var e=[];return f.each(n,function(n,t){e.push(t)}),e},f.keyValPairs=function(n){var e=[];return f.each(n,function(n,t){e.push({key:n,val:t})}),e},f.forAll=function(n,e){var r=!0;return f.each(n,function(n,t){return r=e(n,t)}),r},f.exists=function(n,t){return!!f.find(n,t)},f.objEquals=function(n,e,r){var t,o;return n===e||((r=b(r))?n===e:(t=f.type(n),o=f.type(e),"object"===t||"array"===t?t===o&&f.size(n)===f.size(e)&&f.forAll(n,function(n,t){return f.objEquals(t,e[n],r)}):n===e))},f.size=function(n){return x(n)._size()},f.isEmpty=function(n){return 0===f.size(n)},f.nonEmpty=function(n){return 0<f.size(n)},f.containsKey=function(n,t){return x(n)._containsKey(t)},f.containsVal=function(n,t,e){return e=b(e),x(n)._containsVal(t,e)},f.distinctVals=function(n,e){var r=[];return e=b(e),f.each(n,function(n,t){f.containsVal(r,t,e)||r.push(t)}),r},f.reduceToSingleValue=function(n){var e={};return f.each(n,function(n,t){t=f.distinctVals(t);0<t.length&&(e[n]=t[0],1<t.length&&p.error("Expected one distinct value for the ["+n+"] parameter, but got",t))}),e},f.loadScript=function(n){var t,e,r=document.body;function o(n){return function(){r.removeChild(t),n&&n()}}f.isNonZeroLengthString(n.url)||p.raise("loadScript options must have a non-empty url",n),n.cache=!1!==n.cache,n.cache||(n.data&&n.data.hasOwnProperty("_")&&p.error("do not use _ as a parameter name! loadScript will overwrite data._"),n.data=f.extend(n.data,{_:f.now()})),"object"===f.type(n.data)&&(e=-1<n.url.indexOf("?")?"&":"?",n.url+=e+f.param(n.data)),(t=document.createElement("script")).type="text/javascript",t.async=!0,t.src=n.url,t.onload=o(n.success),t.onerror=o(n.error),r.appendChild(t)},f.getCookie=function(r){var o=null;return f.each(document.cookie.split("; "),function(n,t){var e=t.indexOf("=");if(t.substr(0,e)===r)return o=t.substr(e+1),!1}),o},f.countCookie=function(r){var o=0;return f.each(document.cookie.split("; "),function(n,t){var e=t.indexOf("=");t.substr(0,e)===r&&(o+=1)}),o},f.setCookie=function(n){var t,e,r;"object"===f.type(n)&&"string"===f.type(n.name)&&"string"===f.type(n.value)?(t=n.name+"="+n.value,e=n.domain,f.isNonZeroLengthString(e)&&(t+=";domain="+e),t+=";path="+(f.isNonZeroLengthString(n.path)?n.path:"/"),e=parseInt(n.maxAge),isNaN(e)||(e<=0?e=r=0:r=(new Date).getTime()+1e3*e,t+=";max-age="+e,t+=";expires="+new Date(r).toUTCString()),n.secure&&(t+=";secure"),p.trace("Attempting to set the cookie: document.cookie="+t),document.cookie=t):p.warn("Invalid arguments, not setting the cookie. [data: "+JSON.stringify(n)+"]")},f.deleteCookie=function(n){"object"===f.type(n)&&f.setCookie({name:n.name,value:"",domain:n.domain,secure:n.secure,path:n.path,maxAge:0})},o="\\"+"\\[]{}()+*?!=^$,.-|:".split("").join("\\"),i=new RegExp("(["+o+"])","g"),f.regexSafe=function(n){return n.replace(i,"\\$1")},f.parseOrigin=function(n){return n.replace(/^\s*([^:]+:[\/\\]{2}[^\/\?\#\\]*).*$/,"$1")},f.parseParentDomain=function(n){var t,e=g();return n=n||document.location.href,""===(t=f.parseOrigin(n).replace(/^[^:]+:[\/\\]{2}([^:]*)(:[0-9]+)?$/,"$1"))||"localhost"===t||"about:blank"===t?null:t===n?(e.error("Could not parse domain from URL "+n),null):(n=/(^[^\.]+$)|([^\.]+\.((?:com|[^\.]{2})\.)?[^\.]+\.?$)/.exec(t))?n[0]:(e.error("Could not parse parent domain from domain "+t),null)},f.parseAllSubDomains=function(n){n=n||document.location.href;var t=f.parseParentDomain(n);if(null===t)return[];var e=f.parseOrigin(n).split("//")[1].split(":")[0],n=[];e!==t&&(n=e.substring(0,e.lastIndexOf(t)-1).split("."));var r=t,o=[r];return f.eachReverse(n,function(n,t){o.push(r=t+"."+r)}),o},f.isNonZeroLengthString=function(n){return"string"===f.type(n)&&0<n.length},f.addParamIfNonZeroLengthString=function(n,t,e){f.isNonZeroLengthString(e)&&(n[t]=e)},f.addParamIfDefined=function(n,t,e){e!==u&&(n[t]=e)},f.chooseUri=function(n,t){return"https:"===document.location.protocol?n:t},f.arrayToPairs=function(n){var e={};return f.each(n,function(n,t){e[t]=t}),e},f.param=function(n,r){if("object"!==f.type(n))throw"Invalid argument passed to util.param ["+f.type(n)+"]";var o=[];return f.each(n,function(e,n){var t=f.type(n);f.isPrimitive(n)?o.push(encodeURIComponent(e)+"="+encodeURIComponent(n)):"array"===t&&r?f.each(n,function(n,t){o.push(encodeURIComponent(e)+"="+encodeURIComponent(t))}):"array"===t||"object"===t?o.push(encodeURIComponent(e)+"="+encodeURIComponent(JSON.stringify(n))):p.raise("Invalid type passed to util.param",e,n)}),o.join("&")},f.deparam=function(n){for(var t,e,r,o={},i=n.split("&"),u=0,a=i.length;u<a;++u)if(2===(t=i[u].split("=",2)).length)try{e=decodeURIComponent(t[0]),r=decodeURIComponent(t[1]),o[e]=r}catch(n){p.warn("Failed to decode query parameters[key="+t[0]+",value="+t[1]+"]")}return o},f.getAttributes=function(n){var e={};return f.each(n.get(0).attributes,function(n,t){e[t.nodeName]=t.nodeValue}),e},f.keyToPrintableCharacter=function(n){var t=String.fromCharCode(n),n=t.charCodeAt(0);return 32<=n&&n<=126?t:""},f.arrayIndexOf=function(n,e){var r=-1;return f.each(n,function(n,t){if(t===e)return r=n,!1}),r},f.getQueryParams=function(n){return f.deparam((n||f.getLocationWithoutHash()).split("?",2)[1]||"")},f.getLocationWithoutHash=function(){return document.location.href.split("#",2)[0]},f.getLocationHash=function(){return/^[^#]+#?(.*)$/.exec(document.location.href)[1]},f.isTouchSupported="object"==_typeof(n.Touch),f.supportsTransitions=function(){var n=document.documentElement.style;return n.webkitTransition!==u||n.MozTransition!==u||n.OTransition!==u||n.transition!==u},f.syncTiming=function(e){return f.asyncTiming(function(n){var t=e();return{elapsed:n(),result:t}})},f.asyncTiming=function(n){var t=(new Date).getTime();return n(function(){return(new Date).getTime()-t})},f.defaultValue=function(n,t){return n!==u?n:t},f.addIfDefined=function(n,t,e){t=t[n];t!==u&&(e[n]=t)},f.randomInt=function(n,t){return n+Math.floor((t-n+1)*Math.random())},f.uuid=(c=n.crypto||n.msCrypto)&&n.Uint8Array?function(){for(var n=new Uint8Array(16),t=c.getRandomValues(n),e=[],r=0;r<t.length;++r)12===e.length?e.push(4):16===e.length?e.push(3&t[0]|8):e.push(t[r]>>4),e.push(15&t[r]);return w(e.splice(0,8))+"-"+w(e.splice(0,4))+"-"+w(e.splice(0,4))+"-"+w(e.splice(0,4))+"-"+w(e)}:function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(n){return("x"===n?f.randomInt(0,15):8|f.randomInt(0,3)).toString(16)})},f.each=function(n,t){n&&x(n)._each(t)},f.eachReverse=function(n,t){n&&x(n)._eachReverse(t)},f.usesStrictKeys=function(n){return x(n)._strictKeys},f.extend=function(e){var n=f.slice(arguments,1);return e=e||{},f.each(n,function(n,t){t&&f.each(t,function(n,t){e[n]=t})}),e},f.slice=function(n,t,e){return f.isArrayLike(n)||p.raise("You must provide an array-like object to util#slice"),m.apply(n,m.call(arguments,1))},f.last=function(n){return f.isArrayLike(n)||p.raise("You must provide an array-like object to util#last"),n[n.length-1]},f.drop=function(n,t){return f.isArrayLike(n)||p.raise("You must provide an array-like object to util#drop"),t===u&&(t=1),m.call(n,Math.max(0,t))},f.dropRight=function(n,t){return f.isArrayLike(n)||p.raise("You must provide an array-like object to util#dropRight"),t=n.length-(t=t===u?1:t),m.call(n,0,Math.max(0,t))},f.pad=function(n){return("number"!==f.type(n)||n<0||n%1!=0)&&p.raise("util.pad called with non-natural number:",n),n<10&&"0"+n||n.toString()},f.isoDateString=function(){var n=f.pad,t=new Date;return t.getFullYear()+"-"+n(t.getMonth()+1)+"-"+n(t.getDate())+" "+n(t.getHours())+":"+n(t.getMinutes())+":"+n(t.getSeconds())+"."+(t.getMilliseconds()/1e3).toFixed(3).slice(2)},f.now=function(){return(new Date).getTime()},f.isNaN=function(n){return"number"===f.type(n)&&isNaN(n)},f.isPrimitive=function(n){n=f.type(n);return"boolean"===n||"number"===n||"string"===n},function(){for(var n,t=Object.prototype.toString,e={},r="Boolean Number String Function Array Date RegExp Object".split(" "),o=0;o<r.length;++o)n=r[o],e["[object "+n+"]"]=n.toLowerCase();f.type=function(n){return null==n?String(n):e[t.call(n)]||"object"}}(),f.isPlainObject=function(n,t){return t=t===u||t,!(!n||"object"!==f.type(n)||t&&n.constructor!==Object)},f.isArray=function(n){return"array"===f.type(n)},f.isFunction=function(n){return"function"===f.type(n)},f.isVisible=function(n){return 0<n.offsetWidth||0<n.offsetHeight},f.isConstructor=function(n){try{return!0}catch(n){return!1}},f.capitalize=function(n){return n.charAt(0).toUpperCase()+n.substr(1)},f.camelCase=(s=/-(\w)/g,function(n){return n.toLowerCase().replace(s,function(n,t){return t.toUpperCase()})}),f.find=function(n,e){var r=u;return f.each(n,function(n,t){if(e(n,t))return!(r={key:n,val:t})}),r},f.head=function(n){if(n===u)return u;if(!(n=x(n))._isSorted)throw new Error("TFCApp.util.head is not intended for unordered inputs");return f.find(n,function(){return!0})},f.each(["find","head"],function(n,t){S(t,"key"),S(t,"val")}),f.readOnly=function(r,o){var n;return o===u&&(o=!0),"object"!==f.type(r)||(n=r)&&"function"===f.type(n.then)||f.each(r,function(n,t){var e=!!(t&&"object"===f.type(t)&&r.hasOwnProperty(n)&&Object.getOwnPropertyDescriptor(r,n).writable);Object.defineProperty(r,n,{writable:!1}),o&&e&&f.readOnly(t,o)}),r},f.hashKey=function(e){var n,t=f.type(e);switch(t){case"array":return"["+f.map(e,function(n,t){return f.hashKey(t)}).join(",")+"]";case"object":return n=f.objKeys(e).sort(),"{"+f.map(n,function(n,t){return JSON.stringify(t)+":"+f.hashKey(e[t])}).join(",")+"}";case"date":return e.toUTCString();case"string":return JSON.stringify(e);case"null":case"undefined":return t;case"boolean":case"number":case"regexp":case"function":return e.toString()}},f.isArrayLike=function(n){return!(!n||"number"!==f.type(n.length))},f.throttle=function(e,r,o){var i,u,a,c,s=0;o=o||{};function l(){s=!1===o.leading?0:f.now(),i=null,c=e.apply(u,a),i||(u=a=null)}function n(){var n=f.now();s||!1!==o.leading||(s=n);var t=r-(n-s);return u=this,a=arguments,t<=0||r<t?(i&&(clearTimeout(i),i=null),s=n,c=e.apply(u,a),i||(u=a=null)):i||!1===o.trailing||(i=setTimeout(l,t)),c}return n.cancel=function(){clearTimeout(i),s=0,i=u=a=null},n},f.debounce=function(t,e,r){function o(){var n=f.now()-c;n<e&&0<=n?i=setTimeout(o,e-n):(i=null,r||(s=t.apply(a,u),i||(a=u=null)))}var i,u,a,c,s;return function(){a=this,u=arguments,c=f.now();var n=r&&!i;return i=i||setTimeout(o,e),n&&(s=t.apply(a,u),a=u=null),s}},f.each({max:-1/0,min:1/0},function(u,a){f[u]=function(n,r){var o=a,i=null;return r=r||v,f.each(n,function(n,t){var e=r(n,t);(e!==o&&Math[u](o,e)===e||e===a&&null===i)&&(o=e,(i={key:n,val:t})[u]=e)}),i},f[u+"Val"]=function(n,t){t=f[u](n,t);return t&&t[u]}}),f.round=function(n,t){t=t||0;t=Math.pow(10,t);return Math.round(n*t)/t},f.retry=function(n,r,o,i,u){var a,c=10;u=void 0!==u?u:100,function t(e){a=(new Date).getTime(),n(r,function(){var n=(n="consistentInterval"===i?u:u*(1<<e-1))-((new Date).getTime()-a);e===c?o():setTimeout(function(){t(++e)},Math.max(0,n))})}(1)},f.isHttpSuccess=function(n){return 200<=n&&n<300},f.isRealMouseEvent=function(n){return!1!==n.isTrusted&&!(0===n.screenX&&0===n.screenY&&0===n.clientX&&0===n.clientY)},f.browser=f.readOnly({isEdge:/Edge/.test(y),isIE:/MSIE/.test(y)},!0),f.prependToStyleTag=function(n,t){return n.styleSheet?n.styleSheet.cssText=t+n.styleSheet.cssText:n.textContent=t+n.textContent,n},f.placeOnPage=function(n,t){return(t=t||document.getElementsByTagName("script")[0]).parentNode.insertBefore(n,t),n},f.sameOrigin=function(n,t){return t===n||t+":80"===n||n+":80"===t},f.range=function(n,t){for(var e=[],r=n;r<=t;r++)e.push(r);return e},f.isSingular=function(n){return 1===n},f.arrayToObject=function(n,e,r){var o={};return f.each(n,function(n,t){o[e(t)]=r(t)}),o},f.invert=function(n){var e={};return f.each(n,function(n,t){e[t]=n}),e},e.add("util",f)}(TFCApp,window,void 0);
"use strict";TFCApp.KeyCodes={Enter:13,Escape:27,Up:38,Down:40,Tab:9};
"use strict";!function(i){var n,c,t,e,r,u,s,o,a,f,p,_,l,h,d,y=i.Class,g=y.unimplemented,x=i.util,v=i.utility.Logger.getLogger("TypeHelper"),m=1;function w(){for(var t="",n=0;n<m;n++)t+="  ";return t}function b(e,r,t){var i=!0,u=x.slice(arguments,3),s=1<u.length;return x.each(u,function(t,n){t=e[t];if(n instanceof c){if(!n.test(t))return t=["Invalid argument(s) passed to "+(r||"function")+". \nExpected type"+(s?"s":"")+":(",x.map(u,function(t,n){return"\n"+w()+n.expected()}),"\n)\nbut got:\n"],!(i=[t.join(""),e,". Additionally, Function.prototype.bind=",Function.prototype.bind.toString()])}else v.raise("Invalid argument passed to TFCApp.checkArgs (curry 2)")}),t(i)}function T(t,n,e){if(x.isArrayLike(t)&&(void 0===n||x.isNonZeroLengthString(n)))return i.bind(b,null,t,n,e);v.raise("Invalid argument passed to TFCApp.checkArgs (curry 1)")}function A(t,n){return T(t,n,function(t){return!0!==t&&(v.error.apply(v,t),v.raise("Invalid arguments found by checkArgs. See error log.")),t})}function j(t,n){x.isArray(t)&&!(t.length<2)&&function(t){var e=x.isPlainObject(t)||x.isArray(t);e&&x.each(t,function(t,n){if(!(n instanceof c))return e=!1});return e}(t)||v.raise(n+" requires an array of at least two types as its type")}c=y.extend({_constructor:function(t,n,e){this._type=t,this.__not=!!n,this.__optional=!!e},not:function(){return new(this._class())(this._type,!this.__not,this.__optional)},optional:function(){return new(this._class())(this._type,this.__not,!0)},test:function(t){return this.__optional&&void 0===t||this.__not&&!this._test(t)||!this.__not&&this._test(t)},_test:g,expected:function(){var t=(this.__not?"not ":"")+this._expected();return this.__optional?"optional("+t+")":t},_expected:g,_class:g,_type:null,__not:null,__optional:null}),t=c.extend({_test:function(t){return x.type(t)===this._type},_expected:function(){return this._type},_class:function(){return t}}),u=t.extend({_constructor:function(t,n,e){this._super("number",n,e)},_class:function(){return u},fromString:function(t){A(arguments)(n.String);t=parseFloat(t);return isFinite(t)?t:void 0}}),s=u.extend({_test:function(t){return this._super(t)&&t%1==0},_expected:function(){return"integer"},_class:function(){return s},fromString:function(t){A(arguments)(n.String);t=this._super(t);return this._test(t)?t:void 0}}),o=t.extend({_constructor:function(t,n,e){this._super("boolean",n,e)},_class:function(){return o},fromString:function(t){switch(A(arguments)(n.String),t){case"true":return!0;case"false":return!1}}}),a=t.extend({_constructor:function(t,n,e){this._super("string",n,e)},_class:function(){return a},fromString:function(t){return A(arguments)(n.String),t}}),f=t.extend({_constructor:function(t,n,e){this._super("array",n,e)},_class:function(){return f}}),l=c.extend({_constructor:function(t,n,e){j(t,"TupleType"),this._super(t,n,e)},_test:function(e){var r=x.isArray(e)&&e.length===this._type.length;return r&&x.each(this._type,function(t,n){if(!n.test(e[t]))return r=!1}),r},_expected:function(){var t=x.map(this._type,function(t,n){return n.expected()});return"Tuple"+t.length+"["+t.join(", ")+"]"},_class:function(){return l}}),h=c.extend({_constructor:function(t,n,e){j(t,"OrType"),this._super(t,n,e)},_test:function(e){var r=!1;return x.each(this._type,function(t,n){if(n.test(e))return!(r=!0)}),r},_expected:function(){return"one of ("+x.map(this._type,function(t,n){return n.expected()}).join(", or ")+")"},_class:function(){return h}}),d=c.extend({_constructor:function(t,n,e){var r=i.type.Tuple(i.type.Or(i.type.Instance(f),i.type.Instance(p)),i.type.Instance(c));r.test(t)||v.raise("OfType requires "+r.expected()+" as its type"),this._super(t,n,e)},_test:function(t){var e=this._type,r=e[0].test(t);return r&&x.each(t,function(t,n){if(!e[1].test(n))return r=!1}),r},_expected:function(){var t=this._type;return t[0].expected()+" of "+t[1].expected()},_class:function(){return d}}),e=t.extend({_constructor:function(t,n,e){var r=t.fieldTypes,i=x.isPlainObject(r);i&&x.each(r,function(t,n){if(!(n instanceof c))return i=!1}),i||v.raise("ObjectType type argument must be a plain object with Type values"),this._super(t,n,e)},_test:function(e){var t=this._type,r=x.isPlainObject(e,t.strict);return r&&x.each(t.fieldTypes,function(t,n){if(!n.test(e[t]))return r=!1}),r},_expected:function(){var e=[];return m++,x.each(this._type.fieldTypes,function(t,n){e.push(w()+t+":"+n.expected())}),m--,"{\n"+e.join(", \n")+"\n"+w()+"}"},_class:function(){return e}}),p=e.extend({_constructor:function(t,n,e){this._super({fieldTypes:{}},n,e)},_expected:function(){return"object"},_class:function(){return p}}),r=c.extend({_constructor:function(t,n,e){x.isConstructor(t)||v.raise("InstanceType type argument must be a function/constructor"),this._super(t,n,e)},_test:function(t){return t instanceof this._type},_expected:function(){return"instance of "+(this._type.name||"anonymous")},_class:function(){return r}}),_=c.extend({_test:function(t){return!0},_expected:function(){return"any"},_class:function(){return _}}),g=new t("function"),n={Any:new _,Null:new t("null"),Boolean:new o,Number:new u,Integer:new s,String:new a,Function:g,Array:new f,PlainObject:new p,Promise:new e({fieldTypes:{then:g},strict:!1}),Object:function(t,n){return new e({fieldTypes:t,strict:n})},Instance:function(t){return new r(t)},Tuple:function(t,n){return t=x.slice(arguments),new l(t)},Or:function(t,n){return t=x.slice(arguments),new h(t)},ArrayOf:function(t){return new d([n.Array,t])},ObjectOf:function(t){return new d([n.PlainObject,t])}},i.add("type",n),i.add("checkArgs",A),i.add("checkArgsSoft",function(t,n){return T(t,n,function(t){return!0!==t&&v.error.apply(v,t),t})})}(TFCApp);
"use strict";!function(d){var g=d.util,n=d.type,r=d.checkArgs,T=d.utility.Logger.getLogger("Http"),f=d.Constants.Header,h=/^\)]\}',?\n/,e={post:function(e){r(arguments)(n.Object({serviceSecureUrl:n.String,data:n.Or(n.String,n.PlainObject,n.Array),userToken:n.String.optional(),queryParameters:n.PlainObject.optional(),headers:n.PlainObject.optional(),success:n.Function.optional(),failure:n.Function.optional()}));var t=e.data;g.isPlainObject(t)||g.isArray(t)?e.payload=JSON.stringify(t):e.payload=t,e.method="POST",this._sendRequest(e)},get:function(e){r(arguments)(n.Object({serviceSecureUrl:n.String,responseType:n.String.optional(),userToken:n.String.optional(),queryParameters:n.PlainObject.optional(),success:n.Function.optional(),failure:n.Function.optional(),withCredentials:n.Boolean.optional()})),e.method="GET",this._sendRequest(e)},_addHeaders:function(n,e){e&&g.each(e,function(e,t){n.setRequestHeader(e,t)})},_sendRequest:function(e){var s,n,t=e.method,r=e.serviceSecureUrl,o=e.payload,a=e.queryParameters,i=e.responseType,c=e.success,p=e.failure,u=!!e.withCredentials,l=e.headers||{},e=e.userToken;e&&(l[f.UserToken]=e),g.isNonZeroLengthString(r)&&(s=new XMLHttpRequest,r=r,n={},(a=a)&&g.each(a,function(e,t){g.addParamIfNonZeroLengthString(n,e,t)}),r=r+"?"+g.param(n,!1),"withCredentials"in s?(s.withCredentials=u,s.open(t,r,!0),this._addHeaders(s,l),"POST"===t&&s.setRequestHeader("Content-Type","application/json; charset=UTF-8")):"undefined"!=typeof XDomainRequest&&(s=new XDomainRequest).open(t,r)),s&&(s.send(o),s.onreadystatechange=function(){if(4===s.readyState)if(g.isHttpSuccess(s.status)){var e,t,n,r;if(d.cookieHelper&&(n=s.getAllResponseHeaders().split("\r\n"),e=(r=g.arrayToObject(n,function(e){return e.split(": ")[0].toLowerCase()},function(e){return e.split(": ")[1]}))[f.UserToken],t=parseInt(r[f.UserTokenMaxAge]),n=r[f.UserTokenDomain],r=!!r[f.UserTokenSecure],e&&d.cookieHelper.userToken(e,g.isNaN(t)?void 0:t,n,r)),"json"===i&&0<s.responseText.trim().length)try{s.data=JSON.parse(s.responseText.replace(h,"").trim())}catch(e){return T.error("Unable to parse JSON from HTTP response expecting JSON [response text: "+s.responseText+"]",e),void(p&&p(s))}c&&c(s)}else p&&p(s)})}};d.add("utility",e,"Http")}(TFCApp);
"use strict";!function(a){a.FitRecUtil={animateFitScore:function(t,e,i){var c=i||500,s=this.fitDescriptionClass(e),n=a.extLibs(".tfc-fitrec-result",t),o=a.extLibs(".tfc-fit-score",n),i=a.extLibs(".tfc-fit-score-background",n),t=a.extLibs(".tfc-fit-score-foreground",i),i=e/5*100+"%";function r(){setTimeout(function(){s&&n.addClass(s),n.hide().show(0)},1),o.animate({opacity:1},c/2)}n.removeClass("tfc-excellent-fit"),n.removeClass("tfc-good-fit"),o.text(""),t.css("width",""),this.recommended(e)?n.removeClass("tfc-not-recommended"):n.addClass("tfc-not-recommended"),t.length?t.css("width","0%").animate({width:i},c,r):r()},fitDescriptionClass:function(t){switch(parseFloat(t)){case 5:case 4.5:case 4:return"tfc-excellent-fit";case 3.5:case 3:return"tfc-good-fit";default:return}},recommended:function(t){return void 0!==t&&3<=parseFloat(t)},evalTemplate:function(t,e){var i,c,s="img[src]";if("boolean"!=typeof e&&(e=!1),"string"==typeof t)try{i=a.extLibs.parseHtml(t)}catch(t){}return void 0===i&&(i=a.extLibs()),e&&(c=i.filter(s),i.each(function(t,e){c=c.add(s,e)}),c.each(function(t,e){(new Image).src=a.extLibs(e).attr("src")})),i}}}(TFCApp);
"use strict";TFCApp.Signal=TFCApp.Class.extend({_constructor:function(){this._slots=[]},listen:function(t){if("function"!=typeof t)throw"Slot passed into Signal.listen must be a function";this._slots.push(t)},unlisten:function(t){var n,s,i=null,l=this._slots;if("function"!=typeof t)throw"Slot passed into Signal.unlisten must be a function";for(n=0,s=l.length;n<s;++n)if(l[n]===t){i=n;break}null!==i&&l.splice(i,1)},unlistenAll:function(){this._slots.splice(0)},trigger:function(){var n=arguments;this._slots.slice().forEach(function(t){t.apply(null,n)})},_slots:null});
"use strict";!function(s){var i=s.util,o=s.type,r=s.utility.Logger.getLogger("PostMessage");function a(t){if(r=t,i.exists([o.Boolean,o.Integer,o.Number,o.String],function(t,e){return e.test(r)}))return t;if(o.Array.test(t))return i.flatMap(t,function(t,e){return a(e)});if(o.PlainObject.test(t)){var n={};return i.each(t,function(t,e){e=a(e);null!=e&&(n[t]=e)}),n}var r}s.utility.PostMessage={hasPostMessage:function(t){return!!t.postMessage},post:function(t,e,n){s.checkArgs(arguments)(o.Any,o.String,o.Or(o.PlainObject,o.String)),t||r.raise("Trying to post a message without a target window."),e||r.error("Trying to post a message without a target origin. Using wild card origin."),this.hasPostMessage(t)&&t.postMessage(a(n),e||"*")},receive:function(t,e,n){var r;return s.checkArgs(arguments)(o.Object({},!1),o.Function,o.String),this.hasPostMessage(t)?(t.addEventListener("message",r=function(t){if("*"!==n&&!i.sameOrigin(n,t.origin))return!1;e(t)},!1),function(){t.removeEventListener("message",r,!1)}):i.noop}}}(TFCApp);
"use strict";!function(o,s,t){var e=1,c=o.util,u=o.type,l=o.utility.PostMessage,d=l.hasPostMessage(s),n=o.Constants.RequestParameter.WindowParams,r={},g="ACKNOWLEDGE",f={_callbackFailureTimeout:1e4,_nextCallbackId:1,_callbackListenerAction:function(e){var t,n;e.data&&u.String.test(e.data)&&((n=e.data).substring(0,g.length)==g&&(t=n.substring(g.length),(n=r[t])&&c.sameOrigin(n.targetOrigin,e.origin)&&(delete r[t],clearTimeout(n.failureTimeout),n.onSuccess&&n.onSuccess())))},_setFailureTimeout:function(e,t){return setTimeout(function(){delete r[e],t&&t()},this._callbackFailureTimeout)},_setupCallback:function(e,t,n,i){var a=this,i=a._setFailureTimeout(e,i);r[e]={targetOrigin:t,onSuccess:n,failureTimeout:i},s.addEventListener("message",o.bind(a._callbackListenerAction,a),!1)},_sendMessageBack:function(e,t){var n;e.source&&(n=g+e.data,l.post(e.source,t,n))},postMessage:function(e,t,n,i,a,r,s){o.checkArgs(arguments)(u.Any,u.String,u.String,u.String,u.Or(u.String,u.PlainObject).optional(),u.Function.optional(),u.Function.optional());t&&n&&(i={sourceWindowId:n,message:i,data:a},(r||s)&&(i.tfcCallbackId=this._nextCallbackId++),d&&(a=JSON.stringify(i),l.post(e,t,a),i.tfcCallbackId&&this._setupCallback(a,t,r,s)))},receiveMessage:function(n,i,a){o.checkArgs(arguments)(u.Function,u.String,u.String);var e,r=this;return d?(e=function(e){var t=e.data;return!!u.String.test(t)&&(t.substring(0,g.length)!==g&&(((t=JSON.parse(t)).sourceWindowId===a||f.globalWindowId()===a)&&(t.tfcCallbackId&&r._sendMessageBack(e,i),void n(t.message,t.data))))},l.receive(s,e,i)):c.noop},generateWindowParams:function(e){return o.checkArgs(arguments)(u.String),n+"="+encodeURIComponent(e+"!"+c.parseOrigin(t.URL))},parseWindowParams:function(){var e=/^([^!]+)!(.*)$/.exec(c.deparam(c.getLocationHash())[n]);return{sourceWindowId:e&&e[1]||"",retailerOrigin:e&&e[2]||""}},globalWindowId:function(){return"*"},retailerWindowId:function(){return"O"},fitProfileWindowId:function(){return"R"},nextWindowId:function(){return(e++).toString()}};o.postMessageManager=f}(TFCApp,window,document);
"use strict";!function(e){var s=e.Class,n=s.unimplemented,n=s.extend({userSession:n,removeUserSession:n,userToken:n,sessionContext:n});e.add("CookieHelper",n)}(TFCApp);
"use strict";function _typeof(t){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}!function(n){var i=n.utility,l=n.type,t=i.LoggerEngine,g=t.LevelMap;function r(t){var o=[];return JSON.stringify(t,function(t,e){if(e instanceof HTMLElement)return e.outerHTML;if("object"===_typeof(e)){if(0<=o.indexOf(e))return"[Circular]";o.push(e)}return e})}n.add("utility",t.extend({_constructor:function(t,e){n.checkArgs(arguments)(l.Object({secureUri:l.String,tla:l.String,level:l.String.optional(),loggingTimeoutDelay:l.Integer.optional(),postRequestLimit:l.Integer.optional(),clientLogLimit:l.Integer.optional(),loggingContextLimit:l.Integer.optional()}),l.Instance(n.CookieHelper));var o=this,i={secureUri:t.secureUri,tla:t.tla,level:t.level||"ERROR",loggingTimeoutDelay:t.loggingTimeoutDelay||1e3,postRequestLimit:t.postRequestLimit||25,clientLogLimit:t.clientLogLimit||20,loggingContextLimit:t.loggingContextLimit||4},t="/consumer/ui/"+i.tla+"/client-log";o.level=g[i.level],o._cfg=i,o._serviceSecureUrl=i.secureUri+t,o._clientLogs=[],o._timeout=null,o._postCount=0,o._loggingContext=[],o._cookieHelper=e},log:function(t,e){var o=g[t],i=this,n=i._cfg,l=i.level;0!==n.loggingContextLimit&&(o===g.INFO||l===g.ERROR&&o===g.WARN)&&(i._loggingContext.length===n.loggingContextLimit&&i._loggingContext.shift(),i._loggingContext.push(r(e))),i._post({level:t,message:r(e)})},raise:function(t){this._post({level:"ERROR",error:t})},_post:function(t){var e=this,o=e._cfg;e._postCount<o.postRequestLimit&&(null===e._timeout&&(e._timeout=setTimeout(function(){var t=e._cookieHelper.userToken();++e._postCount,i.Http.post({serviceSecureUrl:e._serviceSecureUrl,data:{clientLogs:e._clientLogs,postNumber:e._postCount,loggingContext:e._loggingContext},userToken:t}),e._clientLogs=[],e._timeout=null,e._loggingContext=[]},o.loggingTimeoutDelay)),e._clientLogs.length<o.clientLogLimit&&e._clientLogs.push(t))}}),"HttpLoggerEngine")}(TFCApp);
"use strict";!function(t){var n=t.util,r=window.history,a=["pushState","replaceState"],e=r&&n.forAll(a.concat("state"),function(t,n){return n in r});t.history=e?r:n.extend({state:null},n.map(n.arrayToPairs(a),function(){return n.noop}))}(TFCApp);
"use strict";!function(e){var n=e.type,t=e.Class.extend({_constructor:function(t,i){e.checkArgs(arguments)(n.Any,n.Function),this._value=t,this._write=i},read:function(){return this._value},write:function(t){this._write(this._value=t)}});e.utility.TempStorage=t}(TFCApp);
"use strict";!function(t){var n="tfc-ls",o=window.localStorage,a=t.utility.Logger.getLogger("LocalStorage"),e=t.Class.extend({isEnabled:function(){function t(){return o&&o.getItem(n)}return!(!t()&&!function(){try{o.setItem(n,"{}")}catch(t){a.info("Unable to set value in localStorage",t)}return t()}())},get:function(t){return this._getLocalStorageObject()[t]},set:function(t,e){var r=this._getLocalStorageObject();r[t]=e;try{return o.setItem(n,JSON.stringify(r)),!0}catch(t){return a.info("Unable to set value in localStorage",t),!1}},_getLocalStorageObject:function(){var t=o.getItem(n);return t&&JSON.parse(t)||{}}});t.add("utility",e,"LocalStorage")}(TFCApp);
"use strict";!function(c){var e=c.utility,g=c.util,u=c.type,h=e.Logger.getLogger("Storage"),d="tfc-l",p="tfc-s",o={Analytics:"a",SessionContext:"c",UserVisit:"v",UserSettings:"s",User:"u",Test:"t",Token:"k"},a=[o.UserSettings,o.User],t={};t[o.Analytics]="tfcAnalytics",t[o.UserVisit]="tfcUserVisit",t[o.UserSettings]="tfcUserSettings",t[o.User]="_tfcUserCookie";e=c.Class.extend({_constructor:function(e){c.checkArgs(arguments)(u.Object({readImpl:u.Function,writeImpl:u.Function,deleteImpl:u.Function,supportsLegacyCookies:u.Boolean.optional()})),this._readImpl=e.readImpl,this._writeImpl=e.writeImpl,this._deleteImpl=e.deleteImpl,this._supportsLegacyCookies=e.supportsLegacyCookies||!1,this._logLocalStorageDeleteError=e.logLocalStorageDeleteError||!1},_localStorageSet:!1,_getLegacyCookieName:function(e){return this._supportsLegacyCookies?t[e]:void 0},_writeOne:function(e,t,o,r,i){c.checkArgs(arguments)(u.String,u.PlainObject,u.Integer.optional(),u.String.optional(),u.Boolean.optional());var n;g.isEmpty(t)?this._deleteImpl(e):(n=encodeURIComponent(JSON.stringify(t)),4096<(t=e.length+n.length)?h.error("Attempt to save cookie ["+e+"] larger than 4096 bytes ["+t+"]. This is not supported by some browsers."):500<t&&h.warn("Attempt to save cookie ["+e+"] larger than 500 bytes ["+t+"]. Consider reducing the amount of data being stored."),o={name:e,value:n,maxAge:o},r&&(o.domain=r),i&&(o.secure=i),this._logLocalStorageDeleteError&&e===d&&(this._localStorageSet=!0),this._writeImpl(o))},_writeBoth:function(e,t,o,r){c.checkArgs(arguments)(u.PlainObject,u.PlainObject,u.String.optional(),u.Boolean.optional());this._writeOne(d,e,31536e4,o,r),this._writeOne(p,t,void 0,o,r)},_readOne:function(e){c.checkArgs(arguments)(u.String);var t=this._readImpl(e);return this._logLocalStorageDeleteError&&e===d&&(t?this._localStorageSet=!0:null===t&&this._localStorageSet&&(h.error(d+" was unintentionally deleted."),this._localStorageSet=!1)),t?JSON.parse(decodeURIComponent(t)):{}},getValueWithMaxAge:function(e){c.checkArgs(arguments)(u.String);var t=this,o=t._readOne(d),r=t._readOne(p),i=t._getLegacyCookieName(e),n=i?t._readImpl(i):null;if(e in o){i=g.now()/1e3;return o[e].e<=i?(t.delete(e),h.warn("The value stored in the local cookie has expired. [key: "+e+"]"),null):{value:o[e].v,maxAge:parseInt(o[e].e-i)}}return e in r?{value:r[e]}:(g.containsVal(a,e)||h.warn("The value was not found in the local or session cookie. Attempting to use legacy cookie. [key: "+e+"]"),{value:n})},get:function(e){e=this.getValueWithMaxAge(e);return e&&e.value},set:function(e,t,o,r,i){c.checkArgs(arguments)(u.String,u.Or(u.String,u.PlainObject),u.Or(u.Null,u.Integer).optional(),u.String.optional(),u.Boolean.optional());var n=this,a=n._readOne(d),s=n._readOne(p),l=n._getLegacyCookieName(e);if(l&&n._deleteImpl(l),u.Integer.test(o)){if(o<=0)return n.delete(e),void h.warn("Max age is less than zero; deleting the key from the cookie [key:"+e+", maxAge: "+o+"]");delete s[e],a[e]={v:t,e:parseInt(g.now()/1e3+o)}}else delete a[e],s[e]=t;n._writeBoth(a,s,r,i)},delete:function(e){c.checkArgs(arguments)(u.String);var t=this,o=t._readOne(d),r=t._readOne(p),i=t._getLegacyCookieName(e);i&&t._deleteImpl(i),delete o[e],delete r[e],t._writeBoth(o,r)},enabled:function(){var e,t=o.Test;return this.set(t,"x"),e="x"===this.get(t),this.delete(t),e},isLegacy:function(e){c.checkArgs(arguments)(u.String);e=this._getLegacyCookieName(e);return!!e&&null!==this._readImpl(e)}});e.keys=o,e.LocalStorageName=d,e.SessionStorageName=p,c.add("utility",e,"Storage")}(TFCApp);
"use strict";!function(e){var r=e.util,n=e.utility,i=n.Storage,u=n.TempStorage,c=n.Logger.getLogger("StorageFactory"),n={cookieBased:function(o){var e=document.location.href,n=r.parseAllSubDomains();function a(o,a){r.each(n,function(e,n){n!==a&&r.deleteCookie({name:o,domain:n})})}return o.domain&&!r.containsVal(n,o.domain)&&c.error("True Fit was loaded on a domain not matching the retailer's configured cookie domain. True Fit may experience degraded or broken functionality. Configuration value:",o.domain,"Current URL:",e,"Parsed sub-domains:",n),o.secure&&!r.stringStartsWith(e,"https")&&c.error("True Fit was loaded on a non-HTTPS domain, but is configured to use a secure cookie. True Fit may experience degraded or broken functionality. Configuration value:",o.secure,"Current URL:",e),new i({readImpl:function(e){return r.getCookie(e)},writeImpl:function(e){var n;o.readOnly||(n=r.extend({domain:r.parseParentDomain()},e,o),r.setCookie(n),1<r.countCookie(e.name)&&a(e.name,n.domain))},deleteImpl:function(e){o.readOnly||a(e)},supportsLegacyCookies:!0,logLocalStorageDeleteError:!o.readOnly})},messageBased:function(n,e){var o=new u({value:e.tfcL},function(e){n.messageManager.sendTfcL(e.value,e.maxAge)}),a=new u({value:e.tfcS},function(e){n.messageManager.sendTfcS(e.value)});function r(e,n){return e===i.LocalStorageName?n(o):e===i.SessionStorageName?n(a):void c.error("Unknown storage key: ",e)}function t(n){r(n.name,function(e){return e.write(n)})}return new i({readImpl:function(e){e=r(e,function(e){return e.read()});return e&&e.value||null},writeImpl:t,deleteImpl:function(e){t({name:e,value:"",maxAge:0})}})}};e.add("utility",n,"StorageFactory")}(TFCApp);
"use strict";!function(r){var n=r.util,t=r.Class.extend({_constructor:function(){var t=this;n.each({openPrivacyPolicy:"privacy-policy",openTermsOfUse:"terms"},function(r,n){t[r]=function(r){r=t.getPrivacyOrTermsUrl(n,r);t.openPopup(r)}})},getPrivacyOrTermsUrl:function(r,n){var t="https://truefit.com";if("terms"===r)return"".concat(t,"/terms-of-use");n=n.match(/[-_]ru$/i)?"ru-ru/":"";return"".concat(t,"/").concat(n,"privacy-policy")},openPopup:function(r){window.open(r,"_blank")}});r.popupManager=new t}(TFCApp);
"use strict";!function(d){var c=d.util,g=d.type,i=d.utility.Logger.getLogger("ReadyStateHelper");d.ReadyStateHelper={addCompleteListener:function(e,t,a){d.checkArgs(arguments)(g.Function,g.Integer,g.Integer);var n,r=0;c.browser.isIE||c.browser.isEdge?(i.debug('Starting IE/Edge "readystatechange" interval.'),n=setInterval(function(){e(),a<=++r&&(i.debug('IE/Edge "readystatechange" interval complete.'),clearInterval(n))},t)):document.addEventListener("readystatechange",function(){"complete"===document.readyState&&(i.debug('Document "readystatechange" complete event fired.'),e())})}}}(TFCApp);
"use strict";!function(t,i){i={isIframeIntegration:i&&!0===i.iframeIntegration||!1,parentOrigin:i&&i.origin,tfcL:i&&i.tfcL,tfcS:i&&i.tfcS,isWidgetHiddenOpt:i&&i.widgetHidden?"true"===i.widgetHidden:void 0,storeExperimentKeyOpt:i&&i.storeExperimentKey};t.utility.FitrecContext=i}(TFCApp,window.tfhash);
"use strict";!function(t){var i=t.utility.FitrecContext;t.chooseIntegration=function(t,n){return i.isIframeIntegration?n:t}}(TFCApp);
"use strict";!function(s){var e=s.utility.Storage.keys.User,n=s.utility.Storage.keys.Token,r=s.utility.Storage.keys.SessionContext,u=s.utility.Logger.getLogger("FitRecCookieHelper"),t=s.CookieHelper.extend({sessionContext:function(e,t){u.trace("FitRecCookieHelper.sessionContext("+e+","+t+")");var o=s.storage;return void 0===e?o.get(r):(o.set(r,e,t),e)},userSession:function(){return s.storage.get(e)},removeUserSession:function(){s.storage.delete(e)},userToken:function(e,t,o,r){u.trace("FitRecCookieHelper.userToken("+e+", "+t+")");var i=s.storage;return void 0===e?i.get(n):(i.set(n,e,t,o,r),e)}});s.add("FitRecCookieHelper",t)}(TFCApp);
"use strict";!function(o){var u=o.util,t=o.type,i=o.Constants.Header,l=o.utility.Http,k=o.utility.Logger.getLogger("TokenHelper"),c=new o.FitRecCookieHelper,e=o.Class.extend({_constructor:function(){this.__guardingToken=!1,this.__tokenCallbacks=[]},guardedTokenCall:function(e){o.checkArgs(arguments)(t.Function);var n=this;c.userToken()?e(u.noop,u.noop):n.__guardingToken?n.__tokenCallbacks.push(e):(n._updateTokenGuard(!0),e(o.bind(n._tokenCallSuccess,n),o.bind(n._tokenCallFailure,n)))},_tokenCallSuccess:function(){var e=this,n=e.__tokenCallbacks;e._updateTokenGuard(!1),e.__tokenCallbacks=[],u.each(n,function(e,n){n(u.noop,u.noop)})},_tokenCallFailure:function(){var e=this;e._updateTokenGuard(!1);var n=e.__tokenCallbacks.shift();n&&e.guardedTokenCall(n)},_updateTokenGuard:function(e){o.checkArgs(arguments)(t.Boolean),this.__guardingToken=e},withToken:function(r,o,t,n,s){this.guardedTokenCall(function(a,e){c.userToken()?r():u.retry(function(e,n){l.get({responseType:"json",withCredentials:!0,serviceSecureUrl:o+"/profile/public/v3/"+t+"/token",success:e,failure:n})},function(e){var n=parseInt(e.getResponseHeader(i.UserTokenMaxAge)),o=e.getResponseHeader(i.UserTokenDomain),t=null===o?void 0:o,o=!!e.getResponseHeader(i.UserTokenSecure);u.isNaN(n)?c.userToken(e.data.token,void 0,t,o):c.userToken(e.data.token,n,t,o),r(),a()},function(){e(),s(),k.error("Unable to receive a new token. "+n)})})},__guardingToken:null,__tokenCallbacks:null});o.add("tokenHelper",new e)}(TFCApp);
"use strict";!function(e){var i=e.util;e.FitRecResponse={save:function(e){this._response=e},getWidgetResults:function(e){var t=this._response,s=t&&t.widgets&&t.widgets[e],n=t&&t.localeConfigs&&t.localeConfigs.sizeAvailabilityCaptureEnabled,e=t&&t.localeConfigs&&t.localeConfigs.autoSizeSelectEnabled;return s&&i.extend({},s,{tfpUser:t.tfpUser,recipientUser:t.recipientUser,extraClasses:t.extraClasses,userFlags:t.userFlags,locale:t.locale,widgetVariation:t.widgetVariation,sizeAvailabilityCaptureEnabled:n,autoSizeSelectEnabled:e,experiments:t.experiments,widgetLocation:t.widgetLocation})},getLocale:function(){var e=this._response;return e&&e.locale},setStoreUserId:function(e){this._storeUserId=e},getStoreUserId:function(){return this._storeUserId},getRecipientProfileId:function(){var e=this._response;return e&&e.recipientUser&&e.recipientUser.profileId},getSessionContext:function(){var e=this._response;return e&&e.sessionContext},getJsEventHooksEnabled:function(){var e=this._response;return!1!==(e&&e.localeConfigs||{}).jsEventHooksEnabled},getUseV6App:function(){var e=this._response;return e&&e.localeConfigs&&"V6"===e.localeConfigs.useV6OrV7App},getWidgetLocation:function(){var e=this._response;return e&&e.widgetLocation},getEmailOptInEnabled:function(){var e=this._response;return!!(e&&e.localeConfigs&&e.localeConfigs.emailOptInEnabled)},getIncludeAgeQuestion:function(){var e=this._response;return!!(e&&e.localeConfigs&&e.localeConfigs.includeAgeQuestion)},getResponse:function(){return this._response},_response:null,_storeUserId:void 0}}(TFCApp);
"use strict";function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}!function(n,E){var F=E.type,O=E.util,W=O.isNonZeroLengthString,_=O.addParamIfNonZeroLengthString,M=O.addParamIfDefined,N=E.analytics,L=E.postMessageManager,V=E.Constants,q=V.RequestParameter,H=V.Header,J=V.Widgets,z=V.Department,D=V.AgeGroup,e=E.utility,K=e.Http,j=e.Logger.getLogger("FitRecService"),r=["calculate","event","update","getProfileUrl","setToken","getToken"],G=E.FitRecResponse,Q=e.FitrecContext,B=e.Storage.keys.Token;function Z(i,e){return O.each(e,function(e,t){i[e]=(i[e]||[]).concat(t)}),i}function X(e,t,i,n,r){e=O.reduce(e,function(e,t,i){return 0<i.getNodes().length&&e.push(i),e},[]);1<e.length?(j.error("Invalid set of widgets found on the page"),r()):0===e.length?r():e.pop().alternativeCalculate(t,i,n,r)}function Y(e){return O.filter(e,function(e,t){return t instanceof E.widget.FitRecs})}function a(n,r,s){return function(i){var e,t=O.findVal(r,function(e,t){return t.widgetName===i});t?(e=F.Function.test(s)?s(t):s,E.checkArgsSoft(arguments,"True Fit "+n+" ("+i+")").apply(null,[F.String].concat(e))&&t[n].apply(t,O.slice(arguments,1))):j.error("Invalid widget name passed to the True Fit "+n+" API ["+i+"]")}}E.FitRecService=function(y,f){var e,t,i=this,S=[],m=[],v=E.cookieHelper,p=new E.UserVisitTracker(y.userVisitCookieEnabled),T=!1,b=[],h=!0,P=!1,C=O.stringToBool(y.shimQueryParams[q.AutoCalculate]||"true"),w=y.storeKey,I=y.widgetDeviceType,A=y.serviceMode,k={},s=this;function R(){var e=b.shift();T=!1,void 0!==e&&tfc.__calculate.apply(tfc,e)}function U(e){return O.findVal(e,function(e,t){return W(t)})}function x(i){var n,e=Y(S);return O.each(e,function(e,t){O.each(t.getCurrentFitResults(),function(e,t){n||null===n?t[i]!==n&&(n=null):n=t[i]})}),n}y.userVisitTracker=p,y.userSettings=f,L.receiveMessage(function(e,t){if(F.PlainObject.test(t))switch(e){case V.Message.UserToken:v.userToken(t.value,t.maxAge);break;case V.Message.SessionContext:v.sessionContext(t.value,t.maxAge)}},y.cdnProfileURI,L.globalWindowId()),O.each(E.widget,function(e,t){O.isFunction(t)&&t.isSubClassOf&&t.isSubClassOf(E.widget.BaseWidget)&&!t.isAbstract&&((t.usesAlternativeCalculate?m:S).push(t=new t(y)),k=O.extend(k,t.expectedUpdateTypes()))}),e=n("#tfc-fitrec-css").get(0),t=n("<style></style>").get(0),O.placeOnPage(O.prependToStyleTag(t,".tfc-cfg-widget,.tfc-cfg-core {display: none}"),e),this.__getToken=function(e){E.checkArgs(arguments)(F.Function);var t=E.storage.getValueWithMaxAge(B);e(t.value,t.maxAge)},this.__setToken=function(e,t){E.checkArgs(arguments)(F.String,F.Integer),v.userToken(e,t)},this.createPostFitCallSuccess=function(t){return function(e){t(),G.setStoreUserId(e.getResponseHeader(H.StoreUserId)),v.userToken()&&v.removeUserSession(),i.process(e.data)}},this.__calculate=function(i,e){var n,t=!0===e||e&&e.initialCall,r=e&&e.isEnteringData,s=(d=O.getQueryParams(),n=null,O.each(d,function(e,t){O.stringStartsWith(e,"tfc-")&&((n=n||{})[e.substr(4)]=t)}),n);if(!t||!P&&C)if(P=!0,T)b.push(arguments);else{C&&void 0!==i&&j.warn("Retailer is using the dynamic calculate API, but autoCalculate is true"),E.checkArgsSoft(arguments,"True Fit calculate")(F.Object(k).optional())&&O.each(S,function(e,t){t.update(i)});var a=(p=S,O.reduce(p,function(e,t,i){var n=i.preCall();return 0<i.getNodes().length&&(e.body.widgets[i.widgetName]=n.body,e.queryString=Z(e.queryString,n.queryString),e.headers=Z(e.headers,n.headers)),e},{queryString:{},headers:{},body:{widgets:{}}}));if(O.isEmpty(a.body.widgets))return T=!0,void X(m,y.serviceSecureURI,w,I,R);var o=O.reduceToSingleValue(a.queryString),c=O.reduceToSingleValue(a.headers),l=a.body,e=o[q.Locale]||"",u=y.tfAnalytics;u||(y.tfAnalytics=u=new N.FitRecTrueFitAnalytics(y.analyticsArgs,y.responsiveManager.currentScreenSize()),y.analyticsManager.addEngine(u.getEngine())),r&&(l[q.IsEnteringData]=!!r);var d=v.userToken(),t=v.userSession();d?c[H.UserToken]=d:t&&(c[H.UserCookie]=t),_(o,q.DeviceType,I),_(o,q.AnalyticsScreenSize,u.screenSize()),_(o,q.SessionParamOverrides,s&&O.param(s)),_(o,q.CookiesEnabled,E.storage.enabled().toString()),M(o,q.WidgetHidden,Q.isWidgetHiddenOpt),M(o,q.StoreExperimentKey,Q.storeExperimentKeyOpt),!l[J.Register]||l[J.Product]||l[J.Catalog]||_(o,q.SessionContext,v.sessionContext());var g=[];O.each(l.widgets,function(e){return g.push(e)}),1===g.length&&l[J.UserId]&&_(o,q.TrackingOnly,!0);var p=!!O.find(S,function(e,t){return t.isVisible&&0<t.getNodes().length}),f=y.serviceSecureURI;this.templatesHelper.update(e,p),this.templatesHelper.hasRequiredTemplates()||(_(a={},q.ServiceMode,A),r=f,d=w,t=y.uxVersion,s=y.storeVersion,p=e,e=I,a=a,O.loadScript({url:r+"/fitresources/"+d+"/"+(""===t?"0.0":t)+"/"+(""===s?"0.0":s)+"/"+e+(W(p)?"/"+p:"")+"/templates.js",data:a,cache:!0})),T=!0;var h=E.bind(this.createPostFitCallSuccess,this);E.tokenHelper.guardedTokenCall(function(e,t){var e=h(e),i={serviceSecureUrl:f+"/fitrec/"+w+"/fit",data:l,queryParameters:o,headers:c,success:e,failure:function(){t(),X(m,f,w,I,R)},responseType:"json",withCredentials:!0};u.getEngine().withTracker(function(e){i.queryParameters=O.extend(e.touchAndGetParams(),o),K.post(i)})||K.post(i)})}},this.__update=a("update",S.concat(m),function(e){return[F.Object(e.expectedUpdateTypes())]}),this.__event=a("event",S,[F.String,F.Function]),this.templatesHelper={templates:null,callback:null,locale:null,visibleWidgetsOnPage:!1,update:function(e,t){this.visibleWidgetsOnPage=t,e!==this.locale&&(this.locale=e,this.templates=null)},hasRequiredTemplates:function(){return this.templates||!this.visibleWidgetsOnPage},onRequiredTemplatesReady:function(e){this.callback&&j.error("Attempted to set up templates callback, but it already exists"),this.hasRequiredTemplates()?e():this.callback=e},setTemplates:function(i){this.templates=i,O.each(S,function(e,t){t.setTemplates(i)}),this.callback&&(this.callback(),this.callback=null)}},this.processTemplates=function(e){this.templatesHelper.setTemplates(e.templates)},this.process=function(d){G.save(d);var g=d&&d.widgets?d.widgets:{};this.templatesHelper.onRequiredTemplatesReady(function(){var e=window.performance,t=h&&e&&e.now&&e.now(),r=[];O.each(S,function(e,t){t.onFitCallResponse(d);var i,n=t.widgetName;g[n]&&(i=G.getWidgetResults(n),t.postCall(i),y.analyticsManager.handlePageLoad({isInitialProfileComplete:d.tfpUser.isInitialProfileComplete,pageName:n,funnels:[]}),r.push(t.widgetName))});var i=E.storage.getValueWithMaxAge(B),n=i&&i.value;h&&(t&&(s=e.now(),n&&E.performanceTracker.sendWidgetRender(n,r,t,s),n||j.error("Unable to read the user token from the cookie after saving. [userToken: "+n+"]")),p.trackVisits(r),E.preLoadFitProfile(p,y,r),h=!1),X(m,y.serviceSecureURI,w,I,R);var s=G.getSessionContext(),i=i&&i.maxAge;if(v.sessionContext(s,i),O.exists(S,function(e,t){return t.isVisible&&!!g[t.widgetName]}))try{var a,o=y&&y.pixelDropState,c=d.tfpUser,l=c&&c.profileId,u=c&&!!c.hasInstantProfile;"RetailerPageAndIframe"===o&&!u&&l&&(a=y&&y.pixelSyncProviders,(new E.manager.PixelSyncManager).dropPixelsUsingLocalStorage(l,a,n,y.serviceSecureURI,y.storeKey))}catch(e){j.error("Pixel drop failed",e)}})},this.__getProfileUrl=function(e){var t=G.getLocale(),i=G.getStoreUserId(),n=G.getRecipientProfileId(),r=G.getUseV6App(),s=G.getEmailOptInEnabled(),a=G.getIncludeAgeQuestion(),o=G.getWidgetLocation(),c=y.cdnProfileURI+y.uxVersionPath+(r?"/resources/fitprofile":"/tfp-app")+"/index.html#/";function l(e,t){return W(t)&&(u(e,t),1)}function u(e,t){c+="&"+e+"="+encodeURIComponent(t)}var d=U([(e="object"!==_typeof(e)?{}:e).container,V.Container.Modal]),r=U([e.windowId,L.fitProfileWindowId()]);if(d!==V.Container.Modal&&r===L.fitProfileWindowId())throw"Called getProfileUrl for a window that is not the account window, and the window ID was invalid";c+=q.StoreTla+"="+w,c+="&"+q.AllowTokenCycling+"="+!0;i=W(e.userId)?e.userId:W(i)?i:null;i&&(c+="&"+q.UserId+"="+i),l(q.Token,v.userToken()),l(q.ServiceSecureURI,y.serviceSecureURI),l(q.CdnSecureURI||"cdnSecureURI",y.cdnSecureURI),l(q.StoreVersionPath,y.storeVersionPath),l(q.SessionContext,v.sessionContext()),l(q.DeviceType,I),l(q.AnalyticsScreenSize,y.tfAnalytics.screenSize()),l(q.Gender,U([e.gender,x("gender")])),l(q.Category,e.category),l(q.IPS,e.ips),l(q.FirstName,e.firstName),l(q.Placement,e.placement),l(q.ServiceMode,A),l(q.Locale,t),l(q.StoreRegistered,e.registered),l(q.OriginWidget,e.originWidget),l(q.SourceTrigger,e.sourceTrigger),l(q.Container,d),l(q.StyleColorId,e.styleColorId),l(q.AnalyticsArgs,JSON.stringify(y.analyticsArgs)),l(q.UniversalAnalyticsArgs,JSON.stringify(y.universalAnalyticsArgs)),l(q.ThirdPartyAuth,JSON.stringify(y.thirdPartyAuth)),y.thirdPartyCredEmailCollectionEnabled&&l(q.ThirdPartyCredEmailCollectionEnabled,y.thirdPartyCredEmailCollectionEnabled.toString()),l(q.EditRecipientLinkId,e.editRecipientLinkId),u(q.IsShoppingForOther,!!e.isShoppingForOther),u(q.UserSettings,JSON.stringify(f.getAllExceptSessionParams())),l(q.RecipientAlias,e.recipientAlias),u(q.ShopForOthersEnabled,y.shopForOthersEnabled),l(q.RecipientProfileId,n),y.responsiveManager&&l(q.ScreenSize,y.responsiveManager.currentScreenSize()),y.customProfileJsEnabled&&l(q.CustomProfileJs,y.customProfileJsEnabled.toString()),l(q.WidgetHidden,e.widgetHidden),l(q.StoreExperimentKey,e.storeExperimentKey),l(q.EmailOptInEnabled,s.toString()),l(q.IncludeAgeQuestion,a.toString()),y.qmEnabled&&u(q.QMEnabled,y.qmEnabled),e.widgetLocation===o&&l(q.WidgetLocation,e.widgetLocation),y.tfAnalytics.getEngine().withTracker(function(e){c+="&"+O.param(e.touchAndGetParams())}),"string"==typeof e.availableSizes&&(c+="&"+q.AvailableSizes+"="+encodeURIComponent(e.availableSizes));var g,p,o=U([e.department,x("department")]);return l(q.Department,o),l(q.ProductType,U([e.productType,x("productType")])),l(q.AgeGroup,function(e){switch(e){case z.Men:case z.Women:case z.Unisex:return D.Adult;case z.Boy:case z.Girl:case z.UnisexKids:return D.Child}}(o)),u(q.ClientToServerLogging,JSON.stringify(y.clientToServerLogging)),(g=W(e.styleId)?[e.styleId]:(g=[],O.each(Y(S),function(e,t){O.each(t.getCurrentFitResults(),function(e,t){g.push(t.id)})}),O.distinctVals(g))).length&&(l(q.Style,JSON.stringify(g)),1===g.length&&(O.each(Y(S),function(e,t){return!p&&void O.each(t.getCurrentFitResults(),function(e,t){if(g[0]===t.id)return p=t,!1})}),p&&l(q.FitRecResult,JSON.stringify(p)))),c+="&"+L.generateWindowParams(r)},O.each(r,function(e,t){var i,n,r;n=y,(i=s)[r=t]=function(){if(!n.legacyEventApiEnabled)throw"Legacy True Fit API (tfc."+r+") is not supported for this retailer";return i["__"+r].apply(i,arguments)}}),this._widgets=S,this._altWidgets=m}}(tfcJQuery,TFCApp);
"use strict";!function(s){s.tfcapiSetup=function(t){var e,i=window.tfcapi,r=null,l=s.utility.Logger.getLogger("tfcapi"),n=s.type,o=s.util,c={fitrec:["calculate","event","update","getProfileUrl","getToken","setToken"],tracker:["track"]};function u(i,t,e,r){var n=!1;return!!i&&o.forAll(t,function(t,e){return!!i["__"+e]})&&o.containsVal(t,e)&&(i["__"+e].apply(i,r),n=!0),n}function a(){var n=[],a=c.fitrec.concat(c.tracker);o.each(e.q,function(t,e){var i=e[0],r=o.slice(e,1);o.containsVal(a,i)?u(window.tfc,c.fitrec,i,r)||u(s.trackerService,c.tracker,i,r)||n.push(e):l.error("Retailer attempted to call non-existent True Fit API function: "+i)}),e.q=n,r=null}t&&"tfcapi"in window&&l.warn("Retailer initialized the tfcapi object, but the legacy integration is still enabled for this retailer. True Fit should disable the legacy integration if the retailer is no longer using it."),n.Function.test(i)&&n.Array.optional().test(i.q)&&i&&!i.loaded?(window.tfcapi=e=function(){arguments&&"internalProcess"===arguments[0]?(null!=r&&(clearTimeout(r),r=null),a()):(tfcapi.q.push(arguments),null===r&&(r=setTimeout(a,1)))},e.loaded=!0,e.q=i.q||[],a()):i&&i.loaded?window.tfcapi("internalProcess"):t||l.error("Retailer loaded True Fit without properly initializing the tfcapi object. This usually means that True Fit disabled the legacy integration for this retailer, but the retailer is still using it.")}}(TFCApp);
"use strict";!function(o,r){var s=r.util,e=r.type,t=r.Constants,n=r.FitRecResponse,i=t.Attributes,a=t.RequestParameter,d=t.RequestBody,t=t.Header,l=r.utility.Logger.getLogger("True Fit Widget"),u={queryString:{},header:{},body:{}};u.queryString[i.STORE_REGISTERED]=a.StoreRegistered,u.queryString[i.LOCALE]=a.Locale,u.queryString[i.WIDGET_HIDDEN]=a.WidgetHidden,u.queryString[i.STORE_EXPERIMENT_KEY]=a.StoreExperimentKey,u.header[i.USER_ID]=t.StoreUserId,u.header[i.USERID]=t.StoreUserId,u.body[i.STYLE_ID]=d.Style,u.body[i.CONTEXT]=d.Context,u.body[i.WIDGET_LOCATION]=d.WidgetLocation,u.body[i.ORDER_ID]=d.OrderId;var c={registered:i.STORE_REGISTERED,userId:i.USERID,locale:i.LOCALE,storeExperimentKey:i.STORE_EXPERIMENT_KEY,widgetHidden:i.WIDGET_HIDDEN,colorId:i.STYLE_COLOR_ID,availableSizes:i.AVAILABLE_SIZES,orderId:i.ORDER_ID},g=r.Class.extend({context:null,eventHash:null,templates:null,widgetName:null,isVisible:!0,event:function(e){var t;n.getJsEventHooksEnabled()?(t=!1,this.getNodes().each(function(){"true"===o(this).attr(i.WIDGET_HIDDEN)&&(t=!0)}),"string"!=typeof e||t?t?l.debug("Attempted to use the widget event API when widgetHidden=true["+JSON.stringify(e)+"] for widget["+this.widgetName+"]"):l.error("Attempted to use the widget event API with an invalid event["+JSON.stringify(e)+"] for widget["+this.widgetName+"]"):r.chooseIntegration(this._eventHandler,this._iframeEventHandler).apply(this,arguments)):l.debug("Attempted to use the widget event API when jsEventHooksEnabled=false")},_eventHandler:function(t,e){if("string"==typeof t)if(s.isFunction(e))t in this.eventHash||(this.eventHash[t]=new r.Signal),this.eventHash[t].listen(e);else{var n=this.eventHash[t];if(n){e=s.slice(arguments,1);try{n.trigger.apply(n,e)}catch(e){l.error("Exception was thrown by retailer code when processing the ("+this.widgetName+","+t+') event. The underlying exception was: "'+(e&&e.message?e.message:"")+'"\n'+(e&&e.stack?e.stack:""))}}}},_iframeEventHandler:function(e,t,n){s.isFunction(t)||this.context.integrationManager.event(this.widgetName,e,t,n)},preCall:function(){var r=this,a={queryString:{},headers:{},body:[]};return r.getNodes().each(function(){var n=o(this),i={};s.each(r._preCallAttrs(),function(e,t){t in u.queryString?r._addParam(n,t,u.queryString[t],a.queryString):t in u.header?r._addParam(n,t,u.header[t],a.headers):t in u.body?r._addParam(n,t,u.body[t],i):l.error("Attempted to add attribute ["+t+"] to the preCall, but failed to look up the corresponding parameter",u)}),a.body=a.body.concat(i)}),a},postCall:function(e){},onFitCallResponse:function(e){},setTemplates:function(e){this.templates=e[this.widgetName]||{}},_constructor:function(e){this.context=e,this.eventHash={}},_supportedAttrs:function(){return[i.STORE_REGISTERED,i.USER_ID,i.USERID,i.LOCALE,i.WIDGET_HIDDEN,i.STORE_EXPERIMENT_KEY]},_preCallAttrs:function(){return this._supportedAttrs()},expectedUpdateTypes:function(){return{locale:e.String.optional(),userId:e.String.optional(),registered:e.Boolean.optional(),storeExperimentKey:e.String.optional(),widgetHidden:e.Boolean.optional()}},update:function(e){var n,i=this;e&&(n=i.getNodes(),s.each(e,function(e,t){i._updateAttr(n,e,t)}))},_updateAttr:function(e,t,n){t=c[t];t&&s.containsVal(this._supportedAttrs(),t)&&(null===n?e.removeAttr(t):void 0!==n&&e.attr(t,n))},_addParam:function(e,t,n,i){r.checkArgs(arguments)(r.type.Instance(o),r.type.String,r.type.String,r.type.Instance(Object));t=e.attr(t);t&&(i[n]=(i[n]||[]).concat(t))},getNodes:function(){return o("."+this.widgetName)},_getLocaleCode:function(){return n.getLocale()},alternativeCalculate:function(e,t,n,i){i()}});r.widget=function(e,t){if(r.checkArgs(arguments)(r.type.Object({isAbstract:r.type.Boolean.optional(),usesAlternativeCalculate:r.type.Boolean.optional(),widgetName:r.type.String}),r.type.Function.optional()),!e.widgetName)throw"Widget name required and cannot be an empty string";t=t||g;return r.widget[e.className]=t=t.extend(e),t.isAbstract=!!e.isAbstract,t.WIDGET_NAME=e.widgetName,t.usesAlternativeCalculate=!!e.usesAlternativeCalculate,t},g.isAbstract=!0,r.widget.BaseWidget=g}(tfcJQuery,TFCApp);
"use strict";!function(k){var h=k.type,s=k.util,a=k.utility.Logger.getLogger("TrueFitAnalyticsTracker"),r=k.Constants.RequestParameter,e={sessionTimeout:h.Integer,usingToken:h.Boolean},n={cookieEnabled:h.Boolean,analyticsSession:h.String.optional(),trackPageViewImpl:h.Function},T=s.extend({},e,n);var t=k.Class.extend({_constructor:function(e){k.checkArgs(arguments)(h.Object(T));var n,t,r,i,s,a,u=this,o=e.sessionTimeout,c=e.cookieEnabled,l=e.analyticsSession;function g(n,t){return{set:t,touch:function(){var e=n();return null!==e&&t(e),e}}}u._reqQueue=[],u._usingToken=n=e.usingToken,u._trackPageViewImpl=e.trackPageViewImpl,n||(u._sessionHandler=(t=o,a=s=null,c=c?(i=k.utility.Storage.keys.Analytics,r=k.storage,g(k.bind(r.get,r,i),function(e){r.set(i,e,t)})):g(function(){return s},function(e){null!==a&&clearTimeout(a),s=e,a=setTimeout(function(){s=a=null},t)})),void 0!==l&&c.set(l))},trackPageView:function(e){k.checkArgs(arguments)(h.Object({pageName:h.String,funnels:h.Array,onSuccess:h.Function,onError:h.Function,extraParams:h.PlainObject}));var n=this,t=s.extend(n.touchAndGetParams(),e.extraParams);function r(e){try{e()}catch(e){a.error("Exception thrown in callback function will be ignored",e)}n._reqInFlight=!1,0<n._reqQueue.length&&n._reqQueue.shift()()}function i(){0===e.funnels.length?r(e.onSuccess):(n._reqInFlight=!0,n._trackPageViewImpl({params:t,data:{pageName:e.pageName,funnels:e.funnels},success:k.bind(r,null,e.onSuccess),error:k.bind(r,null,e.onError)}))}n._reqInFlight?n._reqQueue.push(i):i()},touchAndGetParams:function(){var e,n,t={};return this._usingToken||(null===(n=(e=this._sessionHandler).touch())&&e.set(n=s.uuid()),t[r.AnalyticsSession]=n),t},_usingToken:null,_trackPageViewImpl:null,_sessionHandler:null,_reqInFlight:!1,_reqQueue:null});t.TrackerArgTypes=e,t.OtherTrackerArgTypes=n,t.AllTrackerArgTypes=T,k.analytics.TrueFitAnalyticsTracker=t}(TFCApp);
"use strict";!function(s){var i=s.analytics,o=s.util,e=s.type,l=s.utility.Logger.getLogger("AnalyticsEngine"),t=s.Class,a=t.unimplemented;function n(i,t,n){var e=null,i=t in i?i[t]:"_"in i?i._:void 0;return"function"===o.type(i)?e=i(n||{}):null!=i&&(e=i),e}var c={},r=1,u=2,_=3;t=t.extend({_constructor:function(i,t){s.checkArgs(arguments)(e.Object({config:e.Object(t).optional(),enabled:e.Boolean.optional(),pages:e.PlainObject.optional(),events:e.PlainObject.optional(),timings:e.PlainObject.optional()})),this._config=i.config||{},this._enableRecordings=e.Boolean.test(i.enabled)?i.enabled:s.getRunMode()===s.RunModes.prod,this._pages=this._filterIfUnimplemented(this._sendPageViewImpl,i,"pages"),this._events=this._filterIfUnimplemented(this._sendEventImpl,i,"events"),this._timings=this._filterIfUnimplemented(this._sendTimingImpl,i,"timings"),this._queue=[],this._scriptStatus=r,this._onLoad=new s.Signal,i=null,this._enableRecordings&&(i=o.chooseUri(this._getSecureScriptUrl(),this._getScriptUrl())),this._loadScript(i)},_filterIfUnimplemented:function(i,t,n){t=t[n];return i===a&&e.PlainObject.test(t)?(l.error("Passed "+n+" to an analytics engine that does not support that type of tracking call."),{}):t||{}},_onScriptLoadVerification:function(i,t){this._loadVerification()||(t=_),i=i,(t=t)===_&&l.warn("Analytics script failed to load ["+i+"]"),(i=c[i]).status=t,i.signal.trigger(t),delete i.signal},_loadScript:function(i){var t,n,e=this;null!==i?i in c?(t=c[i]).status!==r?setTimeout(s.bind(e._onScriptLoad,e,t.status),1):c[i].signal.listen(s.bind(e._onScriptLoad,e)):((t=c[i]={status:r,signal:new s.Signal}).signal.listen(s.bind(e._onScriptLoad,e)),n={url:i,success:s.bind(e._onScriptLoadVerification,e,i,u),error:s.bind(e._onScriptLoadVerification,e,i,_)},setTimeout(function(){e._customLoader(n)||s.util.loadScript(n)},1)):setTimeout(s.bind(e._onScriptLoad,e,u),1)},_customLoader:function(i){return!1},_loadVerification:function(){return!0},_onScriptLoad:function(i){this._scriptStatus=i,this._initEngine(),this._processQueue(),this._onLoad.trigger(),this._onLoad=null},_processQueue:function(){this._scriptStatus===u&&o.each(this._queue,function(i,t){t()}),this._queue=null},_initEngineImpl:a,_initEngine:function(){this._scriptStatus===u&&this._enableRecordings&&this._initEngineImpl()},_getEngineName:a,_getScriptUrl:a,_getSecureScriptUrl:a,_sendPageViewImpl:a,_sendEventImpl:a,_sendTimingImpl:a,_logRecording:function(i,t){var n=this._enableRecordings?"enabled":"disabled";l.debug(this._getEngineName()+"["+n+","+JSON.stringify(this._config)+"] -> "+i+"("+JSON.stringify(t)+")")},_sendPageView:function(i,t){this._logRecording("PageView",i),this._enableRecordings?this._sendPageViewImpl(i):this.supportsHitCallback&&t()},_sendEvent:function(i){this._logRecording("Event",i),this._enableRecordings&&this._sendEventImpl(i)},_sendTiming:function(i){this._logRecording("Timing",i),this._enableRecordings&&this._sendTimingImpl(i)},_processWhenReady:function(i){this._scriptStatus===u?i():this._scriptStatus===r&&this._queue.push(i)},pageView:function(i,t){i=n(this._pages,i,t);null!==i?this._processWhenReady(s.bind(this._sendPageView,this,i,t.success)):this.supportsHitCallback&&t.success()},event:function(i,t){t=n(this._events,i,t);null!==t&&this._processWhenReady(s.bind(this._sendEvent,this,t))},timing:function(i,t){t=n(this._timings,i,t);null!==t&&this._processWhenReady(s.bind(this._sendTiming,this,t))},onLoad:function(i){this._scriptStatus===r?this._onLoad.listen(i):i()},isEnabled:function(){return this._enableRecordings},_config:null,_pages:null,_events:null,_timings:null,_queue:null,_onLoad:null,_scriptStatus:null,_enableRecordings:null,supportsHitCallback:!1});i.AnalyticsEngine=t}(TFCApp);
"use strict";!function(n){var e=n.analytics,g=n.util,i=n.utility.Logger.getLogger("AnalyticsManager"),n=n.Class.extend({_constructor:function(){this._engines=[]},addEngine:function(n){n instanceof e.AnalyticsEngine?g.containsVal(this._engines,n)?i.raise("Cannot add the same engine twice"):this._engines.push(n):i.raise("Analytics engine must have type AnalyticsEngine")},handlePageLoad:function(i){var e,n=this._engines,t=g.count(n,function(n,e){return e.supportsHitCallback}),a=0,s=!1,c=i.success,o=i.error;function u(n){s||(clearTimeout(e),s=!0,n&&n())}i.success=function(){++a===t&&u(c)},i.error=function(){u(o)},e=setTimeout(function(){u(o)},1e4),g.each(n,function(n,e){e.pageView(i.pageName,i)})},handleEvent:function(i){var t=i.eventName;g.each(this._engines,function(n,e){e.event(t,i)})},handleTiming:function(i){var t=i.timingName;g.each(this._engines,function(n,e){e.timing(t,i)})},_engines:null});e.AnalyticsManager=n}(TFCApp);
"use strict";!function(t){var i="optimizely",n=t.analytics,r=t.extLibs,e=t.type;window[i]=window[i]||[];var s={id:e.String,scriptUrl:e.String.optional(),targets:e.Array},e=n.AnalyticsEngine.extend({isActive:function(){return this._active},_constructor:function(t){this._super(t,s),this._id=this._config.id,this._targets=this._config.targets},_initEngineImpl:function(){t.isDevMode()&&window[i].push(["log"])},_getEngineName:function(){return"A/B Testing"},_getScriptUrl:function(){var t=this._config.scriptUrl;return t?"http://"+t:null},_getSecureScriptUrl:function(){var t=this._config.scriptUrl;return t?"https://"+t:null},_sendPageViewImpl:function(n){var e=this;r(this._targets).each(function(t,i){i===n&&e._activate()})},_activate:function(){this._active=!0,window[i].push(["activate",this._id]),this._active=!1},_active:null,_id:null,_targets:null});n.ABTestingEngine=e}(TFCApp);
"use strict";!function(e){var n=e.analytics,t=n.TrueFitAnalyticsTracker,r=t.AllTrackerArgTypes,i=n.AnalyticsEngine.extend({_constructor:function(n){this._super(n,r)},_initEngineImpl:function(){var n,r=this._onTrackerReady;this._tracker=n=new t(this._config),r&&(r.trigger(n),this._onTrackerReady=null)},_getEngineName:function(){return"True Fit Analytics"},_getScriptUrl:function(){return null},_getSecureScriptUrl:function(){return null},_sendPageViewImpl:function(n){this._tracker.trackPageView(n)},withTracker:function(n){var r=this._tracker,t=this.isEnabled();return t&&(r?n(r):(this._onTrackerReady=r=this._onTrackerReady||new e.Signal,r.listen(n))),t},_tracker:null,_onTrackerReady:null,supportsHitCallback:!0});n.TrueFitAnalyticsEngine=i}(TFCApp);
"use strict";!function(a){var e=a.type,t=a.util,n=a.Class,l=a.analytics,i={totalABTests:e.Integer},u=l.AnalyticsEngine.extend({_constructor:function(e){this._super(e,i),this._pageViewQueue=[],this._loadedABTests=0,this._totalABTests=this._config.totalABTests},_initEngineImpl:function(){},_getEngineName:function(){return"ABTestCompleteEngine"},_getScriptUrl:function(){return null},_getSecureScriptUrl:function(){return null},_sendPageViewImpl:function(e){this._loadedABTests===this._totalABTests?a.abTestComplete.trigger(e):this._pageViewQueue.push(e)},incrementLoadedABTests:function(){++this._loadedABTests===this._totalABTests&&(t.each(this._pageViewQueue,function(e,t){a.abTestComplete.trigger(t)}),this._pageViewQueue=null)},_loadedABTests:null,_totalABTests:null,_pageViewQueue:null});a.analytics.ABTestInterface=n.extend({getEngines:function(){return this._engines.concat([this._abTestCompleteEngine])},isActive:function(){var n=!1;return t.each(this._engines,function(e,t){if(t.isActive())return!(n=!0)}),n},_getPageNames:n.unimplemented,_constructor:function(e){var n,i={},s=[];t.each(this._getPageNames(),function(e,t){i[t]=t}),t.each(e,function(e,t){t=new l.ABTestingEngine({enabled:!0,config:{id:t.id,scriptUrl:t.scriptUrl,targets:t.targets},pages:i});s.push(t)}),this._engines=s,this._abTestCompleteEngine=n=new u({enabled:!0,pages:i,config:{totalABTests:s.length}}),t.each(s,function(e,t){t.onLoad(a.bind(n.incrementLoadedABTests,n))})},_engines:null,_abTestCompleteEngine:null}),a.abTestComplete=new a.Signal}(TFCApp);
"use strict";!function(a){var e=a.analytics,i=a.type,c=a.util,s=(a.utility.Logger.getLogger("TrueFitAnalytics"),e.TrueFitAnalyticsTracker),g=e.TrueFitAnalyticsEngine,n=(a.Constants.RequestParameter,a.Class.extend({_constructor:function(e,n,t,r){a.checkArgs(arguments)(i.Object({enabled:i.Boolean,trackerArgs:i.Object(s.TrackerArgTypes),otherTrackerArgs:i.Object(s.OtherTrackerArgTypes)}),i.PlainObject.optional(),i.PlainObject.optional(),i.PlainObject.optional()),this._tfEngine=this._createEngine(e.enabled,c.extend({},e.trackerArgs,e.otherTrackerArgs),n,t,r)},_generatePageView:function(e,n){a.checkArgs(arguments)(i.Function,i.Object({pageName:i.String,funnels:i.Array}));e=e(n);return e?{pageName:e,funnels:n.funnels,extraParams:{},onSuccess:n.success,onError:n.error}:null},getEngine:function(){return this._tfEngine},_createEngine:function(e,n,t,r,a){return new g({enabled:e,config:n,pages:t,events:r,timings:a})},_tfEngine:null}));e.TrueFitAnalytics=n}(TFCApp);
"use strict";!function(e){e.manager.IntegrationManagerInterface=e.Class.extend({_constructor:function(e,n,t){},init:e.unimplemented,event:e.unimplemented,messageManager:e.unimplemented,changeLayout:e.unimplemented,documentComplete:e.unimplemented,widgetComplete:e.unimplemented,listenForOpenReg:e.unimplemented,unlistenForOpenReg:e.unimplemented,sendTfcIframeRefresh:e.unimplemented,sendTfcIframeUserUpdate:e.unimplemented,setTfcIframeUpdateCallback:e.unimplemented})}(TFCApp);
"use strict";!function(t,r,e){var s=t.util,c=(t.extLibs,t.utility.Logger.getLogger("ResponsiveManager")),n=t.Constants,a=n.ScreenSize,S=n.DeviceType,n=t.Class.extend({_constructor:function(e){var n,i=this;if(i._screenSizeQuerySignal=new t.Signal,e!==S.Responsive)i._setScreenSize(e===S.Desktop?a.Large:a.Small);else if(s.isFunction(r.matchMedia))try{(n=r.matchMedia("(max-width: 767px)")).matches?i._setScreenSize(a.Small):i._setScreenSize(a.Large),n.addListener(function(e){e=e.matches?a.Small:a.Large;i._setScreenSize(e)})}catch(e){c.warn("Error trying to use matchMedia: ",e," Using the window width instead"),i._useWindowWidth()}else i._useWindowWidth()},_setScreenSize:function(e){var n=this;n._currentScreenSize!==e&&(c.debug("Setting screen size:",e),n._currentScreenSize=e,n._screenSizeQuerySignal.trigger(e))},_useWindowWidth:function(){var e=this;e._setCurrentWidthBasedOnWindow(),r.addEventListener("resize",t.bind(s.debounce(e._setCurrentWidthBasedOnWindow,250),e))},_setCurrentWidthBasedOnWindow:function(){(r.innerWidth||e.documentElement.clientWidth||e.body.clientWidth)<=767?this._setScreenSize(a.Small):this._setScreenSize(a.Large)},currentScreenSize:function(){return this._currentScreenSize},subscribeToScreenSizeChange:function(e){this._screenSizeQuerySignal.listen(e)},_currentScreenSize:null,_screenSizeQuerySignal:null});t.manager.ResponsiveManager=n}(TFCApp,window,document);
"use strict";!function(m){var u=m.utility.Logger.getLogger("PixelSyncManager"),o=m.utility.Http;m.manager.PixelSyncManager=m.Class.extend({_constructor:function(){},dropAllPixels:function(t,e,n,i,o){var a=this;e.forEach(function(e){a._dropPixel(e,t,n,i,o)})},dropPixelsUsingLocalStorage:function(o,e,a,r,s){var c=this,d=new m.utility.LocalStorage,l="pixelDrop",p="lastDrop";d.isEnabled()?e.some(function(e){var t=d.get(l);if((t=t||{})[e]||(t[e]={}),!t[e][p])return c._dropPixel(e,o,a,r,s),t[e][p]=(new Date).getTime(),d.set(l,t),!0;var n=new Date,i=new Date(t[e][p]);return 7<(n.getTime()-i)/864e5?(c._dropPixel(e,o,a,r,s),t[e][p]=(new Date).getTime(),d.set(l,t),!0):void 0}):u.info("Unable to drop pixel because localStorage is blocked.")},_dropPixel:function(e,t,n,i,o){var a,r,s;t?(a=m.getRunMode()===m.RunModes.prod?t:"nonprod-"+t,"LiveRamp"===e?((t=document.createElement("img")).src="https://idsync.rlcdn.com/710477.gif?partner_uid="+a,t.style.position="absolute",t.style.visibility="hidden",document.getElementsByTagName("body")[0].appendChild(t)):"TowerData"===e?((r=document.createElement("script")).type="text/javascript",r.defer=!0,r.async=!0,r.src="//js.alocdn.com/c/l2obzrje.js",r.setAttribute("data-id","alocdn-ldr"),r.setAttribute("data-label",a),document.getElementsByTagName("body")[0].appendChild(r)):"Facebook"===e?((r=document.createElement("script")).text="!function(f,b,e,v,n,t,s){if(f.fbq)return;n=f.fbq=function(){n.callMethod?n.callMethod.apply(n,arguments):n.queue.push(arguments)};if(!f._fbq)f._fbq=n;n.push=n;n.loaded=!0;n.version='2.0';n.queue=[];t=b.createElement(e);t.async=!0;t.src=v;s=b.getElementsByTagName(e)[0];s.parentNode.insertBefore(t,s)}(window,document,'script','https://connect.facebook.net/en_US/fbevents.js');fbq('init', '509778499926979', {uid: '"+a+"'});fbq('track', 'PageView');",document.getElementsByTagName("body")[0].appendChild(r),(r=document.createElement("img")).src="https://www.facebook.com/tr?id=509778499926979&ev=PageView&noscript=1",r.style.position="absolute",r.style.visibility="hidden",document.getElementsByTagName("body")[0].appendChild(r)):"Google"===e?((s=document.createElement("script")).async=!0,s.src="https://www.googletagmanager.com/gtag/js?id=AW-696707880",document.getElementsByTagName("body")[0].appendChild(s),(s=document.createElement("script")).text="window.dataLayer = window.dataLayer || [];function gtag(){dataLayer.push(arguments);}gtag('js', new Date());gtag('config', 'AW-696707880');",document.getElementsByTagName("body")[0].appendChild(s)):"Pinterest"===e?((s=document.createElement("script")).text="!function(e){if(!window.pintrk){window.pintrk = function () {window.pintrk.queue.push(Array.prototype.slice.call(arguments))};varÂ n=window.pintrk;n.queue=[],n.version='3.0';varÂ t=document.createElement('script');t.async=!0,t.src=e;varÂ r=document.getElementsByTagName('script')[0];Â r.parentNode.insertBefore(t,r)}}('https://s.pinimg.com/ct/core.js');pintrk('load', '2614237153404');pintrk('page');",document.getElementsByTagName("body")[0].appendChild(s),(s=document.createElement("img")).src="https://ct.pinterest.com/v3/?event=init&tid=2614237153404&noscript=1",s.style.position="absolute",s.style.visibility="hidden",document.getElementsByTagName("body")[0].appendChild(s)):u.error("Unknown pixel provider "+e),this._logPixelSyncEvent(e,n,i,o)):u.error("Unable to drop pixel because shopper profile id is not defined.")},_logPixelSyncEvent:function(e,t,n,i){o.post({serviceSecureUrl:n+"/profile/public/v3/"+i+"/analytics/pixel-sync",data:{provider:e},userToken:t,withCredentials:!0})}})}(TFCApp);
"use strict";!function(e){var s=e.KeyCodes,a=e.util,l=e.utility.Logger.getLogger("tfcTabGroupController");function u(n,e){e=a.findKey(e,function(e,t){return n===t});return void 0===e?-1:e}e.TabHelper=e.Class.extend({_constructor:function(){this._els=[]},add:function(n){var e=this._els,t=a.findKey(e,function(e,t){return!!(n.compareDocumentPosition(t)&(Node.DOCUMENT_POSITION_FOLLOWING|Node.DOCUMENT_POSITION_CONTAINED_BY))});void 0===t&&(t=e.length),e.splice(t,0,n),l.trace("Added tabbable element ",n,e)},remove:function(e){var t=this._els,n=u(e,t);-1!==n?t.splice(n,1):l.warn("Attempted to remove ",e," but it was not found in the array"),l.trace("Removed tabbable element ",e,t)},handleKeydown:function(e,t){var n,i,o,r=this._els;t.keyCode===s.Tab&&(-1===(i=u(e,n=a.filter(r,function(e,t){return a.isVisible(t)&&!t.disabled})))?l.warn("Received tab event for ",e," but it was not found in the array"):i!==n.length-1||t.shiftKey?0===i&&t.shiftKey&&(o=n[n.length-1],l.debug("Shift-tab was pressed on first element. Focusing last element",o)):(o=r[0],l.debug("Tab was pressed on last element. Focusing first element",o)),o&&(o.focus(),t.preventDefault()))}})}(TFCApp);
"use strict";!function(n){var t=n.analytics,a=n.util;t.WidgetABTest=t.ABTestInterface.extend({_getPageNames:function(){var s,i=[];return a.each(n.widget,function(t,e){a.isFunction(e)&&e.isSubClassOf&&e.isSubClassOf(n.widget.BaseWidget)&&(s=e.WIDGET_NAME,i.push(s))}),i}})}((tfcJQuery,TFCApp));
"use strict";!function(i){var n=i.util,s=i.utility.Storage.keys.Analytics,e=i.analytics,t=e.TrueFitAnalytics.extend({_constructor:function(e,t){this._super(n.extend({otherTrackerArgs:{analyticsSession:i.storage.get(s)||void 0,cookieEnabled:!0,trackPageViewImpl:n.noop}},e),{}),this._screenSize=t},screenSize:function(){return this._screenSize}});e.FitRecTrueFitAnalytics=t}(TFCApp);
"use strict";!function(n){var a=n.utility.Logger.getLogger("IframeIntegrationManager"),i=n.Constants.LayoutType,r=n.type,o=n.util,s=n.manager;n.manager.IframeIntegrationManager=n.manager.IntegrationManagerInterface.extend({_constructor:function(e,t,a){this._iframeMessageManager=new s.IframeMessageManager(e,t,a),this._currentInlineWidth=document.body.scrollWidth},init:function(){var n=this,i=window.tfhash||{},r={locale:"data-locale",storeRegistered:"data-registered",style:"id",styleColor:"data-colorid",userId:"data-userid",widget:"class",category:"data-store-category",department:"data-department",ageGroup:"data-age-group",gender:"data-gender"},s={catalog:"tfc-fitrec-catalog",product:"tfc-fitrec-product",register:"tfc-fitrec-register"},e=document.getElementById("tfc-widget-container"),g=document.createElement("div");e&&(Object.keys(i).forEach(function(e){var t="widget"===e?s[i[e]]:i[e],a="category"!==e||o.stringStartsWith(t,"{")?r[e]:"data-category";a&&g.setAttribute(a,t),"widget"===e&&(n._widgetName=t)}),e.appendChild(g))},event:function(e,t,a,n){this._iframeMessageManager.sendEvent(this._widgetName,e,t,a,n)},messageManager:function(){return this._iframeMessageManager},changeLayout:function(e){n.checkArgs(arguments)(r.String);var t,a;o.containsVal(i,e,!0)&&(a=(this._currentLayoutType=e)===i.Modal?t="100%":(t=this._currentInlineHeight,this._currentInlineWidth),this._iframeMessageManager.sendChangeLayout(e,this._widgetName,t,a))},documentComplete:function(){a.debug("Document complete"),this._isDocumentComplete=!0,this._resize(document.body.scrollHeight)},widgetComplete:function(e){a.debug("Widget complete",e),this._isWidgetComplete=!0,this._resize(e)},_resize:function(e){var t=this;a.debug("Attempting resize.",t._currentLayoutType,e,this._currentInlineWidth,t._isWidgetComplete,t._isDocumentComplete),t._isWidgetComplete&&(this._currentInlineHeight=e,t._currentLayoutType===i.Inline&&t._iframeMessageManager.sendChangeLayout(i.Inline,t._widgetName,e,this._currentInlineWidth))},listenForOpenReg:function(e){this._iframeMessageManager.listenForOpenReg(e)},unlistenForOpenReg:function(e){this._iframeMessageManager.unlistenForOpenReg(e)},sendTfcIframeRefresh:function(e){this._iframeMessageManager.sendTfcIframeRefresh(e)},sendTfcIframeUserUpdate:function(){this._iframeMessageManager.sendTfcIframeUserUpdate()},setTfcIframeUpdateCallback:function(e){this._iframeMessageManager.setTfcIframeUpdateCallback(e)},_currentLayoutType:i.Inline,_currentInlineWidth:null,_currentInlineHeight:null,_isDocumentComplete:!1,_isWidgetComplete:!1,_iframeMessageManager:null,_widgetName:null})}(TFCApp);
"use strict";!function(n){n.utility.Logger.getLogger("True Fit Widget");n.manager.StandardIntegrationManager=n.manager.IntegrationManagerInterface.extend({_constructor:function(){},init:function(){},event:function(n,e,t,a){},messageManager:function(n){},changeLayout:function(n){},documentComplete:function(){},widgetComplete:function(n){},listenForOpenReg:function(n){},unlistenForOpenReg:function(n){},sendTfcIframeRefresh:function(n){},sendTfcIframeUserUpdate:function(){},setTfcIframeUpdateCallback:function(n){}})}(TFCApp);
"use strict";!function(a){var s=a.utility.Logger.getLogger("IframeMessageManager"),o=a.type,c=a.util,r=a.Constants.LayoutType,f=a.utility.PostMessage,g="tfc-change-layout",l="tfc-event",i="tfc-save-tfc-l",t="tfc-save-tfc-s";function e(e){if(c.isArrayLike(e)){for(var t=[],i=0;i<e.length;i++)t.push(e[i]);return t}s.raise("You must provide an array-like object to toArray")}a.manager.IframeMessageManager=a.Class.extend({_constructor:function(e,t,i){a.checkArgs(arguments)(o.Any,o.Object({primaryStoreMessageOrigin:o.String.optional(),storeMessageOriginWhitelist:o.Array}),o.String.optional());var n=t.primaryStoreMessageOrigin,t=t.storeMessageOriginWhitelist,n=i||n;n?(s.info("resolvedStoreMessageOrigin:",n,"storeMessageOriginWhitelist:",t),c.containsVal(t,n)?s.info("Origin was resolved successfully and is in the white list, so allowing it."):a.isProdMode()?s.raise("Origin was passed on the hash and is not in the white list. Failing hard since this is a prod environment."):(s.error("Origin was passed on the hash and is not in the white list. Defaulting to * since this is a non-prod environment. Note, this will throw an exception in prod!"),n="*")):a.isProdMode()?s.raise("No origin provided on hash and no primary origin configured. Failing hard since this is a prod environment."):(s.error("No origin provided on hash and no primary origin configured. Defaulting to * since this is a non-prod environment. Note, this will throw an exception in prod!"),n="*"),this._window=e,this._origin=n,this._listenForMessagesFromParent(),this._discoverTfcIframes()},_getMessageObject:function(e,t,i){a.checkArgs(arguments)(o.String,o.PlainObject.optional());i=function n(s,a){if(o.Array.test(s))return c.flatMap(s,function(e,t){return n(t,a)});if(o.PlainObject.test(s)){var r={};return Object.keys(s).forEach(function(e){var t=e.replace(/([A-Z])/g,function(e){return"_"+e.toLowerCase()}),i=s[e];!a||a(e)?r[t]=n(i,a):r[t]=i}),r}return s}({tfcMessageId:c.uuid(),tfcMessage:e,tfcData:t},i);return s.debug("Sending iFrame message ["+e+", "+JSON.stringify(i)+"]"),i},_postMessage:function(e){e&&(this._window?f.post(this._window,this._origin,e):s.error("Target window is undefined while trying to post a valid message object."))},sendChangeLayout:function(e,t,i,n){a.checkArgs(arguments)(o.String,o.Or(o.String,o.Null),o.Or(o.String,o.Integer),o.Or(o.String,o.Integer)),c.containsVal(r,e,!0)?this._postMessage(this._getMessageObject(g,{type:e,widget:t,height:i,width:n})):s.error("Invalid layout type["+e+"]")},sendTfcL:function(e,t){a.checkArgs(arguments)(o.String,o.Integer),this._postMessage(this._getMessageObject(i,{value:e,maxAge:t}))},sendTfcS:function(e){a.checkArgs(arguments)(o.String),this._postMessage(this._getMessageObject(t,{value:e}))},sendEvent:function(e,t,i,n,s){a.checkArgs(arguments)(o.String,o.String,o.String,o.Or(o.PlainObject,o.String).optional(),o.Function.optional()),this._postMessage(this._getMessageObject(l,{widget:e,eventSource:t,eventName:i,eventData:n},s))},_listenForMessagesFromParent:function(){var e=this;e._receiveOpenMessageSignal=new a.Signal,f.receive(window,a.bind(e._receiveMessageFromParentCallback,e),e._origin)},_receiveMessageFromParentCallback:function(e){e.data&&"tfc-open-registration"===e.data.tfc_message&&this._receiveOpenMessageSignal.trigger()},listenForOpenReg:function(e){this._receiveOpenMessageSignal.listen(e)},unlistenForOpenReg:function(){this._receiveOpenMessageSignal.unlistenAll()},_receiveOpenMessageSignal:void 0,_discoverTfcIframes:function(){this._tfcIframes=[],f.receive(window,a.bind(this._tfcIframeMessageCallback,this),c.parseOrigin(document.URL)),this._sendTfcIframeDeclaration()},_tfcIframeMessageCallback:function(e){var t=e.data.tfcMessage;"tfcIframeDeclaration"===t||"tfcIframeResponse"===t?(c.containsVal(this._tfcIframes,e.source)||this._tfcIframes.push(e.source),"tfcIframeDeclaration"===t&&f.post(e.source,c.parseOrigin(document.URL),{tfcMessage:"tfcIframeResponse"})):"tfcIframeRefresh"===t?(e=e.data.tfcData&&e.data.tfcData.isEnteringData,tfc.__calculate(void 0,{isEnteringData:e})):"tfcIframeUpdate"===t&&this._tfcIframeUpdateCallback&&this._tfcIframeUpdateCallback()},_sendTfcIframeDeclaration:function(){var i=e(window.parent.frames);c.each(i,function(e,t){t!==window&&f.post(i[e],"*",{tfcMessage:"tfcIframeDeclaration"})})},sendTfcIframeRefresh:function(e){this._sendTfcIframeMessage("tfcIframeRefresh",{isEnteringData:e})},sendTfcIframeUserUpdate:function(){this._sendTfcIframeMessage("tfcIframeUpdate")},_sendTfcIframeMessage:function(i,n){var s=e(window.parent.frames);this._tfcIframes=c.filter(this._tfcIframes,function(e,t){return c.containsVal(s,t)}),c.each(this._tfcIframes,function(e,t){f.post(t,c.parseOrigin(document.URL),{tfcMessage:i,tfcData:n})})},setTfcIframeUpdateCallback:function(e){this._tfcIframeUpdateCallback=e},_origin:void 0,_window:void 0,_tfcIframes:void 0,_tfcIframeUpdateCallback:void 0})}(TFCApp);
"use strict";!function(n,e){var s=n.Constants,o=n.util,t=s.Message,s=n.Class.extend({_constructor:function(){this._$iframes=e(),this._sourceWindowId=n.postMessageManager.retailerWindowId()},_broadcastMessage:function(a,i){var r=this;this._$iframes.each(function(e,s){var t=s.src;t&&(t=o.parseOrigin(t),n.postMessageManager.postMessage(s.contentWindow,t,r._sourceWindowId,a,i))})},broadcastScreenSizeChange:function(e){this._broadcastMessage(t.ScreenSizeChange,{newSize:e})},broadcastFitRecResults:function(e){this._broadcastMessage(t.FitRecResults,{fitRecResults:e})},registerIframe:function(e){this._$iframes=this._$iframes.add(e)},unregisterIframe:function(e){this._$iframes=this._$iframes.not(e)},_$iframes:[],_sourceWindowId:null});n.manager.ProfileMessageBroadcaster=s}(TFCApp,tfcJQuery);
"use strict";!function(a){var f=a.type,u=a.util,m=a.bind(u.addParamIfNonZeroLengthString,null),e=a.utility,g=e.FitrecContext,p=a.FitRecResponse,d=e.Http,l=a.Constants.RequestParameter,h=a.utility.Logger.getLogger("PerformanceTracker");function _(e,r){return{start:u.round(e,1),end:u.round(r,1)}}function n(t,e){return!!u.findVal(e,function(e,r){return-1<t.name.indexOf(r)})}function y(e,t){e=u.findVal(e,function(e,r){return n(r,t)});return e?_(e.fetchStart,e.responseEnd):void 0}var r=a.Class.extend({_constructor:function(e,r){a.checkArgs(arguments)(f.Any,f.PlainObject);var t=this,n=r.integrationDomains||[],e=t._performance=e.performance;t._requiredApisPresent=!(!e||!e.getEntriesByType),t._configuration=r,t._tfDomains=n.concat([r.cdnURI,r.cdnSecureURI,r.serviceURI,r.serviceSecureURI])},sendWidgetRender:function(e,r,t,n){a.checkArgs(arguments)(f.String,f.Array,f.Number,f.Number);var i=this,c=i._configuration,o={},s={widgetNames:r,processWidget:_(t,n)};0!==r.length?i._requiredApisPresent?(r=i._getTfcPerformanceEntries(),r={fitRecShim:i._getFitrecShimPerformanceEntry(),fitConfig:y(r,["/fitconfig?"]),fitRecAppJs:y(r,["/application.js"]),fitRecAppCss:y(r,["/fitrec.css","/fitrec-mobile.css","/fitrec-responsive.css"]),templates:y(r,["/templates.js"]),fitRecCall:y(r,["/fit?"])},u.find(r,function(e,r){return!r})?h.info("One of the timing entries could not be found["+JSON.stringify(r)+"]"):(u.each(r,function(e,r){s[e]=r}),m(o,l.IframeIntegration,g.isIframeIntegration.toString()),m(o,l.Locale,p.getLocale()),m(o,l.DeviceType,c.widgetDeviceType),m(o,l.AnalyticsScreenSize,c.responsiveManager.currentScreenSize()),d.post({serviceSecureUrl:c.serviceSecureURI+"/consumer/ui/"+c.storeKey+"/performance",queryParameters:o,userToken:e,data:s}))):h.debug("Performance API not present on the window"):h.error("An empty array of widget names was provided to the performance tracker. Skipping performance logging.")},_getTfcPerformanceEntries:function(){var t=this;return t._performance.getEntriesByType("resource").filter(function(e){var r=e.initiatorType;return("script"===r||"link"===r||"xmlhttprequest"===r)&&n(e,t._tfDomains)})},_getFitrecShimPerformanceEntry:a.Class.unimplemented,_configuration:null,_performance:null,_requiredApisPresent:null}),e=r.extend({_getFitrecShimPerformanceEntry:function(){return y(this._getTfcPerformanceEntries(),["/fitrec.js","/fitrec-internal.js"])}}),r=r.extend({_constructor:function(e,r){this._super(e,r),this._requiredApisPresent=!(!this._requiredApisPresent||!this._performance.timing)},_getFitrecShimPerformanceEntry:function(){var e=this._performance.timing,r=e.navigationStart;return _(e.fetchStart-r,e.responseEnd-r)}});a.PerformanceTracker=a.chooseIntegration(e,r)}(TFCApp);
"use strict";!function(_){var o=_.util,e=_.utility,s=_.type,r=s.Integer,a=e.Logger.getLogger("CookieData"),e=_.Class.extend({_constructor:function(e){_.checkArgs(arguments)(s.Object({name:s.String,enabled:s.Boolean,types:s.PlainObject,maxAge:s.Or(r,s.Null).optional()})),s.Integer.test(e.maxAge)||s.Null.test(e.maxAge)||void 0===e.maxAge||a.raise("maxAge argument must be an integer (specified age), null (session cookie), or undefined (must call setMaxAge before saving data)"),this.__name=e.name,this.__maxAge=e.maxAge,this.__enabled=e.enabled,this._data=this._read(e.types)},setMaxAge:function(e){_.checkArgs(arguments)(s.Or(r,s.Null));var a=this,t=a.__maxAge,i=o.now()/1e3;function n(){a.__lastMaxAgeUpdate=i,a.__maxAge=e,a._save()}void 0===t||null!==t&&null===e?n():(t=a.__lastMaxAgeUpdate+a.__maxAge,10<Math.abs(t-(i+e))&&n())},_read:function(n){var e=_.storage.get(this.__name),e=e?o.deparam(e):{},s={};return o.each(e,function(e,a){var t,i=n[e]||n._;i&&void 0!==(t=i.fromString(a))&&(s[e]=t)}),s},_save:function(){void 0===this.__maxAge?a.error("Attempted to save cookie data without a max age"):this.__enabled?_.storage.set(this.__name,o.param(this._data),null===this.__maxAge?void 0:this.__maxAge):(a.warn("Storage for ["+this.__name+"] is disabled, but the software attempted to write to it ["+o.param(this._data)+"]. This may result in degraded or missing functionality."),_.storage.delete(this.__name))},_data:null,__name:null,__maxAge:void 0,__lastMaxAgeUpdate:void 0,__enabled:null});_.add("CookieData",e)}(TFCApp);
"use strict";!function(i,t,n){var s=i.util,o=i.type,r=i.utility.Logger.getLogger("DeviceResolver"),c=i.Constants.DeviceType,d=[c.Desktop,c.Mobile],e=i.Class.extend({_constructor:function(e){i.checkArgs(arguments)(o.String.optional());try{this._screenSizeQuery=t.matchMedia("(max-width: 767px)")}catch(e){log.warn("Error trying to use matchMedia: ",e," Using the window width instead")}s.containsVal(d,e)?this.__deviceType=e:e===c.Responsive?r.info("Responsive device type resolving based on screen size."):e&&r.error("Invalid device type passed resolving based on screen size. [deviceType =  "+e+"]")},get:function(){var e=this;return e.__deviceType||(e._screenSizeQuery?e._screenSizeQuery.matches?c.Mobile:c.Desktop:(t.innerWidth||n.documentElement.clientWidth||n.body.clientWidth)<=767?c.Mobile:c.Desktop)},__deviceType:null,__screenSizeQuery:null});i.add("DeviceResolver",e)}(TFCApp,window,document);
"use strict";!function(a){var t,e=a.util,i=a.Constants.UserSettings,n=a.type,r={},o={};r[i.DiscoveryIntroMessageViewed]={type:n.Boolean,defval:!1},r[i.DiscoveryExitSuppressed]={type:n.Boolean,defval:!1},r[i.SessionParams]={type:n.String,defval:""},e.each(r,function(t,e){o[t]=e.type}),(t=a.CookieData.extend({_constructor:function(t){this._super({name:a.utility.Storage.keys.UserSettings,enabled:t,types:o})},get:function(t){a.checkArgs(arguments)(n.String);var e=this._data[t],s=o[t],t=r[t].defval;if(void 0===t)throw"Attempt to retrieve a user setting that does not exist";return s.test(e)?e:t},set:function(t,e){var s=o[t];if(!s)throw"Attempt to save a user setting that does not exist";a.checkArgs(arguments)(n.String,s),this._data[t]=e,delete this._data[i.SessionParams],this._save()},getAllExceptSessionParams:function(){var s=this,a={};return e.each(i,function(t,e){e!==i.SessionParams&&(a[e]=s.get(e))}),a}})).keys=i,a.add("UserSettings",t)}(TFCApp);
"use strict";!function(i){var r=i.type,n=i.util,t=i.CookieData.extend({_constructor:function(t){this._super({name:i.utility.Storage.keys.UserVisit,enabled:t,maxAge:null,types:{_:r.Integer}})},getVisits:function(t){return i.checkArgs(arguments)(r.String),this._data[t]||0},trackVisits:function(t){i.checkArgs(arguments)(r.Array);var e=this,s=this._data;n.each(t,function(t,i){s[i]=e.getVisits(i)+1}),this._save()}});i.UserVisitTracker=t}(TFCApp);
"use strict";!function(e,u){var a=e.util;e.preLoadFitProfile=function(r,t,e){var c=t.fitProfilePreLoad,n=c.pageCount,s=c.pageDelay,i=["tfc-fitrec-product","tfc-fitrec-account","tfc-fitrec-register"],c=a.sum(a.map(i,function(e,t){return r.getVisits(t)}));function o(){function e(){(new Image).src=t.cdnSecureURI+t.uxVersionPath+"/resources/fitprofile/index.html",(new Image).src=t.cdnSecureURI+t.uxVersionPath+"/resources/fitprofile/js/app.js",(new Image).src=t.cdnSecureURI+t.uxVersionPath+"/resources/fitprofile/css/application-responsive.css",(new Image).src=t.cdnSecureURI+t.storeVersionPath+"/resources/store/"+t.storeKey+"/css/tfpapp-responsive-web.css"}"complete"===document.readyState?e():u(document).bind("readystatechange",function(){"complete"===document.readyState&&e()})}a.find(e,function(e,t){return a.containsVal(i,t)})&&(n&&n<=c?o():s&&setTimeout(o,1e3*s))}}(TFCApp,tfcJQuery);
"use strict";!function(p,g,m){var _,w=p.extLibs,v=p.util,t=p.type,e=p.Class,i=e.unimplemented,d=p.history,b=p.Constants,o=b.Message,h=b.ScreenSize,a=b.ModalWidth,l=b.LayoutType,s=p.popupManager,u="body",f="head",n="tfc-popup-wrap",r="tfc-tip-result",c="tfc-popup-click-open",S="tfc-popup-click-close",C="tfc-iframe-loaded",$="modal-visible",M="tfc-modal-visible",T={tfcModalVisible:!0},P="tfc-full-screen-modal",W="tfc-window-modal",R="tfc-viewport",z="data-tip-id",L="data-content-id",I="data-legal-footer-setup",O="tfc-touch-target-large",y=p.utility.Logger.getLogger("TipOrModal"),H="close",A="complete",k="logout",E="open",U="pageload",x="update",F="addtobag",B="chat",V="sizechart",D="discoveryproductsviewed",Z="userclick",j=v.map(v.objVals(h),function(e,t){return G(t)}).join(" ");function N(e){return g("iframe",e)}function J(e,t){return t?e.filter(function(){var e=g(this).attr(L);return"secure-tip"===t?"secure"===e:"secure"!==e}):e}function K(e,t){return!(0<w(t).parents("."+n).length)}function Q(e,t,i){return J(w("."+e,t),i)}function q(e,t,i){return J(w("."+e,t).filter(K),i)}function G(e){return"tfc-"+e}function X(e){return e?'<meta id="tfc-viewport" name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover" />':'<meta id="tfc-viewport" name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover" />'}var Y=(e=e.extend({_constructor:function(e){var t=e.$elem,e=t.find(".tfc-popup-wrap");if(1!==t.length)throw"TipOrModal expected exactly one element to be passed in";if(1!==e.length)throw"TipOrModal expected exactly one .tfc-popup-wrap";this._$elem=t,this._$wrap=e,this._teardownFns=[]},hasIframe:function(){return 0<N(this._$elem).length},isInDom:function(){return 0<this._$elem.parents("body").length},receiveMessage:function(e,t){var i,n=this._$wrap;e===o.Open?(n.stop(!0),n.addClass(C),i=N(n),this._sendAppRevealed(i)):e===o.Refresh?n.stop(!0):e===o.Resize?this._handleResizeMessage(e,t):e===o.ResizeModalWidth&&this._handleResizeModalWidthMessage(e,t)},_sendAppRevealed:function(e){var t=e[0],i=p.postMessageManager.retailerWindowId(),e=t.src;e&&(e=v.parseOrigin(e),p.postMessageManager.postMessage(t.contentWindow,e,i,o.AppRevealed))},_handleResizeMessage:function(e,t){var i,n,s=this._$wrap,r=N(s),o=s.add(r);this._shouldHandleResize()&&(i=t.offsetHeight,n=t.scrollHeight,y.debug("Animating tip height: ",t),o.stop(!0),i===n?(r.css("height",s.height()),o.animate({height:i})):(s.height()!==i&&(y.warn("Tip offsetHeight changed and does not match scrollHeight. Tip height will be animated instantaneously."),s.css("height",i)),r.css("height",n)))},_handleResizeModalWidthMessage:function(e,t){var i,n=this,s=n._$wrap,r=N(s),o=s.width();n._currentWidth=t.modalWidth,n._shouldHandleWidthResize()&&(n._narrowWidth||(n._narrowWidth=o),a.Wide===t.modalWidth?i=n._wideWidth:a.Narrow===t.modalWidth?i=n._narrowWidth:y.error("Attempting to set modal width to something other than wide or narrow"),i&&i!==o&&(r.css("width",i),r.css("marginLeft",(o-i)/2),s.css("marginLeft",o/-2),s.css("overflow","hidden"),s.animate({width:i,marginLeft:i/-2}),r.animate({marginLeft:0},{complete:function(){s.css("overflow","")}})))},_clearWrapAndIframeHeightWidthMargin:function(){var e=this._$wrap,t=N(e),t=e.add(t);t.css("height",""),t.css("width",""),t.css("marginLeft","")},_container:i,_setupLegalFooterClickEvents:function(i){var n=this._$elem;function e(e,t){i.staticContentUri&&w("."+e,n).bind("click",function(){t(i.locale)})}n.data(I)||(e("tfc-legal-footer-privacy-policy",s.openPrivacyPolicy),e("tfc-legal-footer-terms-of-use",s.openTermsOfUse),n.data(I,!0))},_shouldHandleResize:i,_shouldHandleWidthResize:i,id:i,clickOpenTriggers:function(){return w("."+c,this._$elem)},clickOpenTriggersForTipId:function(e){return Q(c,this._$elem,e)},clickCloseTriggers:function(){return w("."+S,this._$elem)},toggleShowMore:i,setupMoreLessInfoHandlers:function(){var e=this,t=e._$elem;w(".tfc-tip-click-show-more",t).bind("click",function(){e.toggleShowMore(!0)}),w(".tfc-tip-click-show-less",t).bind("click",function(){e.toggleShowMore(!1)})},show:function(e,t,i,n,s){var r=this,o=r._$wrap,a=n&&n.before,l=n&&n.after,c=r._$elem,d=p.FitRecResponse,h=d.getResponse(),u=d.getUseV6App();c.toggleClass("tfc-v6",u),c.toggleClass("tfc-v7",!u);var f,n=h.extraClasses.concat(e.extraClassesStr.toString().split(" ")),c=(d=n,d=v.filter(d,function(e,t){var i=v.stringStartsWith(t,"tfc-gender");return i&&(f=t),!i}),f&&d.push(f),d).join(" ");this.hasIframe()&&(_=v.now(),d=(n=N(o)).parent(),n.remove(),n.attr("src",tfc.__getProfileUrl(v.extend({container:r._container(),isShoppingForOther:!h.userFlags.isShoppingForSelf,recipientAlias:h.recipientUser&&h.recipientUser.alias},t))),d.append(n),s.profileMessageBroadcaster.registerIframe(n)),this._setupLegalFooterClickEvents(e),a&&a(),u||o.addClass(C),o.fadeIn(function(){l&&l()}),r.decorateElement(c),t.productType===b.ProductType.Bras&&g(".tfc-cfg-full-logo").addClass("tfc-cfg-bra-logo"),r.hasIframe()||(r=r.getTabbable().get(0))&&r.focus()},hide:function(e,t,i){var n,s=this,r=s._$wrap,o=N(r),a=e&&e.before,l=e&&e.after;function c(){r.removeClass(C),l&&l(),t.profileMessageBroadcaster.unregisterIframe(o),n=o.removeAttr("src").clone(),o.replaceWith(n),s._clearWrapAndIframeHeightWidthMargin(),s.decorateElement(""),v.each(s._teardownFns,function(e,t){t.apply()}),s._teardownFns=[]}a&&a(),r.fadeOut(function(){c()})},getTabbable:function(){return g("a,button",this._$wrap)},decorateElement:function(e){var t=this._$elem,i="PRIOR_DECORATIONS",n=t.data(i);t.removeClass(n).addClass(e),t.data(i,e)},getWrapElem:function(){return this._$wrap},_$elem:null,_$wrap:null})).extend({_constructor:function(e){this._super(e),e.$widget||y.raise("Tip constructor expects a $widget element"),this._$widget=e.$widget},id:function(){return this._$elem.attr(z)},setPlacement:function(e){this._$wrap.addClass("tfc-"+e)},getPlacement:function(){var i=this._$wrap;return v.findVal(Y.Placement,function(e,t){return i.hasClass("tfc-"+t)})},toggleShowMore:function(e){var t=this._$wrap,i=t.height();t.toggleClass(TIP_SHOW_MORE_CLASS,e),e=t.height(),t.css("height",i),t.animate({height:e},{complete:function(){t.css("height","")}})},_container:function(){return b.Container.Tip},_shouldHandleResize:function(){return!0},_shouldHandleWidthResize:function(){return!1},show:function(e,t,i,n,s){var r=this,o=s.tipConfig,a=this._$wrap,l=this._$widget,c=r.getPlacement(),d=m.innerHeight,h=Math.round(w.scrollTop(m)),u=o.autoScrollThresholdTop+10,o=o.autoScrollThresholdBottom+10;function f(e,t,i){y.debug("setting scroll to:",e),w.scrollTop(m,e);var n=w.scrollTop(m);Math.abs(n-e)<1&&setTimeout(function(){Math.abs(t-e)<=i?w.scrollTop(m,t):f(t<e?e-i:e+i,t,i)},5)}this._super(e,t,i,n,s),r._resizeHandler=r=p.bind(r._positionTipWithinWindowBounds,r,r._getCssPos()),r(),m.addEventListener("resize",r),c!==Y.Placement.Above?d-o<(c=(r=a[0].getBoundingClientRect().top)+370)&&(l=l[0].getBoundingClientRect().top,f(h,d-u-o<c-(l=Math.min(r,l))?h+l-u:h+(c-d)+o,4)):(a=a[0].getBoundingClientRect().bottom-370)<u&&f(h,h-(u-a),4)},hide:function(e,t,i){var n=this,s=e&&e.before,r=e&&e.after;this._super({before:s,after:function(){r&&r(),m.removeEventListener("resize",n._resizeHandler),n._resizeHandler=null,n._clearCssPos()}},t,i)},_cssPlacementProp:function(){return this.getPlacement()===Y.Placement.Left?"right":"left"},_getCssPos:function(){return parseInt(this._$wrap.css(this._cssPlacementProp()))||0},_clearCssPos:function(){this._$wrap.css(this._cssPlacementProp(),"")},_positionTipWithinWindowBounds:function(e){var t=this._$wrap,i=w(m),n=t.offset().left,s=w.outerWidth(t),r=10-n,s=10-(i.width()-(n+s)),o=this._cssPlacementProp(),a="left"===o?1:-1,l=this._getCssPos(),e=a*(e-l);function c(e){t.css(o,l+a*e)}c(r+s<0?0<r?r:0<s?-s:0<e?Math.min(e,-s):Math.max(e,r):(r-s)/2)},_resizeHandler:null,_$widget:null}),ee=e.extend({_constructor:function(e){this._super(e),this._id=t.String.test(e.id)?e.id:null,this._fullScreenPopupZoomEnabled=e.fullScreenPopupZoomEnabled},receiveMessage:function(e,t){this._super(e,t),e===o.Open&&this._resetScrollPosition()},_container:function(){return b.Container.Modal},screenSize:function(){return this._$wrap.hasClass(G(h.Large))?h.Large:h.Small},_shouldHandleResize:function(){return this.isVisible()&&this.screenSize()===h.Large},_shouldHandleWidthResize:function(){return this.isVisible()&&this.screenSize()===h.Large},updateScreenSize:function(e){var t,i=this,n=g(u);i._$wrap.removeClass(j).addClass(G(e)),i.isVisible()&&(n.toggleClass(P,i.screenSize()===h.Small),n.toggleClass(W,i.screenSize()===h.Large),g("."+S).toggleClass(O,i.screenSize()===h.Small),i.screenSize()===h.Large&&(i._resetScrollPosition(),i._currentWidth===a.Wide&&(e=N(t=i._$wrap),n=i._wideWidth,t.css("width",n),t.css("marginLeft",n/-2),e.css("width",n))),w("#"+R).length||w(f).append(X(i._fullScreenPopupZoomEnabled))),i._shouldHandleResize()||i._clearWrapAndIframeHeightWidthMargin()},id:function(){return this._id},placeOnPage:function(){w(u).append(this._$elem)},toggleShowMore:function(e){this._$wrap.toggleClass(TIP_SHOW_MORE_CLASS,e)},show:function(e,t,i,n,s){var r=this,o=n&&n.before,a=n&&n.after,l=g(u),c=new p.TabHelper;r.isShowAnimationRunning=!0,r._wideWidth||(r._wideWidth=s.modalWidthLarge),r._super(e,t,i,{before:function(){r._startingScrollPosition={top:w.scrollTop(m),left:w.scrollLeft(m)},!e.popStateEnabled||d.state&&d.state.tfcModalVisible||d.pushState(T,""),r._$elem.data($,!0),r.screenSize()===h.Small?(l.addClass(P),g("."+S).addClass(O)):l.addClass(W),r._$elem.show(),o&&o()},after:function(){l.addClass(M),r.screenSize()===h.Small&&w(f).append(X(r._fullScreenPopupZoomEnabled)),a&&a(),r.isShowAnimationRunning=!1}},s),this.hasIframe()||r.getTabbable().each(function(e,t){c.add(t);var i=p.bind(c.handleKeydown,c,t);g(t).bind("keydown",i),r._teardownFns.push(function(){g(t).unbind("keydown",i)})})},hide:function(e,t,i){var n=this,s=e&&e.before,r=e&&e.after,o=g(u);n._super({before:function(){var e,t;i||(e=w("#"+R),t=w('meta[name="viewport"]').not(e),e.length&&e.attr("content",t.attr("content")||"").remove(),o.removeClass(M),d.state&&d.state.tfcModalVisible&&d.back()),s&&s()},after:function(){n._resetScrollPosition(),n._$elem.data($,!1),i||o.removeClass(P).removeClass(W),n._$elem.hide(),r&&r()}},t,i)},isVisible:function(){return!!this._$elem.data($)},_id:null,_startingScrollPosition:null,_resetScrollPosition:function(){w.scrollTop(m,this._startingScrollPosition.top),w.scrollLeft(m,this._startingScrollPosition.left)},isShowAnimationRunning:!1}),te=Y.extend({show:i,hide:i}),ie=ee.extend({show:function(e,t,i,n,s){var r=n&&n.before,n=n&&n.after;this._super(e,t,i,{before:function(){s.$widget.invisible(),s.integrationManager.changeLayout(l.Modal),r&&r()},after:n},s)},hide:function(e,t,i){var n=e&&e.before,s=e&&e.after;this._super({before:n,after:function(){i||(t.integrationManager.changeLayout(l.Inline),t.$widget.visible()),s&&s()}},t,i)}});e.clickOpenTriggers=p.bind(Q,null,c),e.clickOpenTriggersOutsidePopup=p.bind(q,null,c),e.clickCloseTriggersOutsidePopup=p.bind(q,null,S),Y.Placement={Above:"above",Below:"below",Left:"left",Right:"right"},Y.widgetTips=function(i){var e=g("."+r,i),n=[],s=p.chooseIntegration(Y,te);return e.each(function(e,t){n.push(new s({$elem:g(t),$widget:i}))}),n},Y.fromWidget=function(e,i){var t=g("."+r,e).filter(function(e,t){return g(t).attr(z)===i}),n=p.chooseIntegration(Y,te);return 1===t.length?new n({$elem:t,$widget:e}):null},ee.fromTemplate=function(e,t,i){return new(p.chooseIntegration(ee,ie))({$elem:e.filter(".tfc-modal-result"),id:t,fullScreenPopupZoomEnabled:i})},e.handleCriticalMessage=function(e,t,i,n,s,r){e===o.Open?(y.info("TIME TO LOAD: "+new Date(v.now()-_).getTime()/1e3),i(E,{data:t})):e===o.Close?i(H,{data:[]}):e===o.Complete?(i(A,{tfpUser:t.tfpUser,placement:t.placement,isCredentialSaved:t.tfpUser.isCredentialSaved}),n(),r.sendTfcIframeUserUpdate()):e===o.PageLoad?i(U,t):e===o.Update?(i(x),n(),r.sendTfcIframeUserUpdate()):e===o.LogOut?(i(k),n(),r.sendTfcIframeUserUpdate()):e===o.AddToBag?i(F,t):e===o.Refresh?(n=t&&t.isEnteringData,tfc.__calculate(void 0,{isEnteringData:n}),r.sendTfcIframeRefresh(n)):e===o.Chat?i(B):e===o.UserSetting?s.set(t.key,t.value):e===o.SizeChart?i(V):e===o.DiscoveryProductsViewed?i(D,t):e===o.UserClick&&i(Z,t)},p.TipOrModal=e,p.Tip=Y,p.Modal=ee}(TFCApp,tfcJQuery,window);
"use strict";!function(i,o){var t,l=i.extLibs,n=i.tips,s=i.type,c=i.util,e=i.Class,r=e.unimplemented,u=i.TipOrModal,a=i.Constants,p=a.SourceTrigger,g=a.Attributes,d="tfc-popup-wrap",b=i.utility.Logger.getLogger("TipTriggers"),f=(t=null,function(n,e){null===t&&(t=setTimeout(function(){t=null},500),e.call(n))}),h=e.extend({_constructor:function(n){i.checkArgs(arguments)(s.Object({tipConfig:s.PlainObject,userSettings:s.Instance(i.UserSettings),userVisitTracker:s.Instance(i.UserVisitTracker),widgetName:s.String,receiveMessageSignal:s.Instance(i.Signal).optional(),$widget:s.Instance(o),handleOpen:s.Function})),this._options=n},_isEnabled:r,_beforeTipOpen:function(){},_bindEvents:r,bindEvents:function(){var t=this,i=this._options;this._unbindEvents=this._bindEvents({$widget:i.$widget,handleOpen:function(n,e){t._isEnabled()&&(t._beforeTipOpen(),i.handleOpen(n,e))},$tipClickOpen:i.$tipClickOpen,listenForOpenReg:i.listenForOpenReg,unlistenForOpenReg:i.unlistenForOpenReg})},unbindEvents:function(){this._unbindEvents&&(this._unbindEvents(),this._unbindEvents=null)},_options:null,_unbindEvents:null}),a=h.extend({_constructor:function(n){this._super(n),i.checkArgs(arguments)(s.Object({listenForOpenReg:s.Function,unlistenForOpenReg:s.Function}))},_isEnabled:function(){return!0},_bindEvents:function(n){var e=this,t=n.listenForOpenReg,i=n.unlistenForOpenReg;return t(function(){n.handleOpen([new _({receiveMessageSignal:e._options.receiveMessageSignal}),new v],{sourceTrigger:p.Banner})}),function(){i()}}}),h=h.extend({_constructor:function(n){this._super(n),i.checkArgs(arguments)(s.Object({$tipClickOpen:s.Instance(o)}))},_isEnabled:function(){return!0},_bindEvents:function(i){var s=this,n=i.$tipClickOpen;function e(n){n.fromClickTipOpen=!0,f(this,function(){var n=l(this),e=n.attr("data-content-id"),t=o(".tfc-content",n.parents("."+d)).length?p.Popup:p.Widget;i.handleOpen([new _({receiveMessageSignal:s._options.receiveMessageSignal}),new v],e&&"secure"!==e?e:{ips:n.attr(g.IPS),editRecipientLinkId:n.attr(g.RECIPIENT_ID),sourceTrigger:t})})}return n.bind("click",e),function(){n.unbind("click",e)}}}),e=e.extend({_constructor:function(n){i.checkArgs(arguments)(s.Object({beforeTipClose:s.Function.optional(),receiveMessageSignal:s.Instance(i.Signal).optional()}).optional()),this._options=n},bindEvents:function(e){i.checkArgs(arguments)(s.Object({$widget:s.Instance(o),tipOrModal:s.Instance(u),handleClose:s.Function,$tipClickClose:s.Instance(o)}));var t=this;this._unbindEvents=this._bindEvents({$widget:e.$widget,tipOrModal:e.tipOrModal,$tipClickClose:e.$tipClickClose,handleClose:function(n){t._beforeTipClose(),e.handleClose(n)}})},_beforeTipClose:function(){var n=this._options,n=n&&n.beforeTipClose;n&&n()},_bindEvents:r,unbindEvents:function(){this._unbindEvents&&(this._unbindEvents(),this._unbindEvents=null)},_unbindEvents:null,_options:null}),_=e.extend({_constructor:function(n){this._super(n),i.checkArgs(arguments)(s.Object({selector:s.String.optional()}).optional())},_bindEvents:function(e){var n=this._options,t=n&&n.selector,i=n&&n.receiveMessageSignal,s=i&&!t,o=t?l(t,e.$widget):e.$tipClickClose;function c(){f(this,function(){e.handleClose()})}function r(n){"close"===n&&e.handleClose()}return s&&i.listen(r),o.bind("click",c),function(){s&&i.unlisten(r),o.unbind("click",c)}}}),v=e.extend({_bindEvents:function(e){var n=o(document);function t(n){c.isRealMouseEvent(n)&&f(this,function(){n.fromClickTipOpen||0!==o(n.target).parents("."+d).length||o("body").hasClass("tfc-full-screen-modal")||e.handleClose()})}return n.bind("click",t),function(){n.unbind("click",t)}}}),r=e.extend({_constructor:function(n){this._super(n),i.checkArgs(arguments)(s.Object({signal:s.Instance(i.Signal)}))},_bindEvents:function(e){function n(n){b.debug("SignalTipCloseTrigger - triggerArgs:",n),e.handleClose(n)}var t=this._options.signal;return t.listen(n),function(){t.unlisten(n)}}}),e=e.extend({_bindEvents:function(e){function n(n){b.debug("PopStateTipCloseTrigger - popstate event",n),c.browser.isEdge||e.tipOrModal.isShowAnimationRunning||(b.debug("PopState close triggered"),e.handleClose())}return window.addEventListener("popstate",n),function(){window.removeEventListener("popstate",n)}}});n.ClickTipOpenTrigger=h,n.MessageTipOpenTrigger=a,n.ClickTipCloseTrigger=_,n.PageClickTipCloseTrigger=v,n.SignalTipCloseTrigger=r,n.PopStateTipCloseTrigger=e}(TFCApp,tfcJQuery);
"use strict";!function(f,O){var l="tfc-tip-window-id",w="tfc-visible-popup-info",s="tfc-tip-receive-message-signal",a="tfc-tip-ab-test-setup",b="data-content-id",I=O.extLibs,C=O.util,m=O.tips,p=O.Constants,c=p.Attributes,P=O.Tip,v=O.TipOrModal,u=O.utility.FitrecContext,N=O.utility.Logger.getLogger("WidgetWithTips");function g(e,i,t){var n=this.context,e=e.data(w);v.handleCriticalMessage(i,t,n.fireFitrecRegisterEvent,n.fireFitrecRegisterScaledSizes,n.userSettings,n.integrationManager),e&&e.tipOrModal.receiveMessage(i,t)}O.widget({className:"WidgetWithTips",widgetName:"tfc-widget-with-tips",isAbstract:!0,_cdnProfileURI:null,_constructor:function(e){this._super(e),this._cdnProfileURI=e.cdnProfileURI},_initTip:function(i,t){t=t||"";var e,n=this,r=i.data(s);r||(e=O.postMessageManager.nextWindowId(),r=new O.Signal,i.data(l,e).data(s,r),r.listen(O.bind(g,this,i)),O.postMessageManager.receiveMessage(O.bind(r.trigger,r),n._cdnProfileURI,e)),i.data(a)||(i.data(a,!0),O.abTestComplete.listen(function(e){e===n.widgetName&&(N.debug(n.widgetName+" abTestComplete listen handler - START"),n._unbindCloseTriggers(i),n._bindCloseTriggers(i),n._initAllTips(i,t),N.debug(n.widgetName+" abTestComplete listen handler - STOP"))}))},_initAllTips:function(e,i){var t,n=C.extend({widgetName:this.widgetName,receiveMessageSignal:e.data(s)},this.context);function r(e){var i=e.filter(function(){return f(this).attr(b)});if(e.length!==i.length)throw b+" must be defined on every tip trigger because there are multiple tips for this widget."}t=e,r(v.clickOpenTriggers(t)),r(v.clickCloseTriggersOutsidePopup(t)),this._initTipOpenTriggers(e,n,[],i)},_initTipOpenTriggers:function(n,r,e,s,a,g,d){var t,o,i,l,p=this,c=[],u=(I(".tfc-fitrec-result",n),function(){N.debug(p.widgetName+" _initTipOpenTriggers - READING VISIBLE_POPUP_INFO_DATA_KEY");var e=n.data(w);return e&&e.tipOrModal.isInDom()?e:(N.debug(p.widgetName+" _initTipOpenTriggers - CLEARING VISIBLE_POPUP_INFO_DATA_KEY"),n.data(w,null),null)}()),T=(this.context.userSettings,O.bind(p._initTipOpenTriggers,p,n,r,c,s)),h=P.widgetTips(n);function _(t){return function(e,i){g&&g.trigger({launchedTipId:t}),O.cookieHelper.userToken()?p._launchTip(n,t,T,e,i,s):tfc.__calculate()}}return a=a||u&&u.tipOrModal,t=a&&a.id(),d=d||u&&u.visibleContentId,g=g||u&&u.otherTipLaunchedSignal,N.debug(p.widgetName+" _initTipOpenTriggers - visibleTipOrModal:",a,"visibleTipInfo:",u,"otherTipLaunchedSignal:",g,"visibleTipId:",t),u=C.filter(h,function(e,i){return i.id()!==t}),C.each(e,function(e,i){i.unbindEvents()}),p._widgetClickOpen()&&(i="secure-tip",c.push(new m.ClickTipOpenTrigger(C.extend({$widget:n,$tipClickOpen:n,handleOpen:_(i)},r))),l=p.context.integrationManager,O.chooseIntegration(C.noop,function(){c.push(new m.MessageTipOpenTrigger(C.extend({$widget:n,listenForOpenReg:O.bind(l.listenForOpenReg,l),unlistenForOpenReg:O.bind(l.unlistenForOpenReg,l),handleOpen:_(i)},r)))})()),0===h.length&&(i="secure-tip",(h=v.clickOpenTriggers(n,i)).length&&c.push(new m.ClickTipOpenTrigger(C.extend({$widget:n,$tipClickOpen:h,handleOpen:_(i)},r)))),C.each(u,function(e,i){var t=i.id(),i=v.clickOpenTriggersOutsidePopup(n,t);a&&(i=i.add(a.clickOpenTriggersForTipId(t)),d&&(i=i.filter(function(){return f(this).attr(b)!==d}))),o=C.extend({$widget:n,handleOpen:_(t)},r),t=[],i.length&&t.push(new m.ClickTipOpenTrigger(C.extend({$tipClickOpen:i},o))),C.each(t,function(e,i){c.push(i)})}),C.each(c,function(e,i){i.bindEvents()}),T},_beforeLaunchTip:C.noop,_afterLaunchTip:C.noop,_launchTip:function(e,i,t,n,r,s){var a,g,d=this,o=d.context,s={locale:d._getLocaleCode(),staticContentUri:o.profileURI,extraClassesStr:s};N.debug(d.widgetName+" _launchTip - tipId:",i,"reinitTips:",t,"closeTriggers:",n),d._alwaysLaunchModal()||u.isIframeIntegration||d._widgetContext(e)===p.Context.QuickView||o.pdpWidgetAppContainer===p.Container.Modal||o.responsiveManager.currentScreenSize()===p.ScreenSize.Small?(g=o.getModal(),o.responsiveManager.currentScreenSize()===p.ScreenSize.Small&&(s.popStateEnabled=!0,a=new m.PopStateTipCloseTrigger)):((g=P.fromWidget(e,i))||N.raise("Tip: "+i+" not found on widget:",e),g.setPlacement(o.tipConfig.placement)),o=C.extend({windowId:e.data(l),widgetLocation:e.attr(c.WIDGET_LOCATION)},r,d._getProfileParamsWithWidgetName(e)),g.show(s,o,void 0,{before:function(){d._beforeLaunchTip(e,g,r)},after:function(){d._afterLaunchTip(e,g,r)}},C.extend({$widget:e},d.context));s=new O.Signal,o=new m.SignalTipCloseTrigger({signal:s});N.debug(d.widgetName+" _launchTip - SETTING VISIBLE_POPUP_INFO_DATA_KEY"),e.data(w,{tipOrModal:g,otherTipLaunchedSignal:s,otherTipLaunchedTipCloseTrigger:o,reinitTipsWhenThisOneCloses:t(g,s,void 0),closeTriggers:n,visibleContentId:void 0}),N.debug(d.widgetName+" _launchTip - VISIBLE_POPUP_INFO_DATA",e.data(w)),n.push(o),a&&n.push(a),d._bindCloseTriggers(e)},_bindCloseTriggers:function(n){var r,e,s,a,g,d,o=this,i=n.data(w);N.debug(o.widgetName+" _bindCloseTriggers - READING VISIBLE_POPUP_INFO_DATA_KEY"),N.debug(o.widgetName+" _bindCloseTriggers - visibleTipInfo:",i),i&&(e=i.closeTriggers,g=i.otherTipLaunchedTipCloseTrigger,d=i.reinitTipsWhenThisOneCloses,s=i.tipOrModal,a=s.id(),r=v.clickCloseTriggersOutsidePopup(n,s.id()).add(s.clickCloseTriggers()),C.each(e,function(e,i){var t=i===g;i.bindEvents({$widget:n,tipOrModal:s,$tipClickClose:r,handleClose:function(e){o._closeTip(n,s,a,e&&e.launchedTipId),t||d()}})}))},_unbindCloseTriggers:function(e){var i,e=e.data(w);N.debug(this.widgetName+" _unbindCloseTriggers - READING VISIBLE_POPUP_INFO_DATA_KEY"),N.debug(this.widgetName+" _unbindCloseTriggers - visibleTipInfo:",e),e&&(i=e.closeTriggers)&&C.each(i,function(e,i){i.unbindEvents()})},_closeTip:function(e,i,t,n){N.debug(this.widgetName+" _closeTip - tipId:",t,"launchedTipId:",n),this._unbindCloseTriggers(e),N.debug(this.widgetName+" _closeTip - CLEARING VISIBLE_POPUP_INFO_DATA_KEY"),e.data(w,null),i.hide(void 0,C.extend({$widget:e},this.context),n?{closingTipId:t,openingTipId:n}:void 0)},_getProfileParams:O.Class.unimplemented,_getProfileParamsWithWidgetName:function(e){return C.extend(this._getProfileParams(e),{originWidget:this.widgetName})},_widgetContext:function(e){return e.attr(c.CONTEXT)},_alwaysLaunchModal:function(){return!1},_widgetClickOpen:function(){return!1}})}(tfcJQuery,TFCApp);
"use strict";!function(v,_){var I=_.type,y=_.util,r=_.Constants,R=_.Tip.Placement,b=r.FitRec.Event,o=r.FitRec.Status,L=r.FitRec.TemplateName,a=b.OpenDialog,i=b.MoreInfo,c=b.Render,e="tfc-fitrec-result",A=_.extLibs,C=_.FitRecUtil,f=r.Attributes,n=["id","status","score","priority","size","recommended","recommendable"],s=["isAuthenticated","isInitialProfileComplete","isLoggedOut","isUserAvailable","isCredentialSaved"],T="data-event-object",z="data-current-template-name",p=_.utility.Logger.getLogger("FitRecs"),l=_.utility.Http,d=y.addParamIfNonZeroLengthString;function O(t){return A("."+e,t)}function D(t,e){O(t).addClass("tfc-retry-fitrec-inprogress"),tfc.__calculate(void 0,{isEnteringData:e})}function u(t,i){var r={};return y.each(t,function(t,e){y.containsVal(i,t)&&(r[t]=e)}),r}function N(t){return u(t,n)}function m(t){return{fitRecommendations:t.fitRecommendations.map(N),tfpUser:u(t.tfpUser,s)}}_.widget({className:"FitRecs",widgetName:"tfc-fitrec-base",isAbstract:!0,retryTimeoutId:null,currentResultsHash:{},widgetHeightCssPersistEnabled:!1,event:function(t,e){this._super(t=t===i?a:t,e)},getNodes:function(){return this._super().map(function(){var t=v(this);return t.attr(f.STYLE_ID,t.attr(f.STYLE_ID_NEW)||t.attr(f.STYLE_ID_LEGACY))})},getCurrentFitResults:function(){return this.currentResultsHash},clearFitResultsForStaleStyles:function(e){this.currentResultsHash=y.filter(this.currentResultsHash,function(t){return e.includes(t)})},preCall:function(){var t=this._super();return this.retryTimeoutId&&clearTimeout(this.retryTimeoutId),t},_supportedAttrs:function(){return this._super().concat([f.STYLE_ID,f.AVAILABLE_SIZES,f.STYLE_COLOR_ID])},_preCallAttrs:function(){return y.filter(this._super(),function(t,e){return e!==f.AVAILABLE_SIZES&&e!==f.STYLE_COLOR_ID})},expectedUpdateTypes:function(){var t=this._super();return t.products=I.ObjectOf(I.Object({availableSizes:I.String.optional(),colorId:I.String.optional()})).optional(),t},update:function(t){this._super(t);var r,a=this,t=t&&t.products;t&&(r=a.getNodes(),y.each(t,function(t,e){var i=r.filter(function(){return v(this).attr(f.STYLE_ID)===t});y.each(e,function(t,e){a._updateAttr(i,t,e)})}))},_getWidgetLocation:function(t){},renderWidgetsUsingCurrentResults:function(o,c,l){var d=this,t=d.getNodes(),u=m(o),g=[];t.each(function(t,e){var i,r,a,n,s;l&&e.querySelector(".tfc-fitrec-result")||(i=(n=v(e)).attr(f.STYLE_ID),r=d._getWidgetLocation(n),s=(a=d.currentResultsHash[i])&&a.extraClasses||[],n=o.extraClasses.concat(s).join(" "),s=o.widgetLocation,r&&s!==r||(d._renderResultFitCall(A(e),a,o,u,n,c),l||!d.widgetHeightCssPersistEnabled||(e=function(t){try{var e=t.querySelector(".tfc-fitrec-result");return e?getComputedStyle(e).height:void 0}catch(t){p.error("Error while trying to get widget height",t)}}(e))&&g.push({styleId:i,widgetLocation:r,height:e})))}),l||function(r,t){try{var e="tfc-style-".concat(r,"-heights"),i=document.getElementById(e);if(!t.length)return i&&i.remove();var a=!!i;i||((i=document.createElement("style")).id=e),i.textContent=t.map(function(t){var e=t.styleId,i=t.widgetLocation,t=t.height,i=i?'[data-widgetlocation="'.concat(i,'"]'):"";return".".concat(r,'[data-styleid="').concat(e,'"]').concat(i,", #").concat(e,".").concat(r).concat(i,"{ min-height: ").concat(t,";}")}).join("\n"),a||document.head.appendChild(i)}catch(t){p.error("Error while trying to persist widget heights",t)}}(d.widgetName,g)},postCall:function(t){var e=t.fitRecommendations,i=m(t),r=this,a=r.getNodes(),n=[],s=r.context;r._super(t),s.profileMessageBroadcaster.broadcastFitRecResults(e),y.each(e,function(t,e){(r.currentResultsHash[e.id]=e).status,o.NoUser}),r.renderWidgetsUsingCurrentResults(t,n),0<n.length&&(this.retryTimeoutId=setTimeout(function(){D(a,t.isEnteringData)},5e3)),r.event(c,{widgets:a.get(),response:i}),s.integrationManager.widgetComplete(a.get(0).scrollHeight),t.sizeAvailabilityCaptureEnabled&&0<a.length&&a.each(function(t,e){var i,r,a;void 0!==v(e).attr(f.AVAILABLE_SIZES)?(r=(i=v(e)).attr(f.AVAILABLE_SIZES).split(s.availableSizesDelimiter),a=i.attr(f.STYLE_ID),d(e={},"ui-locale-code",i.attr(f.LOCALE)),d(e,"color-code",i.attr(f.STYLE_COLOR_ID)),e={serviceSecureUrl:s.sizeAvailabilityURI+"/size-availability/public/v1/stores/"+s.storeKey+"/products/"+a+"/available-sizes",data:r,queryParameters:e},l.post(e)):p.error("Size availability capture is enabled, but the "+f.AVAILABLE_SIZES+" attribute is not present on the widget.")})},_getProfileParams:function(t){var e=t.attr(f.STYLE_ID),i=this.currentResultsHash[e];return e=i,t=(i=t).attr(f.STYLE_ID),{firstName:i.attr(f.FIRST_NAME),gender:i.attr(f.GENDER)||e.gender,department:e.department,productType:e.productType,category:e.category,registered:i.attr(f.STORE_REGISTERED),styleId:t,styleColorId:i.attr(f.STYLE_COLOR_ID),availableSizes:i.attr(f.AVAILABLE_SIZES),context:i.attr(f.CONTEXT),widgetHidden:i.attr(f.WIDGET_HIDDEN),storeExperimentKey:i.attr(f.STORE_EXPERIMENT_KEY)}},_renderResultCommon:function(t,e,i,r){var a=r.recipientUser,a=(a&&a.profileId)===(r.tfpUser&&r.tfpUser.profileId)?t.attr(f.FIRST_NAME):a.alias;O(t).addClass(e+" "+i),a&&A(".tfc-first-name",t).html(a)},_renderResultFitCall:function(t,e,i,r,a,n){var s,o,c,l,d,u,g,f,p,m,h,S,E;_.checkArgs(arguments)(I.Instance(v),I.PlainObject.optional(),I.Object({userFlags:I.Object({generalSizeAdviceEnabled:I.Boolean})}),I.PlainObject,I.String,I.Array),I.PlainObject.test(e)&&(o=(s=this).context,m=t.data(z),g=i,E=(p=e).templateName,f=m===L.NoUser,p=E===L.IncompleteProfile,c=E=g.isEnteringData&&f&&p?m:E,t.data(z,c),h=i.userFlags.generalSizeAdviceEnabled,l=(S=e.gsa)&&S.overall,d=S&&S.brand,g=!!(u=c===L.BrandAdvice?d:l),f=[e.category?"tfc-"+e.category:"",e.sellingSizeStep?"tfc-"+e.sellingSizeStep:""].join(" "),p=A(".tfc-tip-result.tfc-secure",t),m=o.tipConfig.placement,E=function(t){var e=s.templates;if(e[t])return e[t]}("secure-tip"),S=r,r={element:t,fitRecommendation:N(e),response:S},t.data(T,r),S=(S=s.templates[c])&&(S[i.widgetVariation]||S.default),E=E.default,t.contents().not(".tfc-tip-result").remove(),0===p.length&&t.append(E),t[m===R.Below?"prepend":"append"](C.evalTemplate(S)),s._renderResultCommon(t,a,f,i),c===L.AnonymousNotRecommended||c===L.AnonymousRecommended||c===L.NotRecommended||c===L.Recommended?(C.animateFitScore(t,e.score,300,{},{}),A(".tfc-size",t).text(e.size)):c===L.RecommendedGarmentUserSizeOnly||c===L.RecommendedGarmentSizeOnly||c===L.RecommendedUserSizeOnly||c===L.RecommendedDepartmentSizeOnly?A(".tfc-size",t).text(e.size):c===L.EstimationInProgress&&(n.push(t),A(".tfc-fitrec-retry",t).bind("click",function(){D(t,!1)})),O(t).toggleClass("tfc-gsa-enabled",h).toggleClass("tfc-gsa-disabled",!h).toggleClass("tfc-gsa-available",g).toggleClass("tfc-gsa-unavailable",!g),v(".tfc-cfg-basic-button.tfc-hide-logo-if-gsa-available",O(t)).toggleClass("tfc-hide-logo",g),g&&void 0!==u.gsaScore&&(h=50*(u.gsaScore- -1)/2+0,O(t).addClass("tfc-gsa-score-"+y.pad(y.round(h)))),g&&O(t).addClass("tfc-"+u.advice),g&&u===d&&A(".tfc-gsa-brand",O(t)).text(u.brandName),l&&l.gsaSocialProofMessage?A(".tfc-social-proof-message",t).text(l.gsaSocialProofMessage):A(".tfc-social-proof",t).remove(),o.hoverTooltipsEnabled||(v(".tfc-cfg-close-button").removeAttr("title"),v(".tfc-popup-click-open").removeAttr("title")),s._initTip(t,a),s.event(e.status,r),i.autoSizeSelectEnabled&&e.size&&(e={size:e.size,styleId:e.id},s.event(b.AutoSizeSelect,e)),y.isEmpty(i.experiments)||s.event(b.Experiments,i.experiments))},_afterLaunchTip:function(t,e,i){i.ips&&i.ips===r.IPS.FitDetails&&this.event(a,t.data(T))}},_.widget.WidgetWithTips)}(tfcJQuery,TFCApp);
"use strict";!function(a,t){var s=t.FitRecUtil,e=t.Constants.Attributes,i=t.Constants.Widgets;t.widget({className:"FitAccount",widgetName:i.Account,preCall:function(){var t=this._super();return t.body={},t},postCall:function(t){var i=this,e=i.getNodes(),n=t.status;i._super(t),e.each(function(t,e){i._initTip(a(e))});var n=i.templates[n],r=n&&(n[t.widgetVariation]||n.default);e.each(function(){var t,e;t=a(this),e=r,t.contents().remove(),t.html(s.evalTemplate(e))}),i.event("render",{widgets:e.get(),response:t}),this.context.integrationManager.widgetComplete(e.get(0).scrollHeight)},_getProfileParams:function(t){return{firstName:t.attr(e.FIRST_NAME),gender:t.attr(e.GENDER),registered:t.attr(e.STORE_REGISTERED),widgetHidden:t.attr(e.WIDGET_HIDDEN),storeExperimentKey:t.attr(e.STORE_EXPERIMENT_KEY)}},_alwaysLaunchModal:function(){return!0}},t.widget.WidgetWithTips)}(tfcJQuery,TFCApp);
"use strict";!function(c,a){var o=c.Constants,n=o.Attributes,d=o.RequestParameter,l=o.RequestBody,e=o.Widgets,i=c.FitRecUtil,s=c.util,u=c.Modal,p=c.utility.Http,g=c.utility.Logger.getLogger("FitProfile"),S=s.addParamIfNonZeroLengthString,f=c.FitRecResponse,m="render",h={Female:{Adult:"Womens",Child:"Girls"},Male:{Adult:"Mens",Child:"Boys"}};c.widget({className:"FitProfile",widgetName:e.Register,$loadingTemplate:null,scrollTop:0,heightToggleIntervalId:void 0,$modal:null,modal:null,onFitCallResponse:function(e){var t=this;t._super(e),e.extraClasses&&t.modal&&t.modal.decorateElement(e.extraClasses.join(" "))},preCall:function(){var t,e,r=this,i=r.context,o=r._super(),s={};return i.shopMySizeEnabled?(t=void 0,0<(e=r.getNodes()).length&&(e.each(function(){var e=a(this).attr(n.STORE_CATEGORY);t?t!==e&&g.error("Different store categories seen in the same iframe ["+t+", "+e+"]"):t=e}),t!==r._storeCategory&&(r._storeCategory=t,r._shopMySizeApiCall("store-category","hierarchyinfo",r._storeCategorySuccess),r._scaledSizesApiCall(),i.integrationManager.setTfcIframeUpdateCallback(c.bind(r._scaledSizesApiCall,r))),S(s,l.StoreCategory,r._storeCategory))):1===(r=r.getNodes()).length&&r.each(function(){var e=a(this);S(s,l.Gender,e.attr(n.GENDER)),S(s,l.AgeGroup,e.attr(n.AGE_GROUP)),S(s,l.Category,e.attr(n.CATEGORY))}),o.body=s,o},postCall:function(e){var r=this;r._super(e);var t=r.getNodes();t.each(function(e,t){r._initTip(a(t))}),r.event(m,{widgets:t.get(),response:e}),this.context.integrationManager.widgetComplete(0)},setTemplates:function(e){var t=this,r=t.context.responsiveManager;t._super(e),t.modal||(a("body").append(i.evalTemplate(t.templates["modal-backdrop"].default)),a(".tfc-modal-backdrop").bind("click",s.noop),function(){t.$modal=i.evalTemplate(t.templates["secure-modal"].default);var e=t.modal=u.fromTemplate(t.$modal,"secure-tip",t.context.fullScreenPopupZoomEnabled);e.placeOnPage()}(),t.modal.updateScreenSize(r.currentScreenSize()),r.subscribeToScreenSizeChange(function(e){t.modal.updateScreenSize(e)}))},_constructor:function(e){var t=this;t._super(e),e.shopMySizeEnabled?e.fireFitrecRegisterScaledSizes=c.bind(t._scaledSizesApiCall,t):e.fireFitrecRegisterScaledSizes=function(){},e.fireFitrecRegisterEvent=c.bind(t.event,t),e.getModal=function(){return t.modal}},_getProfileParams:function(e){var t,r=e.attr(n.AGE_GROUP),i=e.attr(n.GENDER),t=(t=r,h[r=i]&&h[r][t]);return{firstName:e.attr(n.FIRST_NAME),gender:i,registered:e.attr(n.STORE_REGISTERED),sourceTrigger:o.SourceTrigger.Banner,department:t||this._department,productType:e.attr(n.CATEGORY)||this._productType,widgetHidden:e.attr(n.WIDGET_HIDDEN),storeExperimentKey:e.attr(n.STORE_EXPERIMENT_KEY)}},_alwaysLaunchModal:function(){return!0},_widgetClickOpen:function(){return!0},_shopMySizeApiCall:function(e,t,r){var i,o,s,a,n,l=this;0<l.getNodes().length&&(i=l.context,o=f.getStoreUserId(),s=f.getSessionContext(),a=c.cookieHelper.userToken(),S(n={},d.ServiceMode,i.serviceMode),S(n,d.UserId,o),S(n,d.SessionContext,s),t={responseType:"json",userToken:a,withCredentials:!0,queryParameters:n,serviceSecureUrl:i.serviceSecureURI+"/consumer/ui/"+i.storeKey+"/shop-my-size/"+e,success:c.bind(r,l),failure:c.bind(l._shopMySizeHttpFailure,l,t)},l._storeCategory&&(t.serviceSecureUrl=t.serviceSecureUrl+"/"+encodeURIComponent(l._storeCategory)),p.get(t))},_shopMySizeHttpFailure:function(e,t){g.error("Failed to get "+e+" for the given category [category: "+this._storeCategory+", http status: "+t.status+"]")},_storeCategorySuccess:function(e){e=e.data;e?(this._department=e.department,this._productType=e.productType,this.event("hierarchyinfo",{recommendable:e.recommendable})):g.info("No content was returned for hierarchyinfo [category: "+this._storeCategory+"]")},_scaledSizesApiCall:function(){var e=this,t=c.bind(e._tryScaledSizesApiCall,e),r=c.bind(e._scaledSizesSuccess,e),e=c.bind(e._scaledSizesFailure,e);s.retry(t,r,e,"consistentInterval",1e3)},_tryScaledSizesApiCall:function(t,r){var i=this;i._shopMySizeApiCall("scaled-sizes","userinfo",function(e){i._scaledSizesHttpSuccess(e,t,r)})},_scaledSizesHttpSuccess:function(e,t,r){e=e.data;e?e.estimationInProgress?r():t(e):g.info("No content was returned for userinfo [category: "+this._storeCategory+"]")},_scaledSizesSuccess:function(e){this.event("userinfo",{isUserAvailable:e.isUserAvailable,normalizedSizes:e.normalizedSizes},function(e){return"normalizedSizes"!==e})},_scaledSizesFailure:function(){g.error("Unable to obtain userinfo because user estimation took too long [category: "+this._storeCategory+"]")},_storeCategory:null,_department:null,_productType:null},c.widget.WidgetWithTips)}(TFCApp,tfcJQuery);
"use strict";!function(t){var i=t.util,e=t.Constants,n=e.RequestBody,e=e.Widgets;t.widget({className:"FitRecsCatalog",widgetName:e.Catalog,preCall:function(){var t=this._super(),e=t.body.map(function(t){return t[n.Style]}),r={},s=i.distinctVals(e.reduce(function(t,e){return t.concat(e)},[])),e=s.map(function(t){return t.style});return this.clearFitResultsForStaleStyles(e),r[n.Styles]=s,{queryString:t.queryString,headers:t.headers,body:r}}},t.widget.FitRecs)}(TFCApp);
"use strict";!function(t){var l=t.util,e=t.Constants,o=e.Attributes,r=e.RequestBody,e=e.Widgets,h=t.utility.Logger.getLogger("FitRecsProduct"),c=t.FitRecResponse,f=["A","B","C","D","E","F"];t.widget({className:"FitRecsProduct",widgetName:e.Product,_supportedAttrs:function(){return this._super().concat([o.CONTEXT,o.WIDGET_LOCATION])},_getWidgetLocation:function(t){return t.attr(o.WIDGET_LOCATION)},onFitCallResponse:function(t){this._super(t),this.widgetHeightCssPersistEnabled=!!(t&&t.localeConfigs&&t.localeConfigs.widgetHeightCssPersist)},preCall:function(){var t=this,e=t._super(),o=e.body.map(l.reduceToSingleValue),d=[];t.widgetBodyGroupedByStyleContextAndWidgetLocation=o.reduce(function(t,e){var o=e.style,n=e.widgetLocation,i=e.context||"pdp";return n?(t[o]||(t[o]={}),t[o][i]||(t[o][i]={}),delete e[r.WidgetLocation],t[o][i][n]?t[o][i][n].push(e):t[o][i][n]=[e]):d.push(e),t},{});var u,n=t.widgetBodyGroupedByStyleContextAndWidgetLocation;for(u in n){var i,g=n[u];for(i in g)!function(t){for(var n=g[t],e="pdp"===t?void 0:t,o=l.objKeys(n),i=o.reduce(function(t,e){var o=n[e];return t[e]=o.length,t},{}),r=l.objVals(i),t=r.every(function(t){return t===r[0]}),c=o.reduce(function(t,e){return i[t]>i[e]?t:e}),s=i[c],a=0;a<s;a++)d.push(n[c][a]);t||h.error("Widget Location A/B test has been set up incorrectly. There should be the same number of widgets on the body for each location. Style ".concat(u," ").concat(e?"and context ".concat(e):""," has the following counts for each widget location: ").concat(JSON.stringify(i)));t=l.objKeys(n).sort();(t.some(function(t,e){return t!==f[e]})||t.length<2)&&h.error("Widget Location A/B test has been set up incorrectly. The integration is missing one or more expected location. Found the following widget locations ".concat(e?"for context ".concat(e,":"):":"," ").concat(JSON.stringify(t)))}(i)}o=d.map(function(t){return t.style});t.clearFitResultsForStaleStyles(o);o=c.getWidgetResults(t.widgetName);o&&t.renderWidgetsUsingCurrentResults(o,[],!0);o={};return o[r.Styles]=d,{queryString:e.queryString,headers:e.headers,body:o}},postCall:function(t){this._super(t);var n=this.widgetBodyGroupedByStyleContextAndWidgetLocation,e=(t&&t.fitRecommendations).map(function(t){return t.id}),i=t&&t.widgetLocation;e.forEach(function(t){var e,o=n[t];for(e in"A"!==i&&0===l.objKeys(o).length&&h.error("A widget location test is running but no widget elements with data-widgetlocation are on the page for style ".concat(t,".")),n[t])n[t][e][i]||h.error("There is a widget location test that isn't set up correctly. We expected to render widget location ".concat(i," but no widget element was found on the page for style ").concat(t," ").concat("pdp"!==e?"and context ".concat(e):"",' with data-widgetlocation="').concat(i,'"'))})}},t.widget.FitRecs)}(TFCApp);
"use strict";!function(a){var e=a.Constants,r=e.Attributes,t=e.RequestParameter,d=e.RequestBody,s=e.IntegrationPlatform,c=e.Header,e=e.Widgets,i=a.type,l=a.util,p=a.utility.Http,g=a.tokenHelper,y=a.utility.Logger.getLogger("OrderNotify");a.widget({className:"OrderNotify",widgetName:e.Order,isVisible:!1,usesAlternativeCalculate:!0,_supportedAttrs:function(){return this._super().concat([r.ORDER_ID])},expectedUpdateTypes:function(){var e=this._super();return e.orderId=i.String.optional(),e},preCall:function(){var e=this._super(),r={};return r[d.OrderId]=e.body.map(function(e){return l.reduceToSingleValue(e)[d.OrderId]}),{queryString:l.reduceToSingleValue(e.queryString),headers:l.reduceToSingleValue(e.headers),body:l.reduceToSingleValue(r)}},alternativeCalculate:function(i,n,e,r){var e=new a.DeviceResolver(e),o=this.preCall(),u=o.body;u[d.OrderId]?(u.deviceType=e.get(),u.integrationPlatform=s.Web,u.widgetHidden="true"===o.queryString[t.WidgetHidden],u.storeExperimentKey=o.queryString[t.StoreExperimentKey],u.checkoutType="OrderNotify",g.withToken(function(){l.retry(function(e,r){var t=a.cookieHelper.userToken();l.addParamIfNonZeroLengthString(o.headers,c.UserToken,null===t?void 0:t),p.post({serviceSecureUrl:i+"/profile/public/v3/"+n+"/checkout",withCredentials:!0,queryParameters:o.queryString,headers:o.headers,data:u,success:e,failure:r})},function(){y.info("Order Notify checkout was successful"),r()},function(){y.error("Order Notify checkout failed"),r()})},i,n,"Unable to complete the order notify checkout",r)):r()}})}(TFCApp);
"use strict";!function(e){var t=e.extLibs,s=e.Constants.Widgets,i=e.Constants.FitRec.Event;e.widget({className:"SetUserId",widgetName:s.UserId,isVisible:!1,preCall:function(){var e=this._super();return e.body={},e},postCall:function(e){this._super(e),this.event(i.Render,{widgets:t("."+this.widgetName).get(),response:e})}})}((tfcJQuery,TFCApp));
"use strict";!function(g){var e=g.manager,s=g.util,c=g.utility,n=c.StorageFactory,f=g.analytics,d=g.ReadyStateHelper,l=c.Logger.getLogger("TFCDomReady"),m=c.FitrecContext,p=window.tfc.configuration,u=c.StorageFactory.cookieBased(p.cookieCfg),w=new(g.chooseIntegration(e.StandardIntegrationManager,e.IframeIntegrationManager))(window.parent,p.iframeConfig,c.FitrecContext.parentOrigin);g.storage=g.chooseIntegration(function(){return u},function(){return n.messageBased({messageManager:w.messageManager()},c.FitrecContext)})(),g.extLibs.domready(function(){var e,n,t,r,a,i=u.enabled(),o=p.iframeConfig&&p.iframeConfig.firstPartyStorageEnabled;!m.isIframeIntegration||(o||i)?(a=new g.UserSettings(p.userSettingsCookieEnabled),e=new g.FitRecCookieHelper,p.clientToServerLogging&&c.Logger.registerLoggingEngine(new c.HttpLoggerEngine(p.clientToServerLogging,e)),n=p.responsiveManager=new g.manager.ResponsiveManager(p.profileDeviceType),t=p.analyticsManager=new f.AnalyticsManager,r=p.experiments||[],p.shimQueryParams||(p.shimQueryParams=function(){for(var e,n,t,r=document.getElementsByTagName("script"),a="",i={},o=0;o<r.length;++o)if(e=r[o].src,/fitrec(-[^\.]+)?\.js/.test(e)){a=e;break}for(n=(a.split("?",2)[1]||"").split("&"),o=0;o<n.length;++o)2===(t=n[o].split("=",2)).length&&(i[t[0]]=t[1]);return i}()),p.integrationManager=w,p.profileMessageBroadcaster=new g.manager.ProfileMessageBroadcaster,n.subscribeToScreenSizeChange(function(e){p.profileMessageBroadcaster.broadcastScreenSizeChange(e)}),g.cookieHelper=e,window.tfc=a=new g.FitRecService(p,a),g.tfcapiSetup(p.legacyEventApiEnabled),r=g.experiment=new f.WidgetABTest(r),s.each(r.getEngines(),function(e,n){t.addEngine(n)}),w.init(),g.performanceTracker=new g.PerformanceTracker(window,p),d.addCompleteListener(function(){w.documentComplete()},1e3,10),a.__calculate(void 0,{initialCall:!0})):l.info("Fit recommendations disabled - Integration is iframe based, but there is no way to store the user data[1st party: "+o+", 3rd Party: "+i+"]")})}((tfcJQuery,TFCApp));